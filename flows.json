{"value":[{"name":"GDMS check group","createdOn":"2024-10-24T16:27:08Z","modifiedOn":"2025-05-22T18:59:51Z","workflowId":"ca4a80cf-2492-ef11-8a69-000d3a12bba3","resourceId":"591c3706-8095-75d7-b11e-f3cea0c54115","stateCode":"Published","statusCode":"Published","definition":"{\"properties\":{\"connectionReferences\":{\"shared_sharepointonline_1\":{\"runtimeSource\":\"invoker\",\"connection\":{\"connectionReferenceLogicalName\":\"spo_sharedsharepointonline_58c9a\"},\"api\":{\"name\":\"shared_sharepointonline\"}}},\"definition\":{\"$schema\":\"https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"$connections\":{\"defaultValue\":{},\"type\":\"Object\"},\"$authentication\":{\"defaultValue\":{},\"type\":\"SecureObject\"},\"GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)\":{\"defaultValue\":\"https://grote0.sharepoint.com/teams/GDMS\",\"type\":\"String\",\"metadata\":{\"schemaName\":\"spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036\"}}},\"triggers\":{\"manual\":{\"metadata\":{\"operationMetadataId\":\"24785f2e-2fb7-4e4a-ae6f-04270c691009\"},\"type\":\"Request\",\"kind\":\"PowerAppV2\",\"inputs\":{\"schema\":{\"type\":\"object\",\"properties\":{\"text\":{\"title\":\"userEmail\",\"type\":\"string\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter your input\",\"x-ms-content-hint\":\"TEXT\"}},\"required\":[\"text\"]}}}},\"actions\":{\"Parse_JSON\":{\"runAfter\":{\"Send_an_HTTP_request_to_SharePoint_2\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"e9a50ad1-f91c-4f75-8438-393c0e9b4955\"},\"type\":\"ParseJson\",\"inputs\":{\"content\":\"@body('Send_an_HTTP_request_to_SharePoint_2')\",\"schema\":{\"type\":\"object\",\"properties\":{\"d\":{\"type\":\"object\",\"properties\":{\"results\":{\"type\":\"array\",\"items\":{\"type\":\"object\",\"properties\":{\"Id\":{\"type\":\"integer\"},\"Title\":{\"type\":\"string\"},\"Description\":{\"type\":\"string\"},\"LoginName\":{\"type\":\"string\"}},\"required\":[\"Id\",\"Title\",\"Description\",\"LoginName\"]}}}}}}}},\"Initialize_variable_2\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"8fdbd0fa-d8b5-4531-8541-f54b7247f0b9\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"ConcatenatedString\",\"type\":\"string\"}]}},\"Apply_to_each\":{\"foreach\":\"@body('Parse_JSON')?['d']?['results']\",\"actions\":{\"Compose_2\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"bd3d5ddd-c9b9-4ef4-a6eb-5feb1c9f292a\"},\"type\":\"Compose\",\"inputs\":\"@concat(variables('ConcatenatedString'), items('Apply_to_each')?['Title'], ', ')\"},\"Set_variable\":{\"runAfter\":{\"Compose_2\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"0d3132a1-60b3-4d2f-ae38-ebd9086f424a\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"ConcatenatedString\",\"value\":\"@{outputs('Compose_2')}\"}}},\"runAfter\":{\"Parse_JSON\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"a028dadf-163d-479a-bb17-79005981eeec\"},\"type\":\"Foreach\"},\"Respond_to_a_Power_App_or_flow\":{\"runAfter\":{\"Compose\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"b0f79533-c453-44b0-8a88-5eee18a03354\"},\"type\":\"Response\",\"kind\":\"PowerApp\",\"inputs\":{\"statusCode\":200,\"body\":{\"stringgroup\":\"@variables('ConcatenatedString')\"},\"schema\":{\"type\":\"object\",\"properties\":{\"stringgroup\":{\"title\":\"StringGroup\",\"x-ms-dynamically-added\":true,\"type\":\"string\"}}}}},\"Send_an_HTTP_request_to_SharePoint_2\":{\"runAfter\":{\"Initialize_variable_2\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"a6f0d040-cd00-4557-8a27-c87217a5bc16\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline_1\",\"operationId\":\"HttpRequest\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"@parameters('GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)')\",\"parameters/method\":\"GET\",\"parameters/uri\":\"_api/web/siteusers/getbyemail('@{triggerBody()['text']}')/groups\",\"parameters/headers\":{\"Accept\":\"application/json;odata=verbose\"}},\"authentication\":\"@parameters('$authentication')\"}},\"Compose\":{\"runAfter\":{\"Apply_to_each\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"8dc2878b-de35-4388-a954-c67492bd9524\"},\"type\":\"Compose\",\"inputs\":\"@substring(variables('ConcatenatedString'), 0, sub(length(variables('ConcatenatedString')), 2))\"}}},\"templateName\":\"\"},\"schemaVersion\":\"1.0.0.0\"}","createdBy":"dd756db8-7340-ef11-a316-7c1e520c07be","modifiedBy":"fd8d629e-ad13-f011-998a-7c1e52679e2f","ownerId":"dd756db8-7340-ef11-a316-7c1e520c07be","owningBusinessUnit":"ee0a9aec-b63d-e911-a81c-000d3a11eefe","owningUser":"dd756db8-7340-ef11-a316-7c1e520c07be"},{"name":"Start approval","createdOn":"2024-10-31T13:04:12Z","modifiedOn":"2025-05-13T23:25:53Z","workflowId":"91ebdd9e-8897-ef11-8a69-000d3a12bba3","resourceId":"d188f1fc-1795-47e0-88fc-29b49eaf89dc","stateCode":"Published","statusCode":"Published","definition":"{\"properties\":{\"connectionReferences\":{\"shared_sharepointonline\":{\"runtimeSource\":\"embedded\",\"connection\":{\"connectionReferenceLogicalName\":\"spo_sharedsharepointonline_84b67\"},\"api\":{\"name\":\"shared_sharepointonline\"}}},\"definition\":{\"$schema\":\"https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"$connections\":{\"defaultValue\":{},\"type\":\"Object\"},\"$authentication\":{\"defaultValue\":{},\"type\":\"SecureObject\"},\"GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)\":{\"defaultValue\":\"https://grote0.sharepoint.com/teams/GDMS\",\"type\":\"String\",\"metadata\":{\"schemaName\":\"spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036\"}},\"Documents (spo_shared_sharepointonline_580e8f207af54f6ab847aa2b8f567849)\":{\"defaultValue\":\"8917edf1-7f2e-4305-a82e-537d4e05a44c\",\"type\":\"String\",\"metadata\":{\"schemaName\":\"spo_shared_sharepointonline_580e8f207af54f6ab847aa2b8f567849\"}},\"Workflows Tasks (spo_shared_sharepointonline_5e3d23cb05204d3db2d0ce33a3ac7f84)\":{\"defaultValue\":\"ea9dfca4-1dd7-4b46-a9c7-b2e083419c97\",\"type\":\"String\",\"metadata\":{\"schemaName\":\"spo_shared_sharepointonline_5e3d23cb05204d3db2d0ce33a3ac7f84\"}},\"Document Types (spo_shared_sharepointonline_9922e182c31f4d05a0af28bafc0daea5)\":{\"defaultValue\":\"a4ba2d89-c0a4-4c5c-be87-f8068251291e\",\"type\":\"String\",\"metadata\":{\"schemaName\":\"spo_shared_sharepointonline_9922e182c31f4d05a0af28bafc0daea5\"}}},\"triggers\":{\"When_an_item_is_created_or_modified\":{\"recurrence\":{\"interval\":1,\"frequency\":\"Minute\"},\"splitOn\":\"@triggerOutputs()?['body/value']\",\"metadata\":{\"operationMetadataId\":\"30615eac-50e9-40ae-a846-3c88614e979d\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"GetOnUpdatedItems\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"@parameters('GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)')\",\"table\":\"@parameters('Documents (spo_shared_sharepointonline_580e8f207af54f6ab847aa2b8f567849)')\"},\"authentication\":\"@parameters('$authentication')\"},\"conditions\":[]}},\"actions\":{\"Get_items\":{\"runAfter\":{\"Condition_2\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"3baff7b7-ae5c-4f43-9200-b2f4aed78622\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"GetItems\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"@parameters('GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)')\",\"table\":\"@parameters('Workflows Tasks (spo_shared_sharepointonline_5e3d23cb05204d3db2d0ce33a3ac7f84)')\",\"$filter\":\"IDFile eq '@{triggerBody()?['ID']}' and Status eq 'In Progress'\"},\"authentication\":\"@parameters('$authentication')\"}},\"Condition\":{\"actions\":{\"Create_item_1\":{\"runAfter\":{\"Create_item\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"a6984021-64cc-4200-bd19-173803ff1f82\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"dataset\":\"@parameters('GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)')\",\"table\":\"fd2e2688-f29d-4e31-ba0a-285fffb3fdb0\",\"item/Title\":\"@triggerBody()?['{Name}']\",\"item/AssignedTo\":\" @{replace(last(split(triggerBody()?['Editor/DisplayName'],',')), ' ', '')} @{first(split(triggerBody()?['Editor/DisplayName'],','))}\",\"item/DocumentTitle\":\"@outputs('Get_file_properties')?['body/GroteDocumentDescription']\",\"item/RelatedItem\":\"https://grote0.sharepoint.com/teams/GDMS?task=@{outputs('Create_item')?['body/ID']}\",\"item/TypeTask\":\"Document pending completion\",\"item/ToEmail\":\"@outputs('Get_file_properties')?['body/Editor/Email']\",\"item/IDDocument\":\"@outputs('Get_file_properties')?['body/ID']\"},\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"PostItem\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"authentication\":\"@parameters('$authentication')\"}},\"Create_item\":{\"runAfter\":{\"Get_item\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"e1a3ed31-f5d5-4111-95cd-f5b2ef6c3020\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"dataset\":\"@parameters('GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)')\",\"table\":\"@parameters('Workflows Tasks (spo_shared_sharepointonline_5e3d23cb05204d3db2d0ce33a3ac7f84)')\",\"item/Title\":\"@triggerBody()?['{Name}']\",\"item/ReasonforChanges\":\"@outputs('Get_file_properties')?['body/GroteRecentChangesReason']\",\"item/ElaboratedBy\":\"@{replace(last(split(triggerBody()?['Editor/DisplayName'],',')), ' ', '')} @{first(split(triggerBody()?['Editor/DisplayName'],','))}\",\"item/ElaboratedDate\":\"@outputs('Get_file_properties')?['body/Created']\",\"item/Status\":\"In Progress\",\"item/RequiredAudiences\":\"@{outputs('Get_file_properties')?['body/GroteDivision/Value']} @{outputs('Get_file_properties')?['body/GroteProcess/Value']} @{outputs('Get_item')?['body/Level/Value']}\",\"item/UserGroup\":\"Originator\",\"item/IDFile\":\"@outputs('Get_file_properties')?['body/ID']\",\"item/TypeTask\":\"Document pending completion\",\"item/Visible\":\"Yes\"},\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"PostItem\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"authentication\":\"@parameters('$authentication')\"}},\"Get_item\":{\"runAfter\":{\"Get_file_properties\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"273c70ba-1e7f-4340-bbf4-812449051671\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"GetItem\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"@parameters('GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)')\",\"table\":\"@parameters('Document Types (spo_shared_sharepointonline_9922e182c31f4d05a0af28bafc0daea5)')\",\"id\":\"@outputs('Get_file_properties')?['body/GroteDocumentType/Id']\"},\"authentication\":\"@parameters('$authentication')\"}},\"Get_file_properties\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"990bd13f-4de9-4212-b5da-3f115d410c4d\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"GetFileItem\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"@parameters('GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)')\",\"table\":\"@parameters('Documents (spo_shared_sharepointonline_580e8f207af54f6ab847aa2b8f567849)')\",\"id\":\"@triggerBody()?['ID']\"},\"authentication\":\"@parameters('$authentication')\"}}},\"runAfter\":{\"Get_items\":[\"Succeeded\"]},\"expression\":{\"and\":[{\"equals\":[\"@length(outputs('Get_items')?['body/value'])\",0]}]},\"metadata\":{\"operationMetadataId\":\"b6bf5935-402b-4088-9448-5a12b48107ef\"},\"type\":\"If\"},\"Condition_2\":{\"actions\":{\"Getitem\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"ee82d9ad-fb9b-4a1f-8d9b-41af9b1a809b\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"GetItems\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"@parameters('GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)')\",\"table\":\"@parameters('Workflows Tasks (spo_shared_sharepointonline_5e3d23cb05204d3db2d0ce33a3ac7f84)')\",\"$filter\":\"IDFile eq '@{triggerBody()?['ID']}'\",\"$orderby\":\"Created asc\",\"$top\":1},\"authentication\":\"@parameters('$authentication')\"}},\"Condition_1\":{\"actions\":{\"Update_file_properties\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"07f8a10e-325e-47a0-b91d-d778147067a9\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"dataset\":\"@parameters('GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)')\",\"table\":\"@parameters('Workflows Tasks (spo_shared_sharepointonline_5e3d23cb05204d3db2d0ce33a3ac7f84)')\",\"id\":\"@first(outputs('Getitem')?['body/value'])?['ID']\",\"item/InternalUpdate\":\"@null\"},\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"PatchFileItem\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"authentication\":\"@parameters('$authentication')\"}},\"Terminate\":{\"runAfter\":{\"Update_file_properties\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"f23eda69-a26b-47b6-82ae-4f79a425268c\"},\"type\":\"Terminate\",\"inputs\":{\"runStatus\":\"Succeeded\"}}},\"runAfter\":{\"Getitem\":[\"Succeeded\"]},\"expression\":{\"or\":[{\"not\":{\"equals\":[\"@first(outputs('Getitem')?['body/value'])?['InternalUpdate']\",\"@null\"]}}]},\"metadata\":{\"operationMetadataId\":\"bba34ffc-1234-4c9e-9eaf-6ce4d75e0178\"},\"type\":\"If\"}},\"runAfter\":{\"Condition_3\":[\"Succeeded\"]},\"expression\":{\"and\":[{\"not\":{\"equals\":[\"@triggerBody()?['LastIDTask']\",\"@null\"]}}]},\"metadata\":{\"operationMetadataId\":\"83c875e7-b3b0-4122-996e-f6ad236d1c50\"},\"type\":\"If\"},\"Get_changes_for_an_item_or_a_file_(properties_only)\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"8bcaf5a6-a2c8-49d2-a5e8-3f64b16b1990\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"GetItemChanges\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"@parameters('GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)')\",\"table\":\"@parameters('Documents (spo_shared_sharepointonline_580e8f207af54f6ab847aa2b8f567849)')\",\"id\":\"@triggerBody()?['ID']\",\"since\":\"@triggerBody()?['{TriggerWindowStartToken}']\",\"until\":\"@triggerBody()?['{TriggerWindowEndToken}']\",\"includeDrafts\":true},\"authentication\":\"@parameters('$authentication')\"}},\"Condition_3\":{\"actions\":{\"Terminate_2\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"384d5534-d057-464e-9eb7-38e53111af28\"},\"type\":\"Terminate\",\"inputs\":{\"runStatus\":\"Succeeded\"}}},\"runAfter\":{\"Get_changes_for_an_item_or_a_file_(properties_only)\":[\"Succeeded\"]},\"expression\":{\"or\":[{\"equals\":[\"@outputs('Get_changes_for_an_item_or_a_file_(properties_only)')?['body/ColumnHasChanged/DisableApproval']\",\"@true\"]},{\"equals\":[\"@triggerBody()?['DisableApproval']\",\"@true\"]}]},\"metadata\":{\"operationMetadataId\":\"8cf2b83d-b9f1-455d-8272-7341e78adeae\"},\"type\":\"If\"}}},\"templateName\":\"\"},\"schemaVersion\":\"1.0.0.0\"}","createdBy":"dd756db8-7340-ef11-a316-7c1e520c07be","modifiedBy":"fd8d629e-ad13-f011-998a-7c1e52679e2f","ownerId":"dd756db8-7340-ef11-a316-7c1e520c07be","owningBusinessUnit":"ee0a9aec-b63d-e911-a81c-000d3a11eefe","owningUser":"dd756db8-7340-ef11-a316-7c1e520c07be"},{"name":"My Approval - GDMS check group","createdOn":"2025-04-30T13:05:37Z","modifiedOn":"2025-04-30T13:07:06Z","workflowId":"1b91fdca-c325-f011-8c4d-7c1e52679e2f","resourceId":"910c5710-dbc3-6c57-2813-f9fd69b0ace1","stateCode":"Published","statusCode":"Published","modernFlowType":"PowerAutomateFlow","definition":"{\"properties\":{\"connectionReferences\":{\"shared_sharepointonline\":{\"runtimeSource\":\"invoker\",\"connection\":{\"connectionReferenceLogicalName\":\"new_sharedsharepointonline_9434e\"},\"api\":{\"name\":\"shared_sharepointonline\"}}},\"definition\":{\"$schema\":\"https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"$connections\":{\"defaultValue\":{},\"type\":\"Object\"},\"$authentication\":{\"defaultValue\":{},\"type\":\"SecureObject\"},\"GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)\":{\"defaultValue\":\"https://grote0.sharepoint.com/teams/GDMS\",\"type\":\"String\",\"metadata\":{\"schemaName\":\"spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036\"}}},\"triggers\":{\"manual\":{\"metadata\":{\"operationMetadataId\":\"24785f2e-2fb7-4e4a-ae6f-04270c691009\"},\"type\":\"Request\",\"kind\":\"PowerAppV2\",\"inputs\":{\"schema\":{\"type\":\"object\",\"properties\":{\"text\":{\"title\":\"userEmail\",\"type\":\"string\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter your input\",\"x-ms-content-hint\":\"TEXT\"}},\"required\":[\"text\"]}}}},\"actions\":{\"Parse_JSON\":{\"runAfter\":{\"Send_an_HTTP_request_to_SharePoint_2\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"e9a50ad1-f91c-4f75-8438-393c0e9b4955\"},\"type\":\"ParseJson\",\"inputs\":{\"content\":\"@body('Send_an_HTTP_request_to_SharePoint_2')\",\"schema\":{\"type\":\"object\",\"properties\":{\"d\":{\"type\":\"object\",\"properties\":{\"results\":{\"type\":\"array\",\"items\":{\"type\":\"object\",\"properties\":{\"Id\":{\"type\":\"integer\"},\"Title\":{\"type\":\"string\"},\"Description\":{\"type\":\"string\"},\"LoginName\":{\"type\":\"string\"}},\"required\":[\"Id\",\"Title\",\"Description\",\"LoginName\"]}}}}}}}},\"Initialize_variable_2\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"8fdbd0fa-d8b5-4531-8541-f54b7247f0b9\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"ConcatenatedString\",\"type\":\"string\"}]}},\"Apply_to_each\":{\"foreach\":\"@body('Parse_JSON')?['d']?['results']\",\"actions\":{\"Compose_2\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"bd3d5ddd-c9b9-4ef4-a6eb-5feb1c9f292a\"},\"type\":\"Compose\",\"inputs\":\"@concat(variables('ConcatenatedString'), items('Apply_to_each')?['Title'], ', ')\"},\"Set_variable\":{\"runAfter\":{\"Compose_2\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"0d3132a1-60b3-4d2f-ae38-ebd9086f424a\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"ConcatenatedString\",\"value\":\"@{outputs('Compose_2')}\"}}},\"runAfter\":{\"Parse_JSON\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"a028dadf-163d-479a-bb17-79005981eeec\"},\"type\":\"Foreach\"},\"Respond_to_a_Power_App_or_flow\":{\"runAfter\":{\"Compose\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"b0f79533-c453-44b0-8a88-5eee18a03354\"},\"type\":\"Response\",\"kind\":\"PowerApp\",\"inputs\":{\"statusCode\":200,\"body\":{\"stringgroup\":\"@variables('ConcatenatedString')\"},\"schema\":{\"type\":\"object\",\"properties\":{\"stringgroup\":{\"title\":\"StringGroup\",\"x-ms-dynamically-added\":true,\"type\":\"string\"}}}}},\"Send_an_HTTP_request_to_SharePoint_2\":{\"runAfter\":{\"Initialize_variable_2\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"a6f0d040-cd00-4557-8a27-c87217a5bc16\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"HttpRequest\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"@parameters('GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)')\",\"parameters/method\":\"GET\",\"parameters/uri\":\"_api/web/siteusers/getbyemail('@{triggerBody()['text']}')/groups\",\"parameters/headers\":{\"Accept\":\"application/json;odata=verbose\"}},\"authentication\":\"@parameters('$authentication')\"}},\"Compose\":{\"runAfter\":{\"Apply_to_each\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"8dc2878b-de35-4388-a954-c67492bd9524\"},\"type\":\"Compose\",\"inputs\":\"@substring(variables('ConcatenatedString'), 0, sub(length(variables('ConcatenatedString')), 2))\"}}},\"templateName\":\"\"},\"schemaVersion\":\"1.0.0.0\"}","createdBy":"fd8d629e-ad13-f011-998a-7c1e52679e2f","modifiedBy":"fd8d629e-ad13-f011-998a-7c1e52679e2f","ownerId":"fd8d629e-ad13-f011-998a-7c1e52679e2f","owningBusinessUnit":"ee0a9aec-b63d-e911-a81c-000d3a11eefe","owningUser":"fd8d629e-ad13-f011-998a-7c1e52679e2f"},{"name":"Attach File","createdOn":"2025-02-21T15:20:09Z","modifiedOn":"2025-04-17T13:53:26Z","workflowId":"b2a13450-67f0-ef11-be21-000d3a53bb9e","resourceId":"fddb4419-f669-acb8-c9a4-3856378c2b34","stateCode":"Published","statusCode":"Published","definition":"{\"properties\":{\"connectionReferences\":{\"shared_sharepointonline\":{\"runtimeSource\":\"invoker\",\"connection\":{\"connectionReferenceLogicalName\":\"spo_sharedsharepointonline_84b67\"},\"api\":{\"name\":\"shared_sharepointonline\"}}},\"definition\":{\"$schema\":\"https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"$connections\":{\"defaultValue\":{},\"type\":\"Object\"},\"$authentication\":{\"defaultValue\":{},\"type\":\"SecureObject\"},\"GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)\":{\"defaultValue\":\"https://grote0.sharepoint.com/teams/GDMS\",\"type\":\"String\",\"metadata\":{\"schemaName\":\"spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036\"}},\"Documents (spo_shared_sharepointonline_580e8f207af54f6ab847aa2b8f567849)\":{\"defaultValue\":\"8917edf1-7f2e-4305-a82e-537d4e05a44c\",\"type\":\"String\",\"metadata\":{\"schemaName\":\"spo_shared_sharepointonline_580e8f207af54f6ab847aa2b8f567849\"}}},\"triggers\":{\"manual\":{\"metadata\":{\"operationMetadataId\":\"33e1c2c4-2977-40a6-b49f-b4e5151a0bd3\"},\"type\":\"Request\",\"kind\":\"PowerAppV2\",\"inputs\":{\"schema\":{\"type\":\"object\",\"properties\":{\"text\":{\"title\":\"AttachTrue\",\"type\":\"string\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter your input\",\"x-ms-content-hint\":\"TEXT\"},\"text_1\":{\"title\":\"dataDivision\",\"type\":\"string\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter your input\",\"x-ms-content-hint\":\"TEXT\"},\"text_2\":{\"title\":\"dataProcess\",\"type\":\"string\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter your input\",\"x-ms-content-hint\":\"TEXT\"},\"text_3\":{\"title\":\"dataDocumentType\",\"type\":\"string\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter your input\",\"x-ms-content-hint\":\"TEXT\"},\"text_4\":{\"title\":\"dataDocumentNumber\",\"type\":\"string\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter your input\",\"x-ms-content-hint\":\"TEXT\"},\"text_5\":{\"title\":\"dataDocumentTitlte\",\"type\":\"string\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter your input\",\"x-ms-content-hint\":\"TEXT\"},\"text_6\":{\"title\":\"dataDocumentRevision\",\"type\":\"string\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter your input\",\"x-ms-content-hint\":\"TEXT\"},\"text_7\":{\"title\":\"dataElaboratedBy\",\"type\":\"string\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter your input\",\"x-ms-content-hint\":\"TEXT\"},\"text_8\":{\"title\":\"dataReasonForChanges\",\"type\":\"string\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter your input\",\"x-ms-content-hint\":\"TEXT\"},\"text_9\":{\"title\":\"dataFileName\",\"type\":\"string\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter your input\",\"x-ms-content-hint\":\"TEXT\"},\"text_10\":{\"title\":\"dataFileContent\",\"type\":\"string\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter your input\",\"x-ms-content-hint\":\"TEXT\"},\"text_11\":{\"title\":\"dataElaboratedDate\",\"type\":\"string\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter your input\",\"x-ms-content-hint\":\"TEXT\"},\"text_12\":{\"title\":\"dataFolders\",\"type\":\"string\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter your input\",\"x-ms-content-hint\":\"TEXT\"},\"text_13\":{\"title\":\"dataDocumentTypeText\",\"type\":\"string\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter your input\",\"x-ms-content-hint\":\"TEXT\"},\"text_14\":{\"title\":\"dataDivisionText\",\"type\":\"string\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter your input\",\"x-ms-content-hint\":\"TEXT\"},\"text_15\":{\"title\":\"dataExtension\",\"type\":\"string\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter your input\",\"x-ms-content-hint\":\"TEXT\"}},\"required\":[\"text\",\"text_1\",\"text_2\",\"text_3\",\"text_4\",\"text_5\",\"text_6\",\"text_7\",\"text_8\",\"text_9\",\"text_10\",\"text_11\",\"text_12\",\"text_13\",\"text_14\",\"text_15\"]}}}},\"actions\":{\"ItemFileName\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"54fd7e33-a114-4e67-b6ba-ec22188519fd\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"ItemFileName\",\"type\":\"string\"}]}},\"ItemUrl\":{\"runAfter\":{\"ItemFileName\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"a1baa0e1-d39a-46b6-926c-02312bc31004\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"ItemUrl\",\"type\":\"string\"}]}},\"NewItemUrl\":{\"runAfter\":{\"ItemUrl\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"d204b6f7-44c6-4568-9caf-5a6ef59fc8de\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"NewItemUrl\",\"type\":\"string\"}]}},\"DataIDFile_Integer\":{\"runAfter\":{\"NewItemUrl\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"a825294c-2366-4735-a74b-2f1d15e4b2f7\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"DataIDFileInteger\",\"type\":\"integer\"}]}},\"ListTitle\":{\"runAfter\":{\"DataIDFile_string\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"e4c55db7-89d7-435f-8a95-1048fcb43961\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"ListTitle\",\"type\":\"string\",\"value\":\"Documents\"}]}},\"MoveToFolderName\":{\"runAfter\":{\"ListTitle\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"17b6026c-75e1-45e3-80a9-7976a7080804\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"MoveToFolderName\",\"type\":\"string\",\"value\":\"@triggerBody()['text_12']\"}]}},\"GetRootFolder\":{\"runAfter\":{\"MoveToFolderName\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"650a9612-2b16-455d-bffc-64da24cd2b36\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"HttpRequest\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"@parameters('GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)')\",\"parameters/method\":\"GET\",\"parameters/uri\":\"_api/Lists/GetByTitle('@{variables('ListTitle')}')/RootFolder\"},\"authentication\":\"@parameters('$authentication')\"}},\"RootFolder\":{\"runAfter\":{\"GetRootFolder\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"ec0c8017-9ee7-4eee-9790-b241d967e151\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"RootFolder\",\"type\":\"string\",\"value\":\"@{body('GetRootFolder')['d']['ServerRelativeUrl']}\"}]}},\"Get_files_(properties_only)\":{\"runAfter\":{\"RootFolder\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"8eb24bc1-81ae-4a1f-9876-28c2ccddb4f5\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"GetFileItems\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"@parameters('GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)')\",\"table\":\"3f53c499-5b2c-4c19-a0f3-dab7cc96cb22\",\"$filter\":\"Location eq '@{triggerBody()['text_14']}' and DocumentType eq '@{triggerBody()['text_13']}'\"},\"authentication\":\"@parameters('$authentication')\"}},\"Get_files_(properties_only)_-_Default_Document\":{\"runAfter\":{\"Get_files_(properties_only)\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"8eb24bc1-81ae-4a1f-9876-28c2ccddb4f5\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"GetFileItems\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"@parameters('GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)')\",\"table\":\"3f53c499-5b2c-4c19-a0f3-dab7cc96cb22\",\"$filter\":\"Location eq null and DocumentType eq null\"},\"authentication\":\"@parameters('$authentication')\"}},\"Compose\":{\"runAfter\":{\"Get_files_(properties_only)_-_Default_Document\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"f3b8a721-56c7-403f-bcad-80b1b9db1281\"},\"type\":\"Compose\",\"inputs\":\"@if(empty(outputs('Get_files_(properties_only)')?['body/value']), first(outputs('Get_files_(properties_only)_-_Default_Document')?['body/value'])?['{Identifier}'], first(outputs('Get_files_(properties_only)')?['body/value'])?['{Identifier}'])\"},\"Condition\":{\"actions\":{\"Create_file\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"21f8fc91-7fab-42df-950d-5c9c59e4242e\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"CreateFile\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"@parameters('GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)')\",\"folderPath\":\"/Shared Documents\",\"name\":\"@{triggerBody()['text_9']}@{triggerBody()['text_15']}\",\"body\":\"@base64ToBinary(triggerBody()['text_10'])\"},\"authentication\":\"@parameters('$authentication')\"},\"runtimeConfiguration\":{\"contentTransfer\":{\"transferMode\":\"Chunked\"}}},\"Update_file_properties\":{\"runAfter\":{\"Delay\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"b658b769-5722-4524-8dc1-2b46a7736eee\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"PatchFileItem\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"@parameters('GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)')\",\"table\":\"@parameters('Documents (spo_shared_sharepointonline_580e8f207af54f6ab847aa2b8f567849)')\",\"id\":\"@outputs('Create_file')?['body/ItemId']\",\"item/GroteDocumentShortDescription\":\"@triggerBody()['text_4']\",\"item/GroteDocumentDescription\":\"@triggerBody()['text_5']\",\"item/GroteDocumentRevision\":\"@triggerBody()['text_6']\",\"item/Title\":\"@triggerBody()['text_9']\",\"item/GroteDivision/Id\":\"@triggerBody()['text_1']\",\"item/GroteProcess/Id\":\"@triggerBody()['text_2']\",\"item/GroteApprovedBy\":\"@null\",\"item/GroteApprovedDate\":\"@null\",\"item/GroteDocumentType/Id\":\"@triggerBody()['text_3']\",\"item/GroteElaboratedBy\":\"@triggerBody()['text_7']\",\"item/GroteRecentChangesReason\":\"@triggerBody()['text_8']\",\"item/GroteElaboratedByDate\":\"@triggerBody()['text_11']\",\"item/ObsoleteInProgress\":false,\"item/Testing\":\"Test\"},\"authentication\":\"@parameters('$authentication')\"}},\"GetItem\":{\"runAfter\":{\"Delay_2\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"c60cd5d0-4065-4c15-aa94-46d0c98fe0ed\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"HttpRequest\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"@parameters('GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)')\",\"parameters/method\":\"GET\",\"parameters/uri\":\"_api/Lists/GetByTitle('@{variables('ListTitle')}')/Items(@{outputs('Update_file_properties')?['body/ID']})?$select=*,FileRef,FileDirRef,FileLeafRef\"},\"authentication\":\"@parameters('$authentication')\"}},\"Set_-_ItemFileName\":{\"runAfter\":{\"GetItem\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"77e2d236-bd86-4a5c-b4f7-70a296f85c13\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"ItemFileName\",\"value\":\"@{body('GetItem')['d']['FileLeafRef']}\"}},\"Set_-_ItemUrl\":{\"runAfter\":{\"Set_-_ItemFileName\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"ad1e3195-e0de-4760-b4db-e1d619c3b741\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"ItemUrl\",\"value\":\"@{body('GetItem')['d']['FileRef']}\"}},\"Set_variable\":{\"runAfter\":{\"Set_-_ItemUrl\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"2fd062d4-6901-4a25-bcba-9cfaef4bedb4\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"DataIDFileString\",\"value\":\"@{outputs('Update_file_properties')?['body/ID']}\"}},\"Delay\":{\"runAfter\":{\"Create_file\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"ebabc39c-f0f7-4c49-b082-2a7b8f2d3017\"},\"type\":\"Wait\",\"inputs\":{\"interval\":{\"count\":2,\"unit\":\"Second\"}}},\"Delay_2\":{\"runAfter\":{\"Update_file_properties\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"ebabc39c-f0f7-4c49-b082-2a7b8f2d3017\"},\"type\":\"Wait\",\"inputs\":{\"interval\":{\"count\":2,\"unit\":\"Second\"}}}},\"runAfter\":{\"Compose\":[\"Succeeded\"]},\"else\":{\"actions\":{\"Update_file_properties_2\":{\"runAfter\":{\"Delay_4\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"b658b769-5722-4524-8dc1-2b46a7736eee\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"PatchFileItem\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"@parameters('GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)')\",\"table\":\"@parameters('Documents (spo_shared_sharepointonline_580e8f207af54f6ab847aa2b8f567849)')\",\"id\":\"@outputs('Create_file_2')?['body/ItemId']\",\"item/GroteDocumentShortDescription\":\"@triggerBody()['text_4']\",\"item/GroteDocumentDescription\":\"@triggerBody()['text_5']\",\"item/GroteDocumentRevision\":\"@triggerBody()['text_6']\",\"item/Title\":\"@triggerBody()['text_9']\",\"item/GroteDivision/Id\":\"@triggerBody()['text_1']\",\"item/GroteProcess/Id\":\"@triggerBody()['text_2']\",\"item/GroteApprovedBy\":\"@null\",\"item/GroteApprovedDate\":\"@null\",\"item/GroteDocumentType/Id\":\"@triggerBody()['text_3']\",\"item/GroteElaboratedBy\":\"@triggerBody()['text_7']\",\"item/GroteRecentChangesReason\":\"@triggerBody()['text_8']\",\"item/GroteElaboratedByDate\":\"@triggerBody()['text_11']\",\"item/ObsoleteInProgress\":false,\"item/Testing\":\"Test\"},\"authentication\":\"@parameters('$authentication')\"}},\"GetItem_2\":{\"runAfter\":{\"Delay_5\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"79a130be-95c9-4065-96b1-d6edbb612ad4\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"HttpRequest\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"@parameters('GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)')\",\"parameters/method\":\"GET\",\"parameters/uri\":\"_api/Lists/GetByTitle('@{variables('ListTitle')}')/Items(@{outputs('Update_file_properties_2')?['body/ID']})?$select=*,FileRef,FileDirRef,FileLeafRef\"},\"authentication\":\"@parameters('$authentication')\"}},\"Set_-_ItemFileName_2\":{\"runAfter\":{\"GetItem_2\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"ba0b3960-3a5c-4e52-8d30-4ebd3b99b5f2\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"ItemFileName\",\"value\":\"@{body('GetItem_2')['d']['FileLeafRef']}\"}},\"Set_-_ItemUrl_2\":{\"runAfter\":{\"Set_-_ItemFileName_2\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"07fbefcb-441d-4377-943c-273c977c9eaa\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"ItemUrl\",\"value\":\"@{body('GetItem_2')['d']['FileRef']}\"}},\"Get_file_content\":{\"runAfter\":{},\"metadata\":{\"%252fDocument%2bTemplates%252fGDMS%2bDocument%2bTemplate.docx\":\"/Document Templates/GDMS Document Template.docx\",\"operationMetadataId\":\"d8fbdd4b-f9f7-4678-a286-6e168168b81e\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"GetFileContent\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"@parameters('GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)')\",\"id\":\"@outputs('Compose')\",\"inferContentType\":true},\"authentication\":\"@parameters('$authentication')\"}},\"Set_variable_2\":{\"runAfter\":{\"Set_-_ItemUrl_2\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"20e4819c-a0e1-4bc6-88ab-581a7cc06cc0\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"DataIDFileInteger\",\"value\":\"@outputs('Create_file_2')?['body/ItemId']\"}},\"Create_file_2\":{\"runAfter\":{\"Delay_3\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"21f8fc91-7fab-42df-950d-5c9c59e4242e\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"CreateFile\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"@parameters('GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)')\",\"folderPath\":\"/Shared Documents\",\"name\":\"@{triggerBody()['text_9']}.@{if(empty(outputs('Get_files_(properties_only)')?['body/value']), last(split(last(outputs('Get_files_(properties_only)_-_Default_Document')?['body/value'])?['{FilenameWithExtension}'], '.')), last(split(first(outputs('Get_files_(properties_only)')?['body/value'])?['{FilenameWithExtension}'], '.')))}\",\"body\":\"@body('Get_file_content')\"},\"authentication\":\"@parameters('$authentication')\"},\"runtimeConfiguration\":{\"contentTransfer\":{\"transferMode\":\"Chunked\"}}},\"Delay_3\":{\"runAfter\":{\"Get_file_content\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"ebabc39c-f0f7-4c49-b082-2a7b8f2d3017\"},\"type\":\"Wait\",\"inputs\":{\"interval\":{\"count\":2,\"unit\":\"Second\"}}},\"Delay_4\":{\"runAfter\":{\"Create_file_2\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"ebabc39c-f0f7-4c49-b082-2a7b8f2d3017\"},\"type\":\"Wait\",\"inputs\":{\"interval\":{\"count\":2,\"unit\":\"Second\"}}},\"Delay_5\":{\"runAfter\":{\"Update_file_properties_2\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"ebabc39c-f0f7-4c49-b082-2a7b8f2d3017\"},\"type\":\"Wait\",\"inputs\":{\"interval\":{\"count\":2,\"unit\":\"Second\"}}}}},\"expression\":{\"equals\":[\"@triggerBody()['text']\",\"TrueFile\"]},\"metadata\":{\"operationMetadataId\":\"a45f2940-260c-49d8-93ea-3ed8e61a1d63\"},\"type\":\"If\"},\"Set_-_NewItemUrl\":{\"runAfter\":{\"Condition\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"95b4e335-23b7-41f6-ad11-24fca70af243\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"NewItemUrl\",\"value\":\"@{concat(variables('RootFolder'), '/', variables('MoveToFolderName'), '/', variables('ItemFileName'))}\"}},\"Condition_2\":{\"actions\":{\"Send_an_HTTP_request_to_SharePoint\":{\"runAfter\":{},\"limit\":{\"timeout\":\"PT5M\"},\"metadata\":{\"operationMetadataId\":\"9fbd969c-323d-425b-9717-1e9ffba655ad\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"HttpRequest\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"@parameters('GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)')\",\"parameters/method\":\"POST\",\"parameters/uri\":\"_api/Web/getFileByServerRelativeURL('@{variables('ItemUrl')}')/moveTo(newurl='@{variables('NewItemUrl')}', flags=1)\"},\"authentication\":\"@parameters('$authentication')\"}},\"Terminate\":{\"runAfter\":{\"Send_an_HTTP_request_to_SharePoint\":[\"TimedOut\",\"Skipped\"]},\"metadata\":{\"operationMetadataId\":\"36c0bd2c-ec2c-410c-9e7b-dc169e3d9688\"},\"type\":\"Terminate\",\"inputs\":{\"runStatus\":\"Cancelled\"}}},\"runAfter\":{\"Set_-_NewItemUrl\":[\"Succeeded\"]},\"expression\":{\"not\":{\"equals\":[\"@variables('ItemUrl')\",\"@variables('NewItemUrl')\"]}},\"metadata\":{\"operationMetadataId\":\"f2fa1b49-709a-48d5-a40c-575050af5616\"},\"type\":\"If\"},\"DataIDFile_string\":{\"runAfter\":{\"DataIDFile_Integer\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"a825294c-2366-4735-a74b-2f1d15e4b2f7\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"DataIDFileString\",\"type\":\"string\"}]}},\"Condition_1\":{\"actions\":{\"Respond_to_a_Power_App_String\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"1f34b89a-c7d0-4740-babe-b05eaa248ed7\"},\"type\":\"Response\",\"kind\":\"PowerApp\",\"inputs\":{\"statusCode\":200,\"body\":{\"dataidfile\":\"@{variables('DataIDFileString')}\"},\"schema\":{\"type\":\"object\",\"properties\":{\"dataidfile\":{\"title\":\"dataidfile\",\"x-ms-dynamically-added\":true,\"type\":\"string\"}}}}}},\"runAfter\":{\"Set_-_NewItemUrl\":[\"Succeeded\"]},\"else\":{\"actions\":{\"Respond_to_a_Power_App_or_flow_Integer\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"1f34b89a-c7d0-4740-babe-b05eaa248ed7\"},\"type\":\"Response\",\"kind\":\"PowerApp\",\"inputs\":{\"statusCode\":200,\"body\":{\"dataidfile\":\"@{variables('DataIDFileInteger')}\"},\"schema\":{\"type\":\"object\",\"properties\":{\"dataidfile\":{\"title\":\"dataidfile\",\"x-ms-dynamically-added\":true,\"type\":\"string\"}}}}}}},\"expression\":{\"and\":[{\"equals\":[\"@triggerBody()?['text']\",\"TrueFile\"]}]},\"metadata\":{\"operationMetadataId\":\"2281fe92-6720-4d4b-81aa-a05dec64f1c5\"},\"type\":\"If\"}}},\"templateName\":\"\"},\"schemaVersion\":\"1.0.0.0\"}","createdBy":"dd756db8-7340-ef11-a316-7c1e520c07be","modifiedBy":"fd8d629e-ad13-f011-998a-7c1e52679e2f","ownerId":"dd756db8-7340-ef11-a316-7c1e520c07be","owningBusinessUnit":"ee0a9aec-b63d-e911-a81c-000d3a11eefe","owningUser":"dd756db8-7340-ef11-a316-7c1e520c07be"},{"name":"Notification Center Daily","createdOn":"2024-09-04T18:48:24Z","modifiedOn":"2025-04-16T20:03:17Z","workflowId":"facfdc3e-ee6a-ef11-a671-00224821a984","resourceId":"eee7bea4-d689-09d2-30bd-84b5870013de","stateCode":"Draft","statusCode":"Draft","definition":"{\"properties\":{\"connectionReferences\":{\"shared_sharepointonline\":{\"api\":{\"name\":\"shared_sharepointonline\"},\"connection\":{\"connectionReferenceLogicalName\":\"spo_sharedsharepointonline_84b67\"},\"runtimeSource\":\"embedded\"},\"shared_office365_1\":{\"api\":{\"name\":\"shared_office365\"},\"connection\":{\"connectionReferenceLogicalName\":\"spo_sharedoffice365_bfdbb\"},\"runtimeSource\":\"embedded\"}},\"definition\":{\"$schema\":\"https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"$authentication\":{\"defaultValue\":{},\"type\":\"SecureObject\"},\"$connections\":{\"defaultValue\":{},\"type\":\"Object\"},\"GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)\":{\"defaultValue\":\"https://grote0.sharepoint.com/teams/GDMS\",\"type\":\"String\",\"metadata\":{\"schemaName\":\"spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036\"}},\"Workflows Tasks (spo_shared_sharepointonline_5e3d23cb05204d3db2d0ce33a3ac7f84)\":{\"defaultValue\":\"ea9dfca4-1dd7-4b46-a9c7-b2e083419c97\",\"type\":\"String\",\"metadata\":{\"schemaName\":\"spo_shared_sharepointonline_5e3d23cb05204d3db2d0ce33a3ac7f84\"}},\"Documents (spo_shared_sharepointonline_580e8f207af54f6ab847aa2b8f567849)\":{\"defaultValue\":\"8917edf1-7f2e-4305-a82e-537d4e05a44c\",\"type\":\"String\",\"metadata\":{\"schemaName\":\"spo_shared_sharepointonline_580e8f207af54f6ab847aa2b8f567849\"}},\"Read Tasks (spo_shared_sharepointonline_0df7196447074054aaa21c20eda85e60)\":{\"defaultValue\":\"2b048f31-68ad-48d9-911d-02e04cda5e6e\",\"type\":\"String\",\"metadata\":{\"schemaName\":\"spo_shared_sharepointonline_0df7196447074054aaa21c20eda85e60\"}}},\"triggers\":{\"Recurrence\":{\"type\":\"Recurrence\",\"recurrence\":{\"frequency\":\"Day\",\"interval\":1,\"timeZone\":\"Eastern Standard Time\",\"startTime\":\"2024-09-04T13:00:00.000Z\",\"schedule\":{\"hours\":[\"9\"]}},\"metadata\":{\"operationMetadataId\":\"20e17fc3-14f8-414e-8b4f-143e357655e6\"}}},\"actions\":{\"Initialize_variable_-_EmailArray\":{\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"EmailArray\",\"type\":\"array\"}]},\"runAfter\":{\"Initialize_variable_-_fileExtension\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"c7913946-3e36-44e7-b886-8a3f0cbdf1dd\"}},\"Get_items\":{\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"dataset\":\"@parameters('GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)')\",\"table\":\"@parameters('Workflows Tasks (spo_shared_sharepointonline_5e3d23cb05204d3db2d0ce33a3ac7f84)')\",\"$filter\":\"(UserGroup eq 'Reviewer' or UserGroup eq 'Approver') and Status eq 'In Progress'\"},\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"operationId\":\"GetItems\",\"connectionName\":\"shared_sharepointonline\"}},\"runAfter\":{\"Initialize_variable_-_EmailRead\":[\"Succeeded\"]},\"runtimeConfiguration\":{\"paginationPolicy\":{\"minimumItemCount\":100000}},\"metadata\":{\"operationMetadataId\":\"8396093b-3145-4adb-a6b1-0334ea8ae6ba\"}},\"For_each_1\":{\"type\":\"Foreach\",\"foreach\":\"@outputs('Get_items')?['body/value']\",\"actions\":{\"Condition_1\":{\"type\":\"If\",\"expression\":{\"and\":[{\"greaterOrEquals\":[\"@utcNow()\",\"@addDays(items('For_each_1')?['StartDateTasks'],7)\"]}]},\"actions\":{\"Send_an_HTTP_request_to_SharePoint\":{\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"dataset\":\"@parameters('GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)')\",\"parameters/method\":\"GET\",\"parameters/uri\":\"_api/Web/SiteGroups/GetByName('@{items('For_each_1')?['RequiredAudiences']}')/users?$select=Email,Id\"},\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"operationId\":\"HttpRequest\",\"connectionName\":\"shared_sharepointonline\"}},\"runAfter\":{\"Get_file_properties\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"85e09516-db5a-4fb6-9c31-bd6f5018004f\"}},\"Parse_JSON\":{\"type\":\"ParseJson\",\"inputs\":{\"content\":\"@body('Send_an_HTTP_request_to_SharePoint')\",\"schema\":{\"type\":\"object\",\"properties\":{\"d\":{\"type\":\"object\",\"properties\":{\"results\":{\"type\":\"array\",\"items\":{\"type\":\"object\",\"properties\":{\"__metadata\":{\"type\":\"object\",\"properties\":{\"id\":{\"type\":\"string\"},\"uri\":{\"type\":\"string\"},\"type\":{\"type\":\"string\"}}},\"Id\":{\"type\":\"integer\"},\"Email\":{\"type\":\"string\"}},\"required\":[\"__metadata\",\"Id\",\"Email\"]}}}}}}},\"runAfter\":{\"Send_an_HTTP_request_to_SharePoint\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"4b781097-d987-40e7-9f45-475a56b83590\"}},\"Compose\":{\"type\":\"Compose\",\"inputs\":\"@join(variables('EmailArray'), ';')\",\"runAfter\":{\"For_each\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"0370bb0b-a02d-4de3-90db-804f102733b1\"}},\"For_each\":{\"type\":\"Foreach\",\"foreach\":\"@outputs('Parse_JSON')?['body']?['d']?['results']\",\"actions\":{\"Append_to_array_variable\":{\"type\":\"AppendToArrayVariable\",\"inputs\":{\"name\":\"EmailArray\",\"value\":\"@items('For_each')?['Email']\"},\"metadata\":{\"operationMetadataId\":\"35f9e3b9-6600-4686-a563-ead9df036cdd\"}}},\"runAfter\":{\"Parse_JSON\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"210508f4-3b7b-4fa8-8257-c660280bf452\"}},\"Get_file_properties\":{\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"dataset\":\"@parameters('GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)')\",\"table\":\"@parameters('Documents (spo_shared_sharepointonline_580e8f207af54f6ab847aa2b8f567849)')\",\"id\":\"@items('For_each_1')?['IDFile']\"},\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"operationId\":\"GetFileItem\",\"connectionName\":\"shared_sharepointonline\"}},\"metadata\":{\"operationMetadataId\":\"d89ebff8-f730-44a2-ae2e-19dcb23201fa\"}},\"Condition_2\":{\"type\":\"If\",\"expression\":{\"and\":[{\"equals\":[\"@item()?['TypeTask']\",\"Please approve the following obsolete document\"]}]},\"actions\":{\"Compose_4\":{\"type\":\"Compose\",\"inputs\":\"<p>The following item is <span style=\\\"color: rgb(208, 2, 27);\\\">overdue</span>:<br>\\n<br>\\n<a href=\\\"https://grote0.sharepoint.com/teams/GDMS?task=@{items('For_each_1')?['IDFile']}\\\">@{items('For_each_1')?['Title']} - Please approve the following document</a><br>\\n<br>\\n<b>ASSIGNED TO</b>&nbsp;@{items('For_each_1')?['RequiredAudiences']}<br>\\n<b>DUE DATE</b>&nbsp;<span style=\\\"color: rgb(208, 2, 27);\\\">@{items('For_each_1')?['DueDate']}</span><br>\\n<b>RELATED ITEM</b>&nbsp;<a href=\\\"@{variables('fileExtension')}\\\">@{items('For_each_1')?['Title']}</a><br>\\n<br>\\n</p>\",\"metadata\":{\"operationMetadataId\":\"87cf8459-86d2-4796-8310-385f1d5d3ccd\"}},\"Send_an_email_(V2)-copy\":{\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"emailMessage/To\":\"@outputs('Compose')\",\"emailMessage/Subject\":\"Task Overdue - @{items('For_each_1')?['Title']} - Please approve the following document\",\"emailMessage/Body\":\"<p class=\\\"editor-paragraph\\\">@{outputs('Compose_4')}</p>\",\"emailMessage/Importance\":\"Normal\"},\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_office365\",\"operationId\":\"SendEmailV2\",\"connectionName\":\"shared_office365_1\"}},\"runAfter\":{\"Compose_4\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"a3b2e48e-926e-489f-8a44-4f3b4bbe77f3\"}}},\"else\":{\"actions\":{\"Compose_1\":{\"type\":\"Compose\",\"inputs\":\"<p>The following item is <span style=\\\"color: rgb(208, 2, 27);\\\">overdue</span>:<br>\\n<br>\\n<a href=\\\"https://grote0.sharepoint.com/teams/GDMS?task=@{items('For_each_1')?['IDFile']}\\\">@{items('For_each_1')?['Title']} - Please approve the following document</a><br>\\n<br>\\n<b>ASSIGNED TO</b>&nbsp;@{items('For_each_1')?['RequiredAudiences']}<br>\\n<b>DUE DATE</b>&nbsp;<span style=\\\"color: rgb(208, 2, 27);\\\">@{items('For_each_1')?['DueDate']}</span><br>\\n<b>DESCRIPTION</b>&nbsp;@{items('For_each_1')?['ReasonforChanges']}<br>\\n<b>RELATED ITEM</b>&nbsp;<a href=\\\"@{variables('fileExtension')}\\\">@{items('For_each_1')?['Title']}</a><br>\\n<br>\\n</p>\",\"metadata\":{\"operationMetadataId\":\"87cf8459-86d2-4796-8310-385f1d5d3ccd\"}},\"Send_an_email_(V2)\":{\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"emailMessage/To\":\"@outputs('Compose')\",\"emailMessage/Subject\":\"Task Overdue - @{items('For_each_1')?['Title']} - Please approve the following document\",\"emailMessage/Body\":\"<p class=\\\"editor-paragraph\\\">@{outputs('Compose_1')}</p>\",\"emailMessage/Importance\":\"Normal\"},\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_office365\",\"operationId\":\"SendEmailV2\",\"connectionName\":\"shared_office365_1\"}},\"runAfter\":{\"Compose_1\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"a3b2e48e-926e-489f-8a44-4f3b4bbe77f3\"}}}},\"runAfter\":{\"Set_variable\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"457d6cb4-be94-4be3-becc-a9f8c2796c14\"}},\"Set_variable\":{\"type\":\"SetVariable\",\"inputs\":{\"name\":\"fileExtension\",\"value\":\"@{if(equals(toLower(last(split(outputs('Get_file_properties')?['body/{FilenameWithExtension}'], '.'))), 'docx'), 'ms-word:ofe|u|', '')}@{first(split(outputs('Get_file_properties')?['body/{Link}'], outputs('Get_file_properties')?['body/{FilenameWithExtension}']))}@{outputs('Get_file_properties')?['body/{FilenameWithExtension}']}\"},\"runAfter\":{\"Compose\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"1357aef1-b523-4e6d-9361-098baa284798\"}}},\"else\":{\"actions\":{}},\"metadata\":{\"operationMetadataId\":\"5f763c6d-1646-42de-b619-3c5ca2c7f378\"}}},\"runAfter\":{\"Get_items\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"66893e92-6cec-42f0-b044-c68502b0fbab\"}},\"Get_items_2\":{\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"dataset\":\"@parameters('GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)')\",\"table\":\"@parameters('Read Tasks (spo_shared_sharepointonline_0df7196447074054aaa21c20eda85e60)')\",\"$filter\":\"Status eq 'Assigned'\"},\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"operationId\":\"GetItems\",\"connectionName\":\"shared_sharepointonline\"}},\"runAfter\":{\"Initialize_variable_-_EmailRead\":[\"Succeeded\"]},\"runtimeConfiguration\":{\"paginationPolicy\":{\"minimumItemCount\":100000}},\"metadata\":{\"operationMetadataId\":\"5618d9e9-b3d3-4c23-829e-97606f477033\"}},\"For_each_2\":{\"type\":\"Foreach\",\"foreach\":\"@outputs('Get_items_2')?['body/value']\",\"actions\":{\"Condition\":{\"type\":\"If\",\"expression\":{\"and\":[{\"greater\":[\"@utcNow()\",\"@items('For_each_2')?['DueDate']\"]}]},\"actions\":{\"Compose_3\":{\"type\":\"Compose\",\"inputs\":\"<p>\\n<span style=\\\"font-size: 16px\\\"><strong>Reading Task Overdue</strong></span><br>\\nTask Created on: @{formatDateTime(items('For_each_2')?['Created'], 'yyyy-MM-dd')}<br>\\nTask Deadline: @{items('For_each_2')?['DueDate']}<br>\\n<br>\\nThe reading task assigned to you on the @{formatDateTime(items('For_each_2')?['Created'], 'yyyy-MM-dd')} to read the document \\\"@{outputs('Get_file_properties_2')?['body/{Name}']}\\\" is now overdue.<br>\\n<br>\\nTo complete the reading task please follow the instructions below.<br>\\n<br>\\n* <strong>Step 1:</strong> Select the following link to view and confirm your task: <a href=\\\"https://grote0.sharepoint.com/teams/GDMS?task=@{items('For_each_2')?['ID']}\\\">View Task</a>.<br>\\n* <strong>Step 2:</strong> Ensure that you read and fully understand the contents of the document and that you agree with the Terms and Conditions statement.<br>\\n* <strong>Step 3:</strong> Check the box and click the \\\"Confirm\\\" button.</p>\",\"runAfter\":{\"Set_variable_-_EmailRead\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"25df4450-14e7-4bc3-bffd-5b76d2ebe298\"}},\"Send_an_email_(V2)_2\":{\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"emailMessage/To\":\"@variables('EmailRead')\",\"emailMessage/Subject\":\"A reading task assigned to you is now overdue\",\"emailMessage/Body\":\"<p>@{outputs('Compose_3')}</p>\",\"emailMessage/Importance\":\"Normal\"},\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_office365\",\"operationId\":\"SendEmailV2\",\"connectionName\":\"shared_office365_1\"}},\"runAfter\":{\"Compose_3\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"986ceaba-164c-4cd8-9e0a-a69e2f4fe157\"}},\"Get_file_properties_2\":{\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"dataset\":\"@parameters('GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)')\",\"table\":\"@parameters('Documents (spo_shared_sharepointonline_580e8f207af54f6ab847aa2b8f567849)')\",\"id\":\"@items('For_each_2')?['IDFile']\"},\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"operationId\":\"GetFileItem\",\"connectionName\":\"shared_sharepointonline\"}},\"metadata\":{\"operationMetadataId\":\"e5de77db-ef03-434b-b330-ee3b4e29a001\"}},\"Set_variable_-_EmailRead\":{\"type\":\"SetVariable\",\"inputs\":{\"name\":\"EmailRead\",\"value\":\"@items('For_each_2')?['IncompleteBy']\"},\"runAfter\":{\"Get_file_properties_2\":[\"Succeeded\"]}}},\"else\":{\"actions\":{}},\"metadata\":{\"operationMetadataId\":\"1a068349-d431-4d3d-987e-ece90ace6a20\"}}},\"runAfter\":{\"Get_items_2\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"7d3df24f-2f0f-4b5b-8cda-3ead7357a1b7\"}},\"Initialize_variable_-_EmailRead\":{\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"EmailRead\",\"type\":\"string\"}]},\"runAfter\":{\"Initialize_variable_-_EmailArray\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"f135a2b0-71af-4e44-9d05-c8566bbcd7e4\"}},\"Initialize_variable_-_fileExtension\":{\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"fileExtension\",\"type\":\"string\"}]},\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"71ffc213-c02c-42b5-a85a-28ed537fa8d4\"}}}}},\"schemaVersion\":\"1.0.0.0\"}","createdBy":"dd756db8-7340-ef11-a316-7c1e520c07be","modifiedBy":"dd756db8-7340-ef11-a316-7c1e520c07be","ownerId":"dd756db8-7340-ef11-a316-7c1e520c07be","owningBusinessUnit":"ee0a9aec-b63d-e911-a81c-000d3a11eefe","owningUser":"dd756db8-7340-ef11-a316-7c1e520c07be"},{"name":"Assign Read","createdOn":"2024-09-12T23:18:31Z","modifiedOn":"2025-04-08T14:13:06Z","workflowId":"405a4652-5d71-ef11-a671-00224821a984","resourceId":"da3f5348-773b-d968-2d47-dab2af2278e5","stateCode":"Published","statusCode":"Published","definition":"{\"properties\":{\"connectionReferences\":{\"shared_sharepointonline\":{\"runtimeSource\":\"embedded\",\"connection\":{\"connectionReferenceLogicalName\":\"spo_sharedsharepointonline_84b67\"},\"api\":{\"name\":\"shared_sharepointonline\"}}},\"definition\":{\"$schema\":\"https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"$connections\":{\"defaultValue\":{},\"type\":\"Object\"},\"$authentication\":{\"defaultValue\":{},\"type\":\"SecureObject\"},\"GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)\":{\"defaultValue\":\"https://grote0.sharepoint.com/teams/GDMS\",\"type\":\"String\",\"metadata\":{\"schemaName\":\"spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036\"}},\"Data Group Owners (spo_DataGroupOwners)\":{\"defaultValue\":\"Grote Document Management System Owners\",\"type\":\"String\",\"metadata\":{\"schemaName\":\"spo_DataGroupOwners\"}},\"Read Tasks (spo_shared_sharepointonline_0df7196447074054aaa21c20eda85e60)\":{\"defaultValue\":\"2b048f31-68ad-48d9-911d-02e04cda5e6e\",\"type\":\"String\",\"metadata\":{\"schemaName\":\"spo_shared_sharepointonline_0df7196447074054aaa21c20eda85e60\"}}},\"triggers\":{\"When_an_item_is_created\":{\"recurrence\":{\"interval\":5,\"frequency\":\"Minute\"},\"splitOn\":\"@triggerOutputs()?['body/value']\",\"metadata\":{\"operationMetadataId\":\"17a610aa-fddf-4a80-bc72-cdf7536a17b0\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"GetOnNewItems\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"@parameters('GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)')\",\"table\":\"@parameters('Read Tasks (spo_shared_sharepointonline_0df7196447074054aaa21c20eda85e60)')\"},\"authentication\":\"@parameters('$authentication')\"}}},\"actions\":{\"Send_an_HTTP_request_to_SharePoint_-_Get_roles\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"4886a629-f1a8-4458-8831-6a3efbb7eed0\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"HttpRequest\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"@parameters('GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)')\",\"parameters/method\":\"GET\",\"parameters/uri\":\"_api/web/roledefinitions\"},\"authentication\":\"@parameters('$authentication')\"}},\"Filter_array_-_Owners_permission_role\":{\"runAfter\":{\"Initialize_variable_-_ConcatEmails\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"e354a24a-2414-4c85-afca-0d77b0781ced\"},\"type\":\"Query\",\"inputs\":{\"from\":\"@body('Send_an_HTTP_request_to_SharePoint_-_Get_roles')?['d/results']\",\"where\":\"@equals(item()?['Name'], 'Full Control')\"}},\"Compose_-_Owners_permission_role_ID\":{\"runAfter\":{\"Filter_array_-_Owners_permission_role\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"25989c6c-286b-4e2c-b717-ff742297f034\"},\"type\":\"Compose\",\"inputs\":\"@first(body('Filter_array_-_Owners_permission_role'))?['Id']\"},\"NEW_Filter_array_-_Members_role_2\":{\"runAfter\":{\"Compose_-_Owners_permission_role_ID\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"ad838c4f-92be-4715-9a7b-ddd7d31dbef1\"},\"type\":\"Query\",\"inputs\":{\"from\":\"@body('Send_an_HTTP_request_to_SharePoint_-_Get_roles')?['d/results']\",\"where\":\"@equals(item()?['Name'], 'Edit')\"}},\"NEW_Compose_-_Members_role_ID_2\":{\"runAfter\":{\"NEW_Filter_array_-_Members_role_2\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"5415ac2b-cd9b-4f28-a412-683e3643c209\"},\"type\":\"Compose\",\"inputs\":\"@first(body('NEW_Filter_array_-_Members_role_2'))?['Id']\"},\"Send_an_HTTP_request_to_SharePoint_-_Break_role_inheritance\":{\"runAfter\":{\"NEW_Compose_-_Members_role_ID_2\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"5e04299f-3770-4b1e-b90b-892682e52ba6\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"HttpRequest\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"@parameters('GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)')\",\"parameters/method\":\"POST\",\"parameters/uri\":\"_api/lists/GetById('@{parameters('Read Tasks (spo_shared_sharepointonline_0df7196447074054aaa21c20eda85e60)')}')/items(@{triggerOutputs()?['body/ID']})/breakroleinheritance(copyRoleAssignments=false,clearSubscopes=true)\"},\"authentication\":\"@parameters('$authentication')\"}},\"Stop_sharing_an_item_or_a_file\":{\"runAfter\":{\"Send_an_HTTP_request_to_SharePoint_-_Break_role_inheritance\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"c118bff3-e668-47d5-ae64-0d7b60b8b1f1\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"UnshareItem\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"@parameters('GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)')\",\"table\":\"@parameters('Read Tasks (spo_shared_sharepointonline_0df7196447074054aaa21c20eda85e60)')\",\"id\":\"@triggerOutputs()?['body/ID']\"},\"authentication\":\"@parameters('$authentication')\"}},\"Send_an_HTTP_request_to_SharePoint_-_Get_owners_group_by_name\":{\"runAfter\":{\"Stop_sharing_an_item_or_a_file\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"1b8b8cd5-3dbb-4737-a932-337b76644d1f\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"HttpRequest\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"@parameters('GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)')\",\"parameters/method\":\"GET\",\"parameters/uri\":\"_api/web/sitegroups?$filter=LoginName eq '@{parameters('Data Group Owners (spo_DataGroupOwners)')}'&$select=Id&top=1\"},\"authentication\":\"@parameters('$authentication')\"}},\"Compose_-_Get_owners_group_ID\":{\"runAfter\":{\"Send_an_HTTP_request_to_SharePoint_-_Get_owners_group_by_name\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"44911bfa-8890-4134-a955-07883e1b16e7\"},\"type\":\"Compose\",\"inputs\":\"@body('Send_an_HTTP_request_to_SharePoint_-_Get_owners_group_by_name')?['d/results'][0]?['Id']\"},\"Send_an_HTTP_request_to_SharePoint_-_Grant_permission_to_owners\":{\"runAfter\":{\"Compose_-_Get_owners_group_ID\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"9525f29f-4ba3-4490-825c-6e0e877af3ec\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"HttpRequest\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"@parameters('GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)')\",\"parameters/method\":\"POST\",\"parameters/uri\":\"_api/web/lists/GetById('@{parameters('Read Tasks (spo_shared_sharepointonline_0df7196447074054aaa21c20eda85e60)')}')/items(@{triggerOutputs()?['body/ID']})/roleassignments/addroleassignment(principalid='@{outputs('Compose_-_Get_owners_group_ID')}', roleDefId=@{outputs('Compose_-_Owners_permission_role_ID')})\"},\"authentication\":\"@parameters('$authentication')\"}},\"NEW_Send_an_HTTP_request_to_SharePoint_-_Get_members_group_by_name_2\":{\"runAfter\":{\"Send_an_HTTP_request_to_SharePoint_-_Grant_permission_to_owners\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"8a7ad2ef-a865-42e7-881d-f40eee2a277b\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"HttpRequest\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"@parameters('GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)')\",\"parameters/method\":\"GET\",\"parameters/uri\":\"_api/web/sitegroups?$filter=LoginName eq '@{triggerOutputs()?['body/Audicence']}'&$select=Id&top=1\"},\"authentication\":\"@parameters('$authentication')\"}},\"NEW_Compose_-_Get_members_group_ID_2\":{\"runAfter\":{\"NEW_Send_an_HTTP_request_to_SharePoint_-_Get_members_group_by_name_2\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"ddadcdcd-e916-477a-8e4e-94fbc6b03416\"},\"type\":\"Compose\",\"inputs\":\"@body('NEW_Send_an_HTTP_request_to_SharePoint_-_Get_members_group_by_name_2')?['d/results'][0]?['Id']\"},\"Send_an_HTTP_request_to_SharePoint_-_Grant_permission_to_members_group_2\":{\"runAfter\":{\"NEW_Compose_-_Get_members_group_ID_2\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"18a4abd3-d6a9-495b-80fe-9d36e817fe9e\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"HttpRequest\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"@parameters('GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)')\",\"parameters/method\":\"POST\",\"parameters/uri\":\"_api/web/lists/GetById('@{parameters('Read Tasks (spo_shared_sharepointonline_0df7196447074054aaa21c20eda85e60)')}')/items(@{triggerOutputs()?['body/ID']})/roleassignments/addroleassignment(principalid='@{outputs('NEW_Compose_-_Get_members_group_ID_2')}', roleDefId=@{outputs('NEW_Compose_-_Members_role_ID_2')} )\"},\"authentication\":\"@parameters('$authentication')\"}},\"Update_item\":{\"runAfter\":{\"Apply_to_each\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"43bda177-d4ad-4298-931e-c95ad2932ccb\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"dataset\":\"@parameters('GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)')\",\"table\":\"@parameters('Read Tasks (spo_shared_sharepointonline_0df7196447074054aaa21c20eda85e60)')\",\"id\":\"@triggerOutputs()?['body/ID']\",\"item/IncompleteBy\":\"@variables('ConcatEmails')\",\"item/Visible\":\"Yes\"},\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"PatchItem\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"authentication\":\"@parameters('$authentication')\"}},\"Initialize_variable_-_ConcatEmails\":{\"runAfter\":{\"Send_an_HTTP_request_to_SharePoint_-_Get_roles\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"52f0c04c-b026-46f8-a349-8c8ba3f55cce\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"ConcatEmails\",\"type\":\"string\"}]}},\"Apply_to_each\":{\"foreach\":\"@body('Send_an_HTTP_request_to_SharePoint_-_Get_members_group')?['d']['results'][0]['Users']['results']\",\"actions\":{\"Compose\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"dbcf50ac-7739-48dd-ba36-958223d123ae\"},\"type\":\"Compose\",\"inputs\":\"@concat(variables('ConcatEmails'), item()?['Email'], ';')\"},\"Set_variable\":{\"runAfter\":{\"Compose\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"9a477857-4a77-4eec-af73-c697bd630e4e\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"ConcatEmails\",\"value\":\"@outputs('Compose')\"}}},\"runAfter\":{\"Send_an_HTTP_request_to_SharePoint_-_Get_members_group\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"15fa15c0-62dd-4044-b9ab-117ac69420c9\"},\"type\":\"Foreach\"},\"Send_an_HTTP_request_to_SharePoint_-_Get_members_group\":{\"runAfter\":{\"Send_an_HTTP_request_to_SharePoint_-_Grant_permission_to_members_group_2\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"8a7ad2ef-a865-42e7-881d-f40eee2a277b\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"HttpRequest\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"@parameters('GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)')\",\"parameters/method\":\"GET\",\"parameters/uri\":\"_api/web/sitegroups?$filter=LoginName eq '@{triggerOutputs()?['body/Audicence']}'&$expand=Users\"},\"authentication\":\"@parameters('$authentication')\"}}}},\"templateName\":\"\"},\"schemaVersion\":\"1.0.0.0\"}","createdBy":"dd756db8-7340-ef11-a316-7c1e520c07be","modifiedBy":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","ownerId":"dd756db8-7340-ef11-a316-7c1e520c07be","owningBusinessUnit":"ee0a9aec-b63d-e911-a81c-000d3a11eefe","owningUser":"dd756db8-7340-ef11-a316-7c1e520c07be"},{"name":"Notification Center Tasks","createdOn":"2024-08-22T16:52:54Z","modifiedOn":"2025-04-02T18:15:06Z","workflowId":"d248a1f5-a660-ef11-bfe3-00224821a984","resourceId":"2ab11c52-a87e-e187-71b2-5eed87e785b4","stateCode":"Published","statusCode":"Published","definition":"{\"properties\":{\"connectionReferences\":{\"shared_sharepointonline\":{\"api\":{\"name\":\"shared_sharepointonline\"},\"connection\":{\"connectionReferenceLogicalName\":\"spo_sharedsharepointonline_84b67\"},\"runtimeSource\":\"embedded\"},\"shared_office365_1\":{\"api\":{\"name\":\"shared_office365\"},\"connection\":{\"connectionReferenceLogicalName\":\"spo_sharedoffice365_bfdbb\"},\"runtimeSource\":\"embedded\"}},\"definition\":{\"$schema\":\"https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"$authentication\":{\"defaultValue\":{},\"type\":\"SecureObject\"},\"$connections\":{\"defaultValue\":{},\"type\":\"Object\"},\"Notification Log (spo_shared_sharepointonline_142358c2e18d4bba9cf3ad1c80c6de53)\":{\"defaultValue\":\"fd2e2688-f29d-4e31-ba0a-285fffb3fdb0\",\"type\":\"String\",\"metadata\":{\"schemaName\":\"spo_shared_sharepointonline_142358c2e18d4bba9cf3ad1c80c6de53\"}},\"GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)\":{\"defaultValue\":\"https://grote0.sharepoint.com/teams/GDMS\",\"type\":\"String\",\"metadata\":{\"schemaName\":\"spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036\"}},\"WorkflowRules (spo_shared_sharepointonline_689c010b9cf34a34af4ece9f0dc1d279)\":{\"defaultValue\":\"fd5674fa-cf0a-4e9f-a6a9-816a661fdf66\",\"type\":\"String\",\"metadata\":{\"schemaName\":\"spo_shared_sharepointonline_689c010b9cf34a34af4ece9f0dc1d279\"}},\"Workflows Tasks (spo_shared_sharepointonline_5e3d23cb05204d3db2d0ce33a3ac7f84)\":{\"defaultValue\":\"ea9dfca4-1dd7-4b46-a9c7-b2e083419c97\",\"type\":\"String\",\"metadata\":{\"schemaName\":\"spo_shared_sharepointonline_5e3d23cb05204d3db2d0ce33a3ac7f84\"}},\"Read Tasks (spo_shared_sharepointonline_0df7196447074054aaa21c20eda85e60)\":{\"defaultValue\":\"2b048f31-68ad-48d9-911d-02e04cda5e6e\",\"type\":\"String\",\"metadata\":{\"schemaName\":\"spo_shared_sharepointonline_0df7196447074054aaa21c20eda85e60\"}}},\"triggers\":{\"When_an_item_is_created\":{\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"dataset\":\"@parameters('GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)')\",\"table\":\"@parameters('Notification Log (spo_shared_sharepointonline_142358c2e18d4bba9cf3ad1c80c6de53)')\"},\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"operationId\":\"GetOnNewItems\",\"connectionName\":\"shared_sharepointonline\"}},\"recurrence\":{\"interval\":1,\"frequency\":\"Minute\"},\"splitOn\":\"@triggerOutputs()?['body/value']\",\"metadata\":{\"operationMetadataId\":\"6dbfe165-1886-4943-8f5c-37ae54c726a6\"}}},\"actions\":{\"Switch\":{\"type\":\"Switch\",\"expression\":\"@triggerBody()?['TypeTask']\",\"default\":{\"actions\":{}},\"cases\":{\"Case\":{\"actions\":{\"Compose\":{\"type\":\"Compose\",\"inputs\":\"<p>The following item requires your review:<br>\\n<br>\\n<a href=\\\"@{triggerOutputs()?['body/RelatedItem']}\\\">@{triggerOutputs()?['body/Title']} - @{triggerOutputs()?['body/TypeTask']}</a><br>\\n<br>\\n<b>ASSIGNED TO</b>&nbsp;@{variables('AssignTo')}<br>\\n<b>DESCRIPTION</b>&nbsp;@{triggerOutputs()?['body/DocumentTitle']}<br>\\n<b>RELATED ITEM</b>&nbsp;<a href=\\\"@{variables('fileExtension')}\\\">@{triggerOutputs()?['body/Title']}</a><br>\\n<br>\\nIf the document is an Excel workbook, add the correct document name and revision number in the footer.</p>\",\"metadata\":{\"operationMetadataId\":\"435e2bee-576f-4bb3-afee-23bfd1d95e34\"}},\"Send_an_email_(V2)\":{\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"emailMessage/To\":\"@variables('ToEmail')\",\"emailMessage/Subject\":\"Task Assigned - @{triggerOutputs()?['body/Title']} - @{triggerOutputs()?['body/TypeTask']}\",\"emailMessage/Body\":\"<p>@{outputs('Compose')}</p>\",\"emailMessage/Importance\":\"Normal\"},\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_office365\",\"operationId\":\"SendEmailV2\",\"connectionName\":\"shared_office365_1\"}},\"runAfter\":{\"Compose\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"c4a3be3d-6e05-4033-b058-0f1d9f0d7183\"}}},\"case\":\"Document pending completion\"},\"Case_2\":{\"actions\":{\"Compose_2\":{\"type\":\"Compose\",\"inputs\":\"<p>The following item requires your review:<br>\\n<br>\\n<a href=\\\"@{triggerOutputs()?['body/RelatedItem']}\\\">@{triggerOutputs()?['body/Title']} - @{triggerOutputs()?['body/TypeTask']}</a><br>\\n<br>\\n<b>ASSIGNED TO</b>&nbsp;@{variables('AssignTo')}<br>\\n<b>DUE DATE</b>&nbsp;@{triggerOutputs()?['body/DueDate']}<br>\\n<b>DESCRIPTION</b>&nbsp;@{triggerOutputs()?['body/DocumentTitle']}<br>\\n<b>RELATED ITEM</b>&nbsp;<a href=\\\"@{variables('fileExtension')}\\\">@{triggerOutputs()?['body/Title']}</a><br>\\n<br>\\n</p>\",\"metadata\":{\"operationMetadataId\":\"e15d08fc-a491-4057-a728-52b65c910440\"}},\"Send_an_email_(V2)_2\":{\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"emailMessage/To\":\"@variables('ToEmail')\",\"emailMessage/Subject\":\"Task Assigned - @{triggerOutputs()?['body/Title']} - @{triggerOutputs()?['body/TypeTask']}\",\"emailMessage/Body\":\"<p>@{outputs('Compose_2')}</p>\",\"emailMessage/Importance\":\"Normal\"},\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_office365\",\"operationId\":\"SendEmailV2\",\"connectionName\":\"shared_office365_1\"}},\"runAfter\":{\"Compose_2\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"02393a9f-cb1c-4e7f-a09b-b886b2d0d34d\"}}},\"case\":\"Please review the following document\"},\"Case 2\":{\"actions\":{\"Compose_1\":{\"type\":\"Compose\",\"inputs\":\"<p>The following item requires your review:<br>\\n<br>\\n<a href=\\\"@{triggerOutputs()?['body/RelatedItem']}\\\">@{triggerOutputs()?['body/Title']} - @{triggerOutputs()?['body/TypeTask']}</a><br>\\n<br>\\n<b>ASSIGNED TO</b>&nbsp;@{variables('AssignTo')}<br>\\n<b>DUE DATE</b>&nbsp;@{triggerOutputs()?['body/DueDate']}<br>\\n<b>DESCRIPTION</b>&nbsp;@{triggerOutputs()?['body/DocumentTitle']}<br>\\n<b>RELATED ITEM</b>&nbsp;<a href=\\\"@{variables('fileExtension')}\\\">@{triggerOutputs()?['body/Title']}</a><br>\\n<br>\\n</p>\",\"metadata\":{\"operationMetadataId\":\"efb72730-1787-44d9-b8b9-2b7dfb7e6d5f\"}},\"Send_an_email_(V2)_1\":{\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"emailMessage/To\":\"@variables('ToEmail')\",\"emailMessage/Subject\":\"Task Assigned - @{triggerOutputs()?['body/Title']} - @{triggerOutputs()?['body/TypeTask']}\",\"emailMessage/Body\":\"<p class=\\\"editor-paragraph\\\">@{outputs('Compose_1')}</p>\",\"emailMessage/Importance\":\"Normal\"},\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_office365\",\"operationId\":\"SendEmailV2\",\"connectionName\":\"shared_office365_1\"}},\"runAfter\":{\"Compose_1\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"b6f6fff4-778c-4d6a-a687-e44f2fa222db\"}}},\"case\":\"Please approve the following document\"},\"Case 3\":{\"actions\":{\"Compose_3\":{\"type\":\"Compose\",\"inputs\":\"<p>The following item requires your review:<br>\\n<br>\\n<a href=\\\"@{triggerOutputs()?['body/RelatedItem']}\\\">@{triggerOutputs()?['body/Title']} - @{triggerOutputs()?['body/TypeTask']}</a><br>\\n<br>\\n<b>ASSIGNED TO</b>&nbsp;@{variables('AssignTo')}<br>\\n<b>DESCRIPTION</b>&nbsp;@{triggerOutputs()?['body/DocumentTitle']}<br>\\n<b>RELATED ITEM</b>&nbsp;<a href=\\\"@{variables('fileExtension')}\\\">@{triggerOutputs()?['body/Title']}</a><br>\\n<br>\\nIf the document is an Excel workbook, add the correct document name and revision number in the footer.</p>\",\"metadata\":{\"operationMetadataId\":\"68bcb316-4cf9-4d9d-82db-b2331a7b2ba6\"}},\"Send_an_email_(V2)_3\":{\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"emailMessage/To\":\"@variables('ToEmail')\",\"emailMessage/Subject\":\"Task Assigned - @{triggerOutputs()?['body/Title']} - @{triggerOutputs()?['body/TypeTask']}\",\"emailMessage/Body\":\"<p class=\\\"editor-paragraph\\\">@{outputs('Compose_3')}</p>\",\"emailMessage/Importance\":\"Normal\"},\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_office365\",\"operationId\":\"SendEmailV2\",\"connectionName\":\"shared_office365_1\"}},\"runAfter\":{\"Compose_3\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"7557d898-d582-422f-8d4c-1540853606e9\"}}},\"case\":\"The document was rejected\"},\"Case 4\":{\"actions\":{\"Compose_4\":{\"type\":\"Compose\",\"inputs\":\"<p>Document approved and published.<br>\\n<br>\\n<a href=\\\"@{triggerOutputs()?['body/RelatedItem']}\\\">@{triggerOutputs()?['body/Title']} - @{triggerOutputs()?['body/TypeTask']}</a><br>\\n<br>\\n<b>APPROVED BY</b>&nbsp;@{variables('AssignTo')}<br>\\n<b>APPROVED DATE</b>&nbsp;@{triggerBody()?['ApprovedDate']}<br>\\n<b>DESCRIPTION</b>&nbsp;@{triggerOutputs()?['body/DocumentTitle']}<br>\\n<b>RELATED ITEM</b>&nbsp;<a href=\\\"@{variables('fileExtension')}\\\">@{triggerOutputs()?['body/Title']}</a><br>\\n<br>\\n</p>\",\"metadata\":{\"operationMetadataId\":\"4d08d2cf-98f8-4525-a7d8-9509b371eaa1\"}},\"Send_an_email_(V2)_4\":{\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"emailMessage/To\":\"@variables('ToEmail')\",\"emailMessage/Subject\":\"@{triggerOutputs()?['body/Title']} - @{triggerOutputs()?['body/TypeTask']}\",\"emailMessage/Body\":\"<p class=\\\"editor-paragraph\\\">@{outputs('Compose_4')}</p>\",\"emailMessage/Importance\":\"Normal\"},\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_office365\",\"operationId\":\"SendEmailV2\",\"connectionName\":\"shared_office365_1\"}},\"runAfter\":{\"Compose_4\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"500e7cd6-13a0-4b17-8450-93c7bf6e2df7\"}}},\"case\":\"The document was approved\"},\"Case_3\":{\"actions\":{\"Compose_6\":{\"type\":\"Compose\",\"inputs\":\"<p>\\n<span style=\\\"font-size: 16px\\\"><strong>Reading Task Assigned</strong></span><br>\\nTask Created on: @{formatDateTime(triggerOutputs()?['body/Created'], 'yyyy-MM-dd')}<br>\\nTask Deadline: @{triggerOutputs()?['body/DueDate']}<br>\\n<br>\\nA new reading task has been created and assigned to you. You are required to read the document \\\"@{outputs('Get_file_properties')?['body/{Name}']}\\\"  before the deadline of @{triggerOutputs()?['body/DueDate']}.<br>\\n<br>\\nTo complete the reading task please follow the instructions below.<br>\\n<br>\\n* <strong>Step 1:</strong> Select the following link to view and confirm your task: <a href=\\\"https://grote0.sharepoint.com/teams/GDMS?task=@{outputs('Get_file_properties')?['body/ID']}\\\">View Task</a>.<br>\\n* <strong>Step 2:</strong> Ensure that you read and fully understand the contents of the document and that you agree with the Terms and Conditions statement.<br>\\n* <strong>Step 3:</strong> Check the box and click the \\\"Confirm\\\" button.</p>\",\"metadata\":{\"operationMetadataId\":\"ba9a2b33-a1ca-4b13-9b95-d95b2feea655\"}},\"Send_an_email_(V2)_5\":{\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"emailMessage/To\":\"@variables('ToEmail')\",\"emailMessage/Subject\":\"@triggerOutputs()?['body/TypeTask']\",\"emailMessage/Body\":\"<p>@{outputs('Compose_6')}</p>\",\"emailMessage/Importance\":\"Normal\"},\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_office365\",\"operationId\":\"SendEmailV2\",\"connectionName\":\"shared_office365_1\"}},\"runAfter\":{\"Compose_6\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"f5d64813-d432-49dd-ba30-80f4fab70230\"}}},\"case\":\"A new Reading Task has been assigned to you\"},\"Case_4\":{\"actions\":{\"Compose_7\":{\"type\":\"Compose\",\"inputs\":\"<p>The following item requires your review:<br>\\n<br>\\n<a href=\\\"@{triggerOutputs()?['body/RelatedItem']}\\\">@{triggerOutputs()?['body/Title']} - @{triggerOutputs()?['body/TypeTask']}</a><br>\\n<br>\\n<b>ASSIGNED TO</b>&nbsp;@{variables('AssignTo')}<br>\\n<b>DESCRIPTION</b>&nbsp;@{triggerOutputs()?['body/DocumentTitle']}<br>\\n<b>RELATED ITEM</b>&nbsp;<a href=\\\"@{variables('fileExtension')}\\\">@{triggerOutputs()?['body/Title']}</a><br>\\n<br>\\nIf the document is an Excel workbook, add the correct document name and revision number in the footer.</p>\",\"metadata\":{\"operationMetadataId\":\"bd943973-84ec-4306-b5f3-7cb60bf52e8e\"}},\"Send_an_email_(V2)_6\":{\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"emailMessage/To\":\"@variables('ToEmail')\",\"emailMessage/Subject\":\"Task Assigned - @{triggerOutputs()?['body/Title']} - @{triggerOutputs()?['body/TypeTask']}\",\"emailMessage/Body\":\"<p class=\\\"editor-paragraph\\\">@{outputs('Compose_7')}</p>\",\"emailMessage/Importance\":\"Normal\"},\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_office365\",\"operationId\":\"SendEmailV2\",\"connectionName\":\"shared_office365_1\"}},\"runAfter\":{\"Compose_7\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"c4a3be3d-6e05-4033-b058-0f1d9f0d7183\"}}},\"case\":\"Confirm document obsolescence\"},\"Case_5\":{\"actions\":{\"Compose_8\":{\"type\":\"Compose\",\"inputs\":\"<p>The following item requires your approval:<br>\\n<br>\\n<a href=\\\"@{triggerOutputs()?['body/RelatedItem']}\\\">@{triggerOutputs()?['body/Title']} - @{triggerOutputs()?['body/TypeTask']}</a><br>\\n<br>\\n<b>ASSIGNED TO</b>&nbsp;@{variables('AssignTo')}<br>\\n<b>DUE DATE</b>&nbsp;@{triggerOutputs()?['body/DueDate']}<br>\\n<b>DESCRIPTION</b>&nbsp;@{triggerOutputs()?['body/DocumentTitle']}<br>\\n<b>RELATED ITEM</b>&nbsp;<a href=\\\"@{variables('fileExtension')}\\\">@{triggerOutputs()?['body/Title']}</a><br>\\n<br>\\n</p>\",\"metadata\":{\"operationMetadataId\":\"efb72730-1787-44d9-b8b9-2b7dfb7e6d5f\"}},\"Send_an_email_(V2)_7\":{\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"emailMessage/To\":\"@variables('ToEmail')\",\"emailMessage/Subject\":\"Task Assigned - @{triggerOutputs()?['body/Title']} - @{triggerOutputs()?['body/TypeTask']}\",\"emailMessage/Body\":\"<p class=\\\"editor-paragraph\\\">@{outputs('Compose_8')}</p>\",\"emailMessage/Importance\":\"Normal\"},\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_office365\",\"operationId\":\"SendEmailV2\",\"connectionName\":\"shared_office365_1\"}},\"runAfter\":{\"Compose_8\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"b6f6fff4-778c-4d6a-a687-e44f2fa222db\"}}},\"case\":\"Please approve the following obsolete document\"},\"Case_6\":{\"actions\":{\"Compose_9\":{\"type\":\"Compose\",\"inputs\":\"<p>Document approved and obsolete<br>\\n<br>\\n<b>APPROVED BY</b>&nbsp;@{variables('AssignTo')}<br>\\n<b>APPROVED DATE</b>&nbsp;@{triggerOutputs()?['body/ApprovedDate']}<br>\\n<b>DESCRIPTION</b>&nbsp;@{triggerOutputs()?['body/DocumentTitle']}<br>\\n<b>RELATED ITEM</b>&nbsp;<a href=\\\"https://grote0.sharepoint.com/teams/GDMS@{outputs('Move_file')?['body/Path']}\\\">@{triggerOutputs()?['body/Title']}</a><br>\\n<br>\\n</p>\",\"runAfter\":{\"Move_file\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"68bfa286-fb46-4641-b269-5d3ea7b4caf3\"}},\"Send_an_email_(V2)_8\":{\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"emailMessage/To\":\"@variables('ToEmail')\",\"emailMessage/Subject\":\"@triggerOutputs()?['body/TypeTask']\",\"emailMessage/Body\":\"<p class=\\\"editor-paragraph\\\">@{outputs('Compose_9')}</p>\",\"emailMessage/Importance\":\"Normal\"},\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_office365\",\"operationId\":\"SendEmailV2\",\"connectionName\":\"shared_office365_1\"}},\"runAfter\":{\"Compose_9\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"b6f6fff4-778c-4d6a-a687-e44f2fa222db\"}},\"Move_file\":{\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"dataset\":\"@parameters('GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)')\",\"parameters/sourceFileId\":\"@outputs('Get_file_properties')?['body/{Identifier}']\",\"parameters/destinationDataset\":\"@parameters('GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)')\",\"parameters/destinationFolderPath\":\"/Obsolete Documents\",\"parameters/nameConflictBehavior\":2},\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"operationId\":\"MoveFileAsync\",\"connectionName\":\"shared_sharepointonline\"}},\"runAfter\":{\"Update_file_properties\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"1f267bfc-ece1-4c6f-8ffb-c112d859012a\"}},\"Get_items\":{\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"dataset\":\"@parameters('GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)')\",\"table\":\"@parameters('WorkflowRules (spo_shared_sharepointonline_689c010b9cf34a34af4ece9f0dc1d279)')\",\"$filter\":\"GroteReviewers eq '@{last(outputs('Getitem')?['body/value'])?['RequiredAudiences']}' or Approver eq '@{last(outputs('Getitem')?['body/value'])?['RequiredAudiences']}' or Distribution eq '@{last(outputs('Getitem')?['body/value'])?['RequiredAudiences']}'\"},\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"operationId\":\"GetItems\",\"connectionName\":\"shared_sharepointonline\"}},\"runAfter\":{\"Send_an_email_(V2)_8\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"7ae4dc2b-86b5-4e60-92b7-edf4a1c79ae5\"}},\"Get_items_1\":{\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"dataset\":\"@parameters('GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)')\",\"table\":\"@parameters('Workflows Tasks (spo_shared_sharepointonline_5e3d23cb05204d3db2d0ce33a3ac7f84)')\",\"$filter\":\"IDFile eq '@{body('Get_file_properties')?['ID']}' and Status eq 'In Progress'\"},\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"operationId\":\"GetItems\",\"connectionName\":\"shared_sharepointonline\"}},\"metadata\":{\"operationMetadataId\":\"eb54c636-e516-469e-aae7-328237868b4d\"}},\"For_each\":{\"type\":\"Foreach\",\"foreach\":\"@outputs('Get_items_1')?['body/value']\",\"actions\":{\"Update_item\":{\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"dataset\":\"@parameters('GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)')\",\"table\":\"@parameters('Workflows Tasks (spo_shared_sharepointonline_5e3d23cb05204d3db2d0ce33a3ac7f84)')\",\"id\":\"@items('For_each')?['ID']\",\"item/Status\":\"Completed\"},\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"operationId\":\"PatchItem\",\"connectionName\":\"shared_sharepointonline\"}},\"metadata\":{\"operationMetadataId\":\"5a9545a5-dcab-4310-b0d6-46562f9d5d27\"}}},\"runAfter\":{\"Get_items_2\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"ab85c316-5eb3-4a7e-8bca-cf17883447e4\"}},\"Get_items_2\":{\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"dataset\":\"@parameters('GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)')\",\"table\":\"@parameters('Read Tasks (spo_shared_sharepointonline_0df7196447074054aaa21c20eda85e60)')\",\"$filter\":\"IDFile eq '@{body('Get_file_properties')?['ID']}' and Status eq 'Assigned'\"},\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"operationId\":\"GetItems\",\"connectionName\":\"shared_sharepointonline\"}},\"runAfter\":{\"Get_items_1\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"e0c05e56-f821-4715-81db-2c2f755a3dd7\"}},\"For_each_1\":{\"type\":\"Foreach\",\"foreach\":\"@outputs('Get_items_2')?['body/value']\",\"actions\":{\"Update_item-copy\":{\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"dataset\":\"@parameters('GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)')\",\"table\":\"@parameters('Read Tasks (spo_shared_sharepointonline_0df7196447074054aaa21c20eda85e60)')\",\"id\":\"@item()?['ID']\",\"item/Status\":\"Completed\"},\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"operationId\":\"PatchItem\",\"connectionName\":\"shared_sharepointonline\"}},\"metadata\":{\"operationMetadataId\":\"03ba5157-6461-4336-b063-6b66fb5a1240\"}}},\"runAfter\":{\"For_each\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"d3c692b5-dafa-48da-8d6e-012d24752170\"}},\"Create_item\":{\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"dataset\":\"@parameters('GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)')\",\"table\":\"@parameters('Notification Log (spo_shared_sharepointonline_142358c2e18d4bba9cf3ad1c80c6de53)')\",\"item/Title\":\"@triggerBody()?['Title']\",\"item/AssignedTo\":\"Distribution\",\"item/DocumentTitle\":\"@triggerOutputs()?['body/DocumentTitle']\",\"item/RelatedItem\":\"@triggerBody()?['RelatedItem']\",\"item/TypeTask\":\"Document obsoleted and moved to the Obsolete Documents folder\",\"item/GroupEmail\":\"@first(outputs('Get_items')?['body/value'])?['Distribution']?['DisplayName']\",\"item/IDDocument\":\"@outputs('Move_file')?['body/ItemId']\"},\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"operationId\":\"PostItem\",\"connectionName\":\"shared_sharepointonline\"}},\"runAfter\":{\"Get_items\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"a9ad8c27-f78a-4716-91c1-400f7dddf3e9\"}},\"Update_file_properties\":{\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"dataset\":\"@parameters('GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)')\",\"table\":\"8917edf1-7f2e-4305-a82e-537d4e05a44c\",\"id\":\"@body('Get_file_properties')?['ID']\",\"item/GroteDocumentShortDescription\":\"@body('Get_file_properties')?['GroteDocumentShortDescription']\",\"item/GroteDocumentDescription\":\"@body('Get_file_properties')?['GroteDocumentDescription']\",\"item/GroteDocumentRevision\":\"@body('Get_file_properties')?['GroteDocumentRevision']\",\"item/Obsolete_x0020_Date\":\"@utcNow()\"},\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"operationId\":\"PatchFileItem\",\"connectionName\":\"shared_sharepointonline\"}},\"runAfter\":{\"Update_item-copy_1\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"a4e7188b-06bc-4a68-a904-f5986620c041\"}},\"Update_item-copy_1\":{\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"dataset\":\"@parameters('GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)')\",\"table\":\"@parameters('Workflows Tasks (spo_shared_sharepointonline_5e3d23cb05204d3db2d0ce33a3ac7f84)')\",\"id\":\"@first(outputs('Getitem')?['body/value'])?['ID']\",\"item/InternalUpdate\":\"FromNotificationTasks6\"},\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"operationId\":\"PatchItem\",\"connectionName\":\"shared_sharepointonline\"}},\"runAfter\":{\"For_each_1\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"5a9545a5-dcab-4310-b0d6-46562f9d5d27\"}}},\"case\":\"Document approved and obsolete\"},\"Case_7\":{\"actions\":{\"Compose_10\":{\"type\":\"Compose\",\"inputs\":\"<p>@{triggerOutputs()?['body/Title']} - @{triggerOutputs()?['body/TypeTask']}</a><br>\\n<br>\\n<b>DESCRIPTION</b>&nbsp;@{triggerOutputs()?['body/DocumentTitle']}<br>\\n<b>RELATED ITEM</b>&nbsp;<a href=\\\"@{variables('fileExtension')}\\\">@{triggerOutputs()?['body/Title']}</a><br>\\n<br>\\nIf the document is an Excel workbook, add the correct document name and revision number in the footer.</p>\",\"runAfter\":{\"Update_file_properties_1\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"68bcb316-4cf9-4d9d-82db-b2331a7b2ba6\"}},\"Send_an_email_(V2)_9\":{\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"emailMessage/To\":\"@variables('ToEmail')\",\"emailMessage/Subject\":\"@triggerOutputs()?['body/TypeTask']\",\"emailMessage/Body\":\"<p class=\\\"editor-paragraph\\\">@{outputs('Compose_10')}</p>\",\"emailMessage/Importance\":\"Normal\"},\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_office365\",\"operationId\":\"SendEmailV2\",\"connectionName\":\"shared_office365_1\"}},\"runAfter\":{\"Compose_10\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"b6f6fff4-778c-4d6a-a687-e44f2fa222db\"}},\"Update_file_properties_1\":{\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"dataset\":\"@parameters('GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)')\",\"table\":\"8917edf1-7f2e-4305-a82e-537d4e05a44c\",\"id\":\"@body('Get_file_properties')?['ID']\",\"item/GroteDocumentShortDescription\":\"@body('Get_file_properties')?['GroteDocumentShortDescription']\",\"item/GroteDocumentDescription\":\"@body('Get_file_properties')?['GroteDocumentDescription']\",\"item/GroteDocumentRevision\":\"@body('Get_file_properties')?['GroteDocumentRevision']\",\"item/ObsoleteInProgress\":false},\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"operationId\":\"PatchFileItem\",\"connectionName\":\"shared_sharepointonline\"}},\"runAfter\":{\"Update_item_2\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"5a7f7860-a812-489b-b83f-5f5c34aae949\"}},\"Update_item_2\":{\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"dataset\":\"@parameters('GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)')\",\"table\":\"@parameters('Workflows Tasks (spo_shared_sharepointonline_5e3d23cb05204d3db2d0ce33a3ac7f84)')\",\"id\":\"@first(outputs('Getitem')?['body/value'])?['ID']\",\"item/InternalUpdate\":\"FromNotificationTasks7\"},\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"operationId\":\"PatchItem\",\"connectionName\":\"shared_sharepointonline\"}},\"metadata\":{\"operationMetadataId\":\"5a9545a5-dcab-4310-b0d6-46562f9d5d27\"}}},\"case\":\"The document obsolescence was rejected\"},\"Case_8\":{\"actions\":{\"Compose_11\":{\"type\":\"Compose\",\"inputs\":\"<p>@{triggerOutputs()?['body/Title']} - @{triggerOutputs()?['body/TypeTask']}</a><br>\\n<br>\\n<b>DESCRIPTION</b>&nbsp;@{triggerOutputs()?['body/DocumentTitle']}<br>\\n<b>RELATED ITEM</b>&nbsp;@{triggerOutputs()?['body/Title']}<br>\\n<br>\\nIf the document is an Excel workbook, add the correct document name and revision number in the footer.</p>\",\"metadata\":{\"operationMetadataId\":\"68bcb316-4cf9-4d9d-82db-b2331a7b2ba6\"}},\"Send_an_email_(V2)_10\":{\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"emailMessage/To\":\"@variables('ToEmail')\",\"emailMessage/Subject\":\"@triggerOutputs()?['body/TypeTask']\",\"emailMessage/Body\":\"<p class=\\\"editor-paragraph\\\">@{outputs('Compose_11')}</p>\",\"emailMessage/Importance\":\"Normal\"},\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_office365\",\"operationId\":\"SendEmailV2\",\"connectionName\":\"shared_office365_1\"}},\"runAfter\":{\"Compose_11\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"b6f6fff4-778c-4d6a-a687-e44f2fa222db\"}}},\"case\":\"Document obsoleted and moved to the Obsolete Documents folder\"}},\"runAfter\":{\"Getitem\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"e35879c9-a748-4316-9e7f-238559a6d239\"}},\"Initialize_variable_-_EmailArray\":{\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"EmailArray\",\"type\":\"array\"}]},\"runAfter\":{\"Initialize_variable_-_fileExtension\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"fe6ccd13-5885-4e68-8b00-353dcda62363\"}},\"Initialize_variable_-_ToEmail\":{\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"ToEmail\",\"type\":\"string\"}]},\"runAfter\":{\"Initialize_variable_-_EmailArray\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"7784fd01-ace0-4e07-8fc2-7845b03dbf9a\"}},\"Condition_2\":{\"type\":\"If\",\"expression\":{\"equals\":[\"@triggerOutputs()?['body/ToEmail']\",\"@null\"]},\"actions\":{\"Send_an_HTTP_request_to_SharePoint\":{\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"dataset\":\"@parameters('GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)')\",\"parameters/method\":\"GET\",\"parameters/uri\":\"_api/Web/SiteGroups/GetByName('@{triggerOutputs()?['body/GroupEmail']}')/users?$select=Email,Id\"},\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"operationId\":\"HttpRequest\",\"connectionName\":\"shared_sharepointonline\"}},\"metadata\":{\"operationMetadataId\":\"e2bebf5a-30a8-4c53-a6f9-1a8d021f0a0e\"}},\"Parse_JSON\":{\"type\":\"ParseJson\",\"inputs\":{\"content\":\"@body('Send_an_HTTP_request_to_SharePoint')\",\"schema\":{\"type\":\"object\",\"properties\":{\"d\":{\"type\":\"object\",\"properties\":{\"results\":{\"type\":\"array\",\"items\":{\"type\":\"object\",\"properties\":{\"__metadata\":{\"type\":\"object\",\"properties\":{\"id\":{\"type\":\"string\"},\"uri\":{\"type\":\"string\"},\"type\":{\"type\":\"string\"}}},\"Id\":{\"type\":\"integer\"},\"Email\":{\"type\":\"string\"}},\"required\":[\"__metadata\",\"Id\",\"Email\"]}}}}}}},\"runAfter\":{\"Send_an_HTTP_request_to_SharePoint\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"c54f7d71-8f28-4acb-bf13-483804a34996\"}},\"Apply_to_each\":{\"type\":\"Foreach\",\"foreach\":\"@body('Parse_JSON')?['d']?['results']\",\"actions\":{\"Append_to_array_variable\":{\"type\":\"AppendToArrayVariable\",\"inputs\":{\"name\":\"EmailArray\",\"value\":\"@items('Apply_to_each')?['Email']\"},\"metadata\":{\"operationMetadataId\":\"a240d0df-fb44-4d49-8b4e-d5dd9d94072a\"}}},\"runAfter\":{\"Parse_JSON\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"34fad556-7755-4ee6-9d32-a6d8bee9e5a7\"}},\"Compose_5\":{\"type\":\"Compose\",\"inputs\":\"@join(variables('EmailArray'),';')\",\"runAfter\":{\"Apply_to_each\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"e265ba05-50c1-4430-8b5d-b75f09160398\"}},\"Set_variable\":{\"type\":\"SetVariable\",\"inputs\":{\"name\":\"ToEmail\",\"value\":\"@{outputs('Compose_5')}\"},\"runAfter\":{\"Compose_5\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"87c3382c-c017-493b-903a-d756876321ec\"}}},\"else\":{\"actions\":{\"Set_variable_2\":{\"type\":\"SetVariable\",\"inputs\":{\"name\":\"ToEmail\",\"value\":\"@triggerOutputs()?['body/ToEmail']\"},\"metadata\":{\"operationMetadataId\":\"bf2378e6-6c8f-4c17-937c-c57f1376dd66\"}}}},\"runAfter\":{\"Condition\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"69a897b5-04e2-4c31-8b8b-e9702c936a1c\"}},\"Condition\":{\"type\":\"If\",\"expression\":{\"and\":[{\"equals\":[\"@triggerBody()?['TypeTask']\",\"Document obsoleted and moved to the Obsolete Documents folder\"]}]},\"actions\":{},\"else\":{\"actions\":{\"Get_file_properties\":{\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"dataset\":\"@parameters('GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)')\",\"table\":\"8917edf1-7f2e-4305-a82e-537d4e05a44c\",\"id\":\"@triggerOutputs()?['body/IDDocument']\"},\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"operationId\":\"GetFileItem\",\"connectionName\":\"shared_sharepointonline\"}},\"metadata\":{\"operationMetadataId\":\"2320b74b-84ae-4b92-9905-f234c88ac319\"}}}},\"runAfter\":{\"Initialize_variable_-_AssignTo\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"2301a6c4-1f12-4db6-866f-11d3afc47a06\"}},\"Initialize_variable_-_AssignTo\":{\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"AssignTo\",\"type\":\"string\",\"value\":\"@{if(empty(triggerOutputs()?['body/GroupEmail']), triggerOutputs()?['body/AssignedTo'], triggerOutputs()?['body/GroupEmail'])}\"}]},\"runAfter\":{\"Initialize_variable_-_ToEmail\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"d7367b48-bdc9-4c97-a1bd-4c49462832e7\"}},\"Initialize_variable_-_fileExtension\":{\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"fileExtension\",\"type\":\"string\"}]},\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"46abebf6-4200-49d9-8036-f37ff032dfda\"}},\"Getitem\":{\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"dataset\":\"@parameters('GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)')\",\"table\":\"@parameters('Workflows Tasks (spo_shared_sharepointonline_5e3d23cb05204d3db2d0ce33a3ac7f84)')\",\"$filter\":\"IDFile eq '@{triggerBody()?['IDDocument']}'\",\"$orderby\":\"Created asc\"},\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"operationId\":\"GetItems\",\"connectionName\":\"shared_sharepointonline\"}},\"runAfter\":{\"Condition-copy\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"e6f9ed01-f53e-4c5d-b958-1313e59a4d7f\"}},\"Condition-copy\":{\"type\":\"If\",\"expression\":{\"and\":[{\"equals\":[\"@triggerBody()?['TypeTask']\",\"Document obsoleted and moved to the Obsolete Documents folder\"]}]},\"actions\":{},\"else\":{\"actions\":{\"Set_variable_3\":{\"type\":\"SetVariable\",\"inputs\":{\"name\":\"fileExtension\",\"value\":\"@{if(equals(toLower(last(split(outputs('Get_file_properties')?['body/{FilenameWithExtension}'], '.'))), 'docx'), 'ms-word:ofe|u|', '')}@{first(split(outputs('Get_file_properties')?['body/{Link}'], outputs('Get_file_properties')?['body/{FilenameWithExtension}']))}@{outputs('Get_file_properties')?['body/{FilenameWithExtension}']}\"},\"metadata\":{\"operationMetadataId\":\"24d014cd-328e-4874-b9fe-c0e02fe0c96f\"}}}},\"runAfter\":{\"Condition_2\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"2301a6c4-1f12-4db6-866f-11d3afc47a06\"}}}}},\"schemaVersion\":\"1.0.0.0\"}","createdBy":"dd756db8-7340-ef11-a316-7c1e520c07be","modifiedBy":"dd756db8-7340-ef11-a316-7c1e520c07be","ownerId":"dd756db8-7340-ef11-a316-7c1e520c07be","owningBusinessUnit":"ee0a9aec-b63d-e911-a81c-000d3a11eefe","owningUser":"dd756db8-7340-ef11-a316-7c1e520c07be"},{"name":"Mark as obsolete","createdOn":"2024-07-12T17:31:03Z","modifiedOn":"2025-03-12T19:02:37Z","workflowId":"7aa5047f-7440-ef11-a316-7c1e520c07be","resourceId":"0298a1c7-857b-454d-07a4-7b889b37c5ce","stateCode":"Published","statusCode":"Published","definition":"{\"properties\":{\"connectionReferences\":{\"shared_sharepointonline\":{\"api\":{\"name\":\"shared_sharepointonline\"},\"connection\":{\"connectionReferenceLogicalName\":\"spo_sharedsharepointonline_84b67\"},\"runtimeSource\":\"invoker\"}},\"definition\":{\"$schema\":\"https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"$authentication\":{\"defaultValue\":{},\"type\":\"SecureObject\"},\"$connections\":{\"defaultValue\":{},\"type\":\"Object\"},\"GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)\":{\"defaultValue\":\"https://grote0.sharepoint.com/teams/GDMS\",\"type\":\"String\",\"metadata\":{\"schemaName\":\"spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036\"}},\"Documents (spo_shared_sharepointonline_580e8f207af54f6ab847aa2b8f567849)\":{\"defaultValue\":\"8917edf1-7f2e-4305-a82e-537d4e05a44c\",\"type\":\"String\",\"metadata\":{\"schemaName\":\"spo_shared_sharepointonline_580e8f207af54f6ab847aa2b8f567849\"}},\"Workflows Tasks (spo_shared_sharepointonline_5e3d23cb05204d3db2d0ce33a3ac7f84)\":{\"defaultValue\":\"ea9dfca4-1dd7-4b46-a9c7-b2e083419c97\",\"type\":\"String\",\"metadata\":{\"schemaName\":\"spo_shared_sharepointonline_5e3d23cb05204d3db2d0ce33a3ac7f84\"}},\"Notification Log (spo_shared_sharepointonline_142358c2e18d4bba9cf3ad1c80c6de53)\":{\"defaultValue\":\"fd2e2688-f29d-4e31-ba0a-285fffb3fdb0\",\"type\":\"String\",\"metadata\":{\"schemaName\":\"spo_shared_sharepointonline_142358c2e18d4bba9cf3ad1c80c6de53\"}}},\"triggers\":{\"manual\":{\"type\":\"Request\",\"kind\":\"ApiConnection\",\"inputs\":{\"operationId\":\"ForASelectedFileHybridTrigger\",\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/teams/GDMS\",\"table\":\"8917edf1-7f2e-4305-a82e-537d4e05a44c\"},\"schema\":{\"type\":\"object\",\"properties\":{\"rows\":{\"type\":\"array\",\"items\":{\"type\":\"object\",\"properties\":{\"entity\":{\"properties\":{\"ID\":{\"title\":\"ID\",\"type\":\"integer\",\"format\":\"int64\"}},\"type\":\"object\",\"required\":[]}}}}},\"required\":[\"rows\"]},\"host\":{\"connection\":{\"name\":\"@parameters('$connections')['shared_sharepointonline']['connectionId']\"}},\"headersSchema\":{\"x-ms-user-timestamp\":{\"title\":\"Timestamp\",\"type\":\"string\",\"x-ms-dynamically-added\":false},\"x-ms-user-name-encoded\":{\"title\":\"User name\",\"type\":\"string\",\"format\":\"byte\",\"x-ms-dynamically-added\":false},\"x-ms-user-email-encoded\":{\"title\":\"User email\",\"type\":\"string\",\"format\":\"byte\",\"x-ms-dynamically-added\":false}}},\"splitOn\":\"@triggerBody()['rows']\",\"metadata\":{\"operationMetadataId\":\"a598cc99-8db1-4775-a53e-80fab72be80d\"}}},\"actions\":{\"Condition\":{\"type\":\"If\",\"expression\":{\"and\":[{\"equals\":[\"@outputs('Get_file_properties')?['body/ObsoleteInProgress']\",\"Yes\"]}]},\"actions\":{},\"else\":{\"actions\":{\"Create_item_2\":{\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"dataset\":\"@parameters('GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)')\",\"table\":\"@parameters('Notification Log (spo_shared_sharepointonline_142358c2e18d4bba9cf3ad1c80c6de53)')\",\"item/Title\":\"@outputs('Get_file_properties')?['body/{Name}']\",\"item/AssignedTo\":\"@outputs('Create_item')?['body/ElaboratedBy']\",\"item/DocumentTitle\":\"@outputs('Create_item')?['body/ReasonforObsolescence']\",\"item/RelatedItem\":\"https://grote0.sharepoint.com/teams/GDMS?task=@{outputs('Create_item')?['body/ID']}\",\"item/TypeTask\":\"@outputs('Create_item')?['body/TypeTask']\",\"item/ToEmail\":\"@triggerOutputs()['headers']['x-ms-user-email-encoded']\",\"item/IDDocument\":\"@triggerBody()?['entity']?['ID']\"},\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"operationId\":\"PostItem\",\"connectionName\":\"shared_sharepointonline\"}},\"runAfter\":{\"Update_file_properties\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"56ee6950-7039-44f2-8d2c-69f39e1905e1\"}},\"Update_file_properties\":{\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"dataset\":\"@parameters('GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)')\",\"table\":\"@parameters('Documents (spo_shared_sharepointonline_580e8f207af54f6ab847aa2b8f567849)')\",\"id\":\"@outputs('Get_file_properties')?['body/ID']\",\"item/GroteDocumentShortDescription\":\"@outputs('Get_file_properties')?['body/GroteDocumentShortDescription']\",\"item/GroteDocumentDescription\":\"@outputs('Get_file_properties')?['body/GroteDocumentDescription']\",\"item/GroteDocumentRevision\":\"@outputs('Get_file_properties')?['body/GroteDocumentRevision']\",\"item/ObsoleteInProgress\":true},\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"operationId\":\"PatchFileItem\",\"connectionName\":\"shared_sharepointonline\"}},\"runAfter\":{\"Create_item\":[\"Succeeded\"]}},\"Create_item\":{\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"dataset\":\"@parameters('GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)')\",\"table\":\"@parameters('Workflows Tasks (spo_shared_sharepointonline_5e3d23cb05204d3db2d0ce33a3ac7f84)')\",\"item/Title\":\"@outputs('Get_file_properties')?['body/{Name}']\",\"item/ReasonforObsolescence\":\"Please enter the reason for obsoletion and mark the task as complete.\",\"item/ElaboratedBy\":\"@{replace(last(split(variables('FullName'),',')), ' ', '')} @{first(split(variables('FullName'),','))}\",\"item/ElaboratedDate\":\"@outputs('Get_file_properties')?['body/GroteElaboratedByDate']\",\"item/Status\":\"In Progress\",\"item/UserGroup\":\"Originator\",\"item/Predecessor\":\"@outputs('Get_file_properties')?['body/LastIDTask']\",\"item/IDFile\":\"@outputs('Get_file_properties')?['body/ID']\",\"item/TypeTask\":\"Confirm document obsolescence\",\"item/StartDateTasks\":\"@triggerOutputs()['headers']['x-ms-user-timestamp']\",\"item/Visible\":\"Yes\"},\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"operationId\":\"PostItem\",\"connectionName\":\"shared_sharepointonline\"}},\"runAfter\":{\"Condition_1\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"ebd78e58-923a-4baa-a2e3-ec0fd6f858d3\"}},\"Getitem\":{\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"dataset\":\"@parameters('GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)')\",\"table\":\"@parameters('Workflows Tasks (spo_shared_sharepointonline_5e3d23cb05204d3db2d0ce33a3ac7f84)')\",\"$filter\":\"IDFile eq '@{outputs('Get_file_properties')?['body/ID']}'\",\"$orderby\":\"Created asc\"},\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"operationId\":\"GetItems\",\"connectionName\":\"shared_sharepointonline\"}},\"metadata\":{\"operationMetadataId\":\"e6f9ed01-f53e-4c5d-b958-1313e59a4d7f\"}},\"Condition_1\":{\"type\":\"If\",\"expression\":{\"and\":[{\"greaterOrEquals\":[\"@length(outputs('Getitem')?['body/value'])\",1]}]},\"actions\":{\"Update_item\":{\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"dataset\":\"@parameters('GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)')\",\"table\":\"@parameters('Workflows Tasks (spo_shared_sharepointonline_5e3d23cb05204d3db2d0ce33a3ac7f84)')\",\"id\":\"@first(outputs('Getitem')?['body/value'])?['ID']\",\"item/InternalUpdate\":\"FromMarkasObsolete\"},\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"operationId\":\"PatchItem\",\"connectionName\":\"shared_sharepointonline\"}},\"metadata\":{\"operationMetadataId\":\"5a9545a5-dcab-4310-b0d6-46562f9d5d27\"}}},\"else\":{\"actions\":{}},\"runAfter\":{\"Getitem\":[\"Succeeded\"]}}}},\"runAfter\":{\"Get_file_properties\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"5a77dbe9-7588-4120-8fc6-587572d2f093\"}},\"Initialize_variable\":{\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"FullName\",\"type\":\"string\",\"value\":\"@base64ToString(triggerOutputs()?['headers']?['x-ms-user-name-encoded'])\"}]},\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"dbb4eed2-0a65-40b0-b208-c622d7934363\"}},\"Get_file_properties\":{\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"dataset\":\"@parameters('GDMS Site (spo_shared_sharepointonline_5f7dc7167840436b82e03e76d88ba036)')\",\"table\":\"@parameters('Documents (spo_shared_sharepointonline_580e8f207af54f6ab847aa2b8f567849)')\",\"id\":\"@triggerBody()?['entity']?['ID']\"},\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"operationId\":\"GetFileItem\",\"connectionName\":\"shared_sharepointonline\"}},\"runAfter\":{\"Initialize_variable\":[\"Succeeded\"]}}}}},\"schemaVersion\":\"1.0.0.0\"}","createdBy":"dd756db8-7340-ef11-a316-7c1e520c07be","modifiedBy":"dd756db8-7340-ef11-a316-7c1e520c07be","ownerId":"dd756db8-7340-ef11-a316-7c1e520c07be","owningBusinessUnit":"ee0a9aec-b63d-e911-a81c-000d3a11eefe","owningUser":"dd756db8-7340-ef11-a316-7c1e520c07be"},{"name":"GDMS_CreateTemplate","createdOn":"2023-07-31T04:02:26Z","modifiedOn":"2023-12-12T20:17:54Z","workflowId":"6fee690b-572f-ee11-bdf3-000d3a1b983d","resourceId":"8a01c0a6-558c-42e6-b898-5c4c1d3974d6","stateCode":"Published","statusCode":"Published","definition":"{\"properties\":{\"connectionReferences\":{\"shared_sharepointonline_1\":{\"runtimeSource\":\"embedded\",\"connection\":{\"connectionReferenceLogicalName\":\"spo_sharedsharepointonline_e3ac5\"},\"api\":{\"name\":\"shared_sharepointonline\"}},\"shared_wordonlinebusiness\":{\"runtimeSource\":\"embedded\",\"connection\":{\"connectionReferenceLogicalName\":\"spo_sharedwordonlinebusiness_0a17b\"},\"api\":{\"name\":\"shared_wordonlinebusiness\"}},\"shared_office365-2\":{\"runtimeSource\":\"embedded\",\"connection\":{\"connectionReferenceLogicalName\":\"spo_sharedoffice365_5e3dc\"},\"api\":{\"name\":\"shared_office365\"}}},\"definition\":{\"$schema\":\"https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"$authentication\":{\"defaultValue\":{},\"type\":\"SecureObject\"},\"$connections\":{\"defaultValue\":{},\"type\":\"Object\"}},\"triggers\":{\"When_an_item_is_created_in_PendingCreateTemplate\":{\"recurrence\":{\"frequency\":\"Minute\",\"interval\":1},\"splitOn\":\"@triggerOutputs()?['body/value']\",\"metadata\":{\"operationMetadataId\":\"6afa0036-4f01-4aee-bcc9-f81812d18c61\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"b1e4ee91-f441-4ae4-909b-71bf46c12934\"},\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"operationId\":\"GetOnNewItems\",\"connectionName\":\"shared_sharepointonline_1\"}}}},\"actions\":{\"Create_GDMS_Document\":{\"runAfter\":{\"Populate_a_Microsoft_Word_template\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"266aad08-e0cd-4c6f-a253-ccbe122a36fa\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"folderPath\":\"/Shared Documents/@{variables('DivisionSelected')}/@{variables('ProcessSelected')}\",\"name\":\"@{variables('FileName')}.docx\",\"body\":\"@body('Populate_a_Microsoft_Word_template')\"},\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"operationId\":\"CreateFile\",\"connectionName\":\"shared_sharepointonline_1\"}},\"runtimeConfiguration\":{\"contentTransfer\":{\"transferMode\":\"Chunked\"}}},\"DivisionSelected\":{\"runAfter\":{\"FileName\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"fd7df295-b1c3-4410-855d-8f23e76c09da\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"DivisionSelected\",\"type\":\"string\",\"value\":\"@triggerOutputs()?['body/Title']\"}]}},\"ProcessSelected\":{\"runAfter\":{\"DivisionSelected\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"fbda1853-7958-4789-b31c-d278fb12b4da\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"ProcessSelected\",\"type\":\"string\",\"value\":\"@triggerOutputs()?['body/ProcessSelected']\"}]}},\"DocumentType\":{\"runAfter\":{\"ProcessSelected\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"24f94022-75ee-4fe5-a391-d1496f58d4d6\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"DocumentType\",\"type\":\"string\",\"value\":\"@triggerOutputs()?['body/DocumentType']\"}]}},\"DocNumber\":{\"runAfter\":{\"DocumentType\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"a5aec629-ec5c-4e3c-9b9e-81a7eaa0b279\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"DocNumber\",\"type\":\"string\",\"value\":\"@triggerOutputs()?['body/DocNumber']\"}]}},\"DocTitle\":{\"runAfter\":{\"DocNumber\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"a0f33ceb-d386-4931-a700-2ea6e2d85632\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"DocTitle\",\"type\":\"string\",\"value\":\"@triggerOutputs()?['body/DocTitle']\"}]}},\"Update_file_properties\":{\"runAfter\":{\"Create_GDMS_Document\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"5adc451d-c212-434d-baa9-c7685c708af2\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"bc460a20-664c-49e7-bfe7-2843495da717\",\"id\":\"@outputs('Create_GDMS_Document')?['body/ItemId']\",\"item/GroteDocumentDescription\":\"@variables('DocTitle')\",\"item/GroteDocumentShortDescription\":\"@variables('DocNumber')\",\"item/GroteDocumentRevision\":\"@variables('DocRevNumber')\",\"item/Title\":\"@variables('DocTitle')\",\"item/GroteDivision/Id\":\"@variables('Division Number')\",\"item/GroteProcess/Id\":\"@variables('Process Number')\",\"item/OriginatorName\":\"@variables('UserDisplayName')\",\"item/Comments\":\"Creation of Document\",\"item/OriginatorEmail\":\"@variables('UserEmail')\",\"item/GroteDocumentType/Id\":\"@variables('DocumentTypeID')\",\"item/ObsoleteInProgress\":false,\"item/Status\":\"New\",\"item/Upload_x0020_Type\":\"Template\"},\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"operationId\":\"PatchFileItem\",\"connectionName\":\"shared_sharepointonline_1\"}}},\"DocRevNumber\":{\"runAfter\":{\"DocTitle\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"a13c1004-6bc8-44c1-a41c-5634b1fb859b\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"DocRevNumber\",\"type\":\"string\",\"value\":\"@triggerOutputs()?['body/DocRevNumber']\"}]}},\"Division_Number\":{\"runAfter\":{\"DocRevNumber\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"38b1eb7c-ab8e-4fe4-9e5d-3d178b64e428\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"Division Number\",\"type\":\"string\",\"value\":\"@triggerOutputs()?['body/DivisionNumber']\"}]}},\"Process_Number\":{\"runAfter\":{\"Division_Number\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"f4ea16e7-4acb-44a6-8128-33444d204237\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"Process Number\",\"type\":\"string\",\"value\":\"@triggerOutputs()?['body/ProcessNumber']\"}]}},\"DocumentTypeID\":{\"runAfter\":{\"Process_Number\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"9e78947d-faf9-41df-8656-15c8850ff9ce\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"DocumentTypeID\",\"type\":\"string\",\"value\":\"@triggerOutputs()?['body/DocumentTypeID']\"}]}},\"ReasonChanged\":{\"runAfter\":{\"DocumentTypeID\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"7cf8fc21-7c28-47b7-9715-3902656ae2a5\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"ReasonChanged\",\"type\":\"string\",\"value\":\"@triggerOutputs()?['body/ReasonChanged']\"}]}},\"Create_DocNumber\":{\"runAfter\":{\"UserEmail\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"5ef64110-2f2e-4f5e-b302-dd9713cfbf8d\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"66953198-05c9-40f9-bdfa-e0744efc90cc\",\"item/Title\":\"@variables('Division')\",\"item/Process\":\"@variables('Process')\",\"item/DocNumber\":\"@variables('DocNumber')\"},\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"operationId\":\"PostItem\",\"connectionName\":\"shared_sharepointonline_1\"}}},\"Division\":{\"runAfter\":{\"ReasonChanged\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"9272f047-4448-4ea8-b1f9-d85876d6c41a\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"Division\",\"type\":\"string\",\"value\":\"@triggerOutputs()?['body/Division']\"}]}},\"Process\":{\"runAfter\":{\"Division\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"780475ae-fbc9-46d7-b9b4-9e1714b6df46\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"Process\",\"type\":\"string\",\"value\":\"@triggerOutputs()?['body/Process']\"}]}},\"Populate_a_Microsoft_Word_template\":{\"runAfter\":{\"UserEmail\":[\"Succeeded\"]},\"metadata\":{\"01UVQLYRJ4IAT5ZNRGBJFJT6BMMULF6D6J\":\"/GDMS Document Template.docx\",\"operationMetadataId\":\"e211e229-9d86-4f68-915e-9314ae023ba2\",\"01UVQLYRMY64LBLPML5FCIJQPPZA7EQJQO\":\"/GDMS Document Template.docx\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"source\":\"sites/grote0.sharepoint.com,f909bc20-b673-4273-a341-7163e496f030,6fb26e95-d03a-410b-ac27-1097249577b6\",\"drive\":\"b!ILwJ-XO2c0KjQXFj5JbwMJVusm860AtBrCcQlySVd7b9DiknAL--SbI1oA21FQ_1\",\"file\":\"01UVQLYRMY64LBLPML5FCIJQPPZA7EQJQO\",\"dynamicFileSchema/305048016\":\"@variables('FileName')\",\"dynamicFileSchema/1491367497\":\"@variables('DocTitle')\",\"dynamicFileSchema/1664349592\":\"@variables('DocRevNumber')\",\"dynamicFileSchema/-1055230121\":\"@variables('UserDisplayName')\"},\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_wordonlinebusiness\",\"operationId\":\"CreateFileItem\",\"connectionName\":\"shared_wordonlinebusiness\"}}},\"UserDisplayName\":{\"runAfter\":{\"Process\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"947b8f8c-a25f-41ec-9a55-44a49532ff26\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"UserDisplayName\",\"type\":\"string\",\"value\":\"@triggerOutputs()?['body/UserDisplayName']\"}]}},\"FileName\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"afb2a335-01d9-4721-b67a-aade98e72b6f\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"FileName\",\"type\":\"string\",\"value\":\"@triggerOutputs()?['body/FileName']\"}]}},\"UserEmail\":{\"runAfter\":{\"UserDisplayName\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"959c1f87-f3e5-4f39-b85b-b2d8b8ed5f6a\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"UserEmail\",\"type\":\"string\",\"value\":\"@triggerOutputs()?['body/UserEmail']\"}]}},\"Check_document_back_in\":{\"runAfter\":{\"Update_file_properties\":[\"Succeeded\"]},\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"parameters/method\":\"POST\",\"parameters/uri\":\"_api/web/GetFileByServerRelativeUrl('/sites/GDMS/@{body('Update_file_properties')?['{Path}']}@{body('Update_file_properties')?['{FilenameWithExtension}']}')/checkin(comment='Initial document creation',checkintype=0)\"},\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"operationId\":\"HttpRequest\",\"connectionName\":\"shared_sharepointonline_1\"}}},\"Delete_PendingCreateTemplate_item\":{\"runAfter\":{\"Check_document_back_in\":[\"Succeeded\"]},\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"b1e4ee91-f441-4ae4-909b-71bf46c12934\",\"id\":\"@triggerBody()?['ID']\"},\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"operationId\":\"DeleteItem\",\"connectionName\":\"shared_sharepointonline_1\"}}},\"Send_Origination_Email\":{\"runAfter\":{\"Delete_PendingCreateTemplate_item\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"00800f69-9cb1-4b62-a639-565576b51c47\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"emailMessage/To\":\"@variables('UserEmail')\",\"emailMessage/Subject\":\"GDMS | Document Creation Notification\",\"emailMessage/Body\":\"<p><i><em>Please do not reply, this is an automated message and responses to this email will not be monitored.</em></i></p><p>-----</p><p>Dear @{variables('UserDisplayName')},</p><p>This message confirms that your new document, \\\"@{body('Update_file_properties')?['Title']} | @{triggerBody()?['FileName']}\\\" has been created successfully.</p><p><b><strong>To start editing the document:</strong></b></p><p>1. Go to the GDMS app</p><p>2. Select <b><strong>Check In/Out Document</strong></b></p><p>3. Search for the document name (i.e; XX-XXX-XXX)</p><p>4. Select <b><strong>Check Out</strong></b></p><p>Upon completion of your document origination, please use the above steps again to check-in the document and submit it for approval.</p>\",\"emailMessage/Importance\":\"Normal\"},\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_office365\",\"operationId\":\"SendEmailV2\",\"connectionName\":\"shared_office365-2\"}}}}}},\"schemaVersion\":\"1.0.0.0\"}","createdBy":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","modifiedBy":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","ownerId":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","owningBusinessUnit":"ee0a9aec-b63d-e911-a81c-000d3a11eefe","owningUser":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff"},{"name":"GDMS_CheckInOut","createdOn":"2023-12-06T18:58:25Z","modifiedOn":"2023-12-12T19:59:34Z","workflowId":"57a3926e-6994-ee11-be37-000d3a1b983d","resourceId":"dac7991d-1a53-c2dc-64c0-fbfbd2e4cba1","stateCode":"Published","statusCode":"Published","definition":"{\"properties\":{\"connectionReferences\":{\"shared_sharepointonline\":{\"runtimeSource\":\"invoker\",\"connection\":{\"connectionReferenceLogicalName\":\"spo_sharedsharepointonline_e3ac5\"},\"api\":{\"name\":\"shared_sharepointonline\"}},\"shared_sharepointonline_1\":{\"runtimeSource\":\"invoker\",\"connection\":{\"connectionReferenceLogicalName\":\"spo_sharedsharepointonline_e3ac5\"},\"api\":{\"name\":\"shared_sharepointonline\"}}},\"definition\":{\"$schema\":\"https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"$connections\":{\"defaultValue\":{},\"type\":\"Object\"},\"$authentication\":{\"defaultValue\":{},\"type\":\"SecureObject\"}},\"triggers\":{\"manual\":{\"metadata\":{\"operationMetadataId\":\"7b0ee5bd-a83d-42ac-8bdc-3cf0d581c8cd\"},\"type\":\"Request\",\"kind\":\"PowerAppV2\",\"inputs\":{\"schema\":{\"type\":\"object\",\"properties\":{\"text\":{\"title\":\"id\",\"type\":\"string\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter your input\",\"x-ms-content-hint\":\"TEXT\"},\"text_1\":{\"title\":\"useremail\",\"type\":\"string\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter your input\",\"x-ms-content-hint\":\"TEXT\"},\"text_2\":{\"title\":\"docfilename\",\"type\":\"string\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter your input\",\"x-ms-content-hint\":\"TEXT\"},\"text_3\":{\"title\":\"check\",\"type\":\"string\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter your input\",\"x-ms-content-hint\":\"TEXT\"},\"text_4\":{\"title\":\"comment\",\"type\":\"string\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter your input\",\"x-ms-content-hint\":\"TEXT\"},\"text_5\":{\"title\":\"approvalinfoid\",\"type\":\"string\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter your input\",\"x-ms-content-hint\":\"TEXT\"},\"text_6\":{\"title\":\"userdisplayname\",\"type\":\"string\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter your input\",\"x-ms-content-hint\":\"TEXT\"}},\"required\":[\"text\",\"text_1\",\"text_2\",\"text_3\",\"text_4\",\"text_5\",\"text_6\"]}}}},\"actions\":{\"Get_file_properties\":{\"runAfter\":{\"Create_Result\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"8b374176-95ee-4d32-970a-f243990729cd\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"GetFileItem\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"bc460a20-664c-49e7-bfe7-2843495da717\",\"id\":\"@variables('ID')\"},\"authentication\":\"@parameters('$authentication')\"}},\"Create_ID\":{\"runAfter\":{\"Compose\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"1a8bd2f6-674c-49e3-a5f7-6fd1bb1b8813\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"ID\",\"type\":\"string\",\"value\":\"@triggerBody()['text']\"}]}},\"Get_Originator_List\":{\"runAfter\":{\"Get_file_properties\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"b3afacff-afeb-4ca2-96cb-6228cfc7c126\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"GetItems\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"8817a49e-b48d-4634-9918-1c7716a2d1e5\",\"$filter\":\"(Location eq '@{body('Get_file_properties')?['GroteDivision']?['Value']}') and (Process eq '@{body('Get_file_properties')?['GroteProcess']?['Value']}')\"},\"authentication\":\"@parameters('$authentication')\"}},\"Check_if_Originator\":{\"foreach\":\"@outputs('Get_Originator_List')?['body/value']\",\"actions\":{\"Get_Originator_Emails\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"2da96095-5d52-4c41-8e33-7e8a7227664e\"},\"type\":\"Select\",\"inputs\":{\"from\":\"@items('Check_if_Originator')?['Originators']\",\"select\":\"@toLower(item()?['Email'])\"}},\"If_User_Can_Originate\":{\"actions\":{\"Result_Success\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"d9bfe980-297a-4305-b5fa-e0e7f7201ba5\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"Result\",\"value\":\"success\"}},\"CheckInOut_Document\":{\"runAfter\":{\"Result_Success\":[\"Succeeded\"]},\"cases\":{\"CheckIn\":{\"case\":\"in\",\"actions\":{\"Condition\":{\"actions\":{\"Check_in_file\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"396a1ea3-6a2c-4a55-835c-2d1127d76bab\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline_1\",\"operationId\":\"CheckInFile\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"bc460a20-664c-49e7-bfe7-2843495da717\",\"id\":\"@outputs('Get_file_properties')?['body/ID']\",\"parameter/comment\":\"@triggerBody()['text_4']\",\"parameter/checkinType\":1},\"authentication\":\"@parameters('$authentication')\"}}},\"runAfter\":{},\"else\":{\"actions\":{\"Get_file_metadata\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"ee37286b-42f9-4258-ba12-f196eb490de9\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"GetFileMetadata\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"id\":\"@outputs('Get_file_properties')?['body/{Identifier}']\"},\"authentication\":\"@parameters('$authentication')\"}},\"Set_content_approval_status\":{\"runAfter\":{\"Get_file_metadata\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"b9660d03-34b3-4b73-a36e-57d0b08f9a63\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"SetApprovalStatus\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"bc460a20-664c-49e7-bfe7-2843495da717\",\"id\":\"@outputs('Get_file_properties')?['body/ID']\",\"approvalAction\":\"Submit\",\"comments\":\"@triggerBody()['text_4']\",\"entityTag\":\"@outputs('Get_file_metadata')?['body/ETag']\"},\"authentication\":\"@parameters('$authentication')\"}}}},\"expression\":{\"equals\":[\"@outputs('Get_file_properties')?['body/{IsCheckedOut}']\",true]},\"metadata\":{\"operationMetadataId\":\"9271db99-969c-468e-8c3b-90cd3b7ca1b7\"},\"type\":\"If\"},\"Update_ApprovalInfo_(R)\":{\"runAfter\":{\"Condition\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"acbe4b99-d09f-4127-a733-5fac33daa173\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"PatchItem\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"3f960b78-8bab-42f1-a5d4-fa18072ad762\",\"id\":\"@outputs('Compose')\",\"item/Stage\":\"Review\"},\"authentication\":\"@parameters('$authentication')\"}}}},\"CheckOut\":{\"case\":\"out\",\"actions\":{\"Check_out_file\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"c4dabc5b-bc46-44f4-8af8-3f204b9f3bef\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline_1\",\"operationId\":\"CheckOutFile\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"bc460a20-664c-49e7-bfe7-2843495da717\",\"id\":\"@outputs('Get_file_properties')?['body/ID']\"},\"authentication\":\"@parameters('$authentication')\"}}}}},\"default\":{\"actions\":{}},\"expression\":\"@triggerBody()['text_3']\",\"metadata\":{\"operationMetadataId\":\"e7c2f6c9-9913-47e6-840d-01e17866b5e4\"},\"type\":\"Switch\"}},\"runAfter\":{\"Get_Originator_Emails\":[\"Succeeded\"]},\"else\":{\"actions\":{\"Result_Denied\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"e649a4de-7f68-4b92-954a-97c0c2cb4a9b\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"Result\",\"value\":\"denied\"}}}},\"expression\":{\"and\":[{\"contains\":[\"@body('Get_Originator_Emails')\",\"@toLower(triggerBody()['text_1'])\"]}]},\"metadata\":{\"operationMetadataId\":\"f4c4e908-ccac-4837-860f-08cb97b757b9\"},\"type\":\"If\"}},\"runAfter\":{\"Get_Originator_List\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"923c91d6-644e-4cf4-b55e-82ab8e9b99c9\"},\"type\":\"Foreach\"},\"Create_Result\":{\"runAfter\":{\"Create_ID\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"5a5977fe-afd5-45d8-9ac4-8a6358a72d6e\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"Result\",\"type\":\"string\"}]}},\"Respond_to_PowerApp\":{\"runAfter\":{\"Check_if_Originator\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"30b28c45-3142-4f44-9030-a30a7ce0550b\"},\"type\":\"Response\",\"kind\":\"PowerApp\",\"inputs\":{\"statusCode\":200,\"body\":{\"result\":\"@variables('Result')\"},\"schema\":{\"type\":\"object\",\"properties\":{\"result\":{\"title\":\"result\",\"x-ms-dynamically-added\":true,\"type\":\"string\"}}}}},\"Compose\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"cc86382a-7f2b-4f9d-bed9-ffa2f796dae4\"},\"type\":\"Compose\",\"inputs\":\"@triggerBody()['text_5']\"}},\"outputs\":{}},\"templateName\":\"\"},\"schemaVersion\":\"1.0.0.0\"}","createdBy":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","modifiedBy":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","ownerId":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","owningBusinessUnit":"ee0a9aec-b63d-e911-a81c-000d3a11eefe","owningUser":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff"},{"name":"GDMS_Originator","createdOn":"2023-07-31T04:02:28Z","modifiedOn":"2023-12-12T19:13:27Z","workflowId":"82ef690b-572f-ee11-bdf3-000d3a1b983d","resourceId":"48480b29-9281-4514-96af-d3d6c8e424fc","stateCode":"Draft","statusCode":"Draft","definition":"{\"properties\":{\"connectionReferences\":{\"shared_sharepointonline_1\":{\"runtimeSource\":\"embedded\",\"connection\":{\"connectionReferenceLogicalName\":\"spo_sharedsharepointonline_e3ac5\"},\"api\":{\"name\":\"shared_sharepointonline\"}},\"shared_office365_1\":{\"runtimeSource\":\"embedded\",\"connection\":{\"connectionReferenceLogicalName\":\"spo_sharedoffice365_5e3dc\"},\"api\":{\"name\":\"shared_office365\"}}},\"definition\":{\"$schema\":\"https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"$authentication\":{\"defaultValue\":{},\"type\":\"SecureObject\"},\"$connections\":{\"defaultValue\":{},\"type\":\"Object\"}},\"triggers\":{\"When_item_created_or_modified_in_ApprovalInfo\":{\"recurrence\":{\"frequency\":\"Minute\",\"interval\":1},\"splitOn\":\"@triggerOutputs()?['body/value']\",\"metadata\":{\"operationMetadataId\":\"dc0fdc5f-6a0d-42d3-afa1-c80908a436c6\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"3f960b78-8bab-42f1-a5d4-fa18072ad762\"},\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"operationId\":\"GetOnUpdatedItems\",\"connectionName\":\"shared_sharepointonline_1\"}},\"conditions\":[{\"expression\":\"@or(equals(triggerBody()?['Stage'], 'Origination'),equals(triggerBody()?['Stage'], 'Revision'))\"}]}},\"actions\":{\"Create_varOriginatorEmail\":{\"runAfter\":{\"Create_OriginatorName\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"1f7e62e7-d8b3-4156-baf9-25aa3bc301b8\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"varOriginatorEmail\",\"type\":\"string\",\"value\":\"@triggerBody()?['Originator']\"}]}},\"If_Stage_Origination\":{\"actions\":{\"Send_Origination_Email\":{\"metadata\":{\"operationMetadataId\":\"00800f69-9cb1-4b62-a639-565576b51c47\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"emailMessage/To\":\"@variables('varOriginatorEmail')\",\"emailMessage/Subject\":\"GDMS | Document Creation Notification\",\"emailMessage/Body\":\"<p><i><em>Please do not reply, this is an automated message and responses to this email will not be monitored.</em></i></p><p>-----</p><p>Dear @{variables('OriginatorName')},<br></p><p>This message confirms that your new document, \\\"@{triggerBody()?['Title']} | @{triggerBody()?['Descripton']}\\\" has been created successfully.</p><br><p><b><strong>To start editing the document:</strong></b></p><p>1. Go to the GDMS app</p><p>2. Select <b><strong>Check In/Out Document</strong></b></p><p>3. Search for the document name (i.e; XX-XXX-XXX)</p><p>4. Select <b><strong>Check Out</strong></b><br></p><p>Upon completion of your document origination, please use the above steps again to check-in the document and submit it for approval.</p>\",\"emailMessage/Importance\":\"Normal\"},\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_office365\",\"operationId\":\"SendEmailV2\",\"connectionName\":\"shared_office365_1\"}}}},\"runAfter\":{\"Create_varOriginatorEmail\":[\"Succeeded\"]},\"else\":{\"actions\":{\"Send_Revision_Email\":{\"metadata\":{\"operationMetadataId\":\"141eb3eb-0605-4e44-9980-b53ce1ce9fd4\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"emailMessage/To\":\"@variables('varOriginatorEmail')\",\"emailMessage/Subject\":\"GDMS | Document Revision Notification\",\"emailMessage/Body\":\"<p><i><em>Please do not reply, this is an automated message and responses to this email will not be monitored.</em></i></p><p>-----</p><br><p>Dear<i><em> </em></i>@{variables('OriginatorName')}<i><em>,</em></i></p><br><p>This message confirms that the revision for your document, \\\"@{triggerBody()?['Title']} | @{triggerBody()?['Descripton']}\\\" has been created successfully and the document has been checked out to you for editing.</p><br><p>Upon completion of your document revision, please use the <b><strong>Check In/Out</strong></b> <b><strong>Document</strong></b> function within the GDMS application to submit the document for approval.</p>\",\"emailMessage/Importance\":\"Normal\"},\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_office365\",\"operationId\":\"SendEmailV2\",\"connectionName\":\"shared_office365_1\"}}}}},\"expression\":{\"and\":[{\"equals\":[\"@triggerBody()?['Stage']\",\"Origination\"]}]},\"metadata\":{\"operationMetadataId\":\"bb35e0f9-ff80-47c2-bb63-7b811e57cb73\"},\"type\":\"If\"},\"Create_OriginatorName\":{\"runAfter\":{},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"OriginatorName\",\"type\":\"string\",\"value\":\"@triggerBody()?['OriginatorName']\"}]}}},\"outputs\":{}}},\"schemaVersion\":\"1.0.0.0\"}","createdBy":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","modifiedBy":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","ownerId":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","owningBusinessUnit":"ee0a9aec-b63d-e911-a81c-000d3a11eefe","owningUser":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff"},{"name":"GDMS_RequestTemplate","createdOn":"2023-07-31T15:08:32Z","modifiedOn":"2023-12-12T15:43:38Z","workflowId":"0d4fbf1c-b42f-ee11-bdf3-000d3a1b983d","resourceId":"40edd913-cb9b-44db-8f1a-ae74773df292","stateCode":"Published","statusCode":"Published","definition":"{\"properties\":{\"connectionReferences\":{\"shared_sharepointonline_1\":{\"runtimeSource\":\"invoker\",\"connection\":{\"name\":\"shared-sharepointonl-947cca0b-9618-4af1-b27f-1d5711ca17b2\",\"connectionReferenceLogicalName\":\"spo_sharedsharepointonline_e3ac5\"},\"api\":{\"name\":\"shared_sharepointonline\"}}},\"definition\":{\"$schema\":\"https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"$connections\":{\"defaultValue\":{},\"type\":\"Object\"},\"$authentication\":{\"defaultValue\":{},\"type\":\"SecureObject\"}},\"triggers\":{\"manual\":{\"metadata\":{\"operationMetadataId\":\"d4009a84-5193-49ec-b765-f35106a16b48\"},\"type\":\"Request\",\"kind\":\"PowerAppV2\",\"inputs\":{\"schema\":{\"type\":\"object\",\"properties\":{\"text\":{\"title\":\"FileName\",\"type\":\"string\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter your input\",\"x-ms-content-hint\":\"TEXT\"},\"text_1\":{\"title\":\"DivisionSelected\",\"type\":\"string\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter your input\",\"x-ms-content-hint\":\"TEXT\"},\"text_2\":{\"title\":\"ProcessSelected\",\"type\":\"string\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter your input\",\"x-ms-content-hint\":\"TEXT\"},\"text_3\":{\"title\":\"DocumentType\",\"type\":\"string\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter your input\",\"x-ms-content-hint\":\"TEXT\"},\"text_4\":{\"title\":\"DocNumber\",\"type\":\"string\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter your input\",\"x-ms-content-hint\":\"TEXT\"},\"text_5\":{\"title\":\"DocTitle\",\"type\":\"string\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter your input\",\"x-ms-content-hint\":\"TEXT\"},\"text_6\":{\"title\":\"DocRevNumber\",\"type\":\"string\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter your input\",\"x-ms-content-hint\":\"TEXT\"},\"number\":{\"title\":\"DivisionNumber\",\"type\":\"number\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter a number\",\"x-ms-content-hint\":\"NUMBER\"},\"number_1\":{\"title\":\"ProcessNumber\",\"type\":\"number\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter a number\",\"x-ms-content-hint\":\"NUMBER\"},\"number_2\":{\"title\":\"DocumentTypeID\",\"type\":\"number\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter a number\",\"x-ms-content-hint\":\"NUMBER\"},\"text_7\":{\"title\":\"ReasonChanged\",\"type\":\"string\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter your input\",\"x-ms-content-hint\":\"TEXT\"},\"text_8\":{\"title\":\"Division\",\"type\":\"string\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter your input\",\"x-ms-content-hint\":\"TEXT\"},\"text_9\":{\"title\":\"Process\",\"type\":\"string\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter your input\",\"x-ms-content-hint\":\"TEXT\"},\"text_10\":{\"title\":\"UserDisplayName\",\"type\":\"string\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter your input\",\"x-ms-content-hint\":\"TEXT\"},\"text_11\":{\"title\":\"UserEmail\",\"type\":\"string\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter your input\",\"x-ms-content-hint\":\"TEXT\"}},\"required\":[\"text\",\"text_1\",\"text_2\",\"text_3\",\"text_4\",\"text_5\",\"text_6\",\"number\",\"number_1\",\"number_2\",\"text_7\",\"text_8\",\"text_9\",\"text_10\",\"text_11\"]}}}},\"actions\":{\"Create_item_in_PendingCreateTemplate\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"4a8b1a77-7e4f-4994-bf87-b4ec2b921623\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline_1\",\"operationId\":\"PostItem\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"b1e4ee91-f441-4ae4-909b-71bf46c12934\",\"item/Title\":\"@triggerBody()['text_1']\",\"item/ProcessSelected\":\"@triggerBody()['text_2']\",\"item/DocumentType\":\"@triggerBody()['text_3']\",\"item/DocNumber\":\"@triggerBody()['text_4']\",\"item/DocTitle\":\"@triggerBody()['text_5']\",\"item/DocRevNumber\":\"@triggerBody()['text_6']\",\"item/DivisionNumber\":\"@triggerBody()['number']\",\"item/ProcessNumber\":\"@triggerBody()['number_1']\",\"item/DocumentTypeID\":\"@triggerBody()['number_2']\",\"item/ReasonChanged\":\"@triggerBody()['text_7']\",\"item/Division\":\"@triggerBody()['text_8']\",\"item/Process\":\"@triggerBody()['text_9']\",\"item/UserDisplayName\":\"@triggerBody()['text_10']\",\"item/UserEmail\":\"@triggerBody()['text_11']\",\"item/FileName\":\"@triggerBody()['text']\"},\"authentication\":{\"value\":\"@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']\",\"type\":\"Raw\"}}}}}},\"schemaVersion\":\"1.0.0.0\"}","createdBy":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","modifiedBy":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","ownerId":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","owningBusinessUnit":"ee0a9aec-b63d-e911-a81c-000d3a11eefe","owningUser":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff"},{"name":"GDMS_Create_UsrChk","createdOn":"2023-07-31T16:54:35Z","modifiedOn":"2023-12-12T02:06:58Z","workflowId":"063c03ed-c22f-ee11-bdf3-000d3a1b983d","resourceId":"fd1f13ee-3d72-48fd-b8e4-54d500ba54cf","stateCode":"Published","statusCode":"Published","definition":"{\"properties\":{\"connectionReferences\":{\"shared_sharepointonline_1\":{\"runtimeSource\":\"invoker\",\"connection\":{\"connectionReferenceLogicalName\":\"spo_sharedsharepointonline_e3ac5\"},\"api\":{\"name\":\"shared_sharepointonline\"}}},\"definition\":{\"$schema\":\"https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"$connections\":{\"defaultValue\":{},\"type\":\"Object\"},\"$authentication\":{\"defaultValue\":{},\"type\":\"SecureObject\"}},\"triggers\":{\"manual\":{\"metadata\":{\"operationMetadataId\":\"3c978550-c7e2-422e-95d4-14ce4c47af07\"},\"type\":\"Request\",\"kind\":\"PowerAppV2\",\"inputs\":{\"schema\":{\"type\":\"object\",\"properties\":{\"text\":{\"title\":\"UserDisplayName\",\"type\":\"string\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter your input\",\"x-ms-content-hint\":\"TEXT\"},\"text_1\":{\"title\":\"Division\",\"type\":\"string\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter your input\",\"x-ms-content-hint\":\"TEXT\"},\"text_2\":{\"title\":\"Process\",\"type\":\"string\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter your input\",\"x-ms-content-hint\":\"TEXT\"}},\"required\":[\"text\",\"text_1\",\"text_2\"]}}}},\"actions\":{\"Create_ChkResult\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"132e028c-e41b-4511-bf0d-b019330d1cf6\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"ChkResult\",\"type\":\"string\"}]}},\"Get_items\":{\"runAfter\":{\"Create_ChkResult\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"7d5f4846-4e2d-4afa-8eb6-35cab887d5da\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline_1\",\"operationId\":\"GetItems\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"8817a49e-b48d-4634-9918-1c7716a2d1e5\",\"$filter\":\"(Location eq '@{triggerBody()['text_1']}') and (Process eq '@{triggerBody()['text_2']}')\"},\"authentication\":\"@parameters('$authentication')\"}},\"Apply_to_each\":{\"foreach\":\"@outputs('Get_items')?['body/value']\",\"actions\":{\"Select\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"2da96095-5d52-4c41-8e33-7e8a7227664e\"},\"type\":\"Select\",\"inputs\":{\"from\":\"@items('Apply_to_each')?['Originators']\",\"select\":\"@toLower(item()?['Email'])\"}},\"Condition\":{\"actions\":{\"Set_ChkResult_(Yes)\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"013c9070-9699-4bdd-ace7-05284a910040\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"ChkResult\",\"value\":\"yes\"}}},\"runAfter\":{\"Select\":[\"Succeeded\"]},\"else\":{\"actions\":{\"Set_ChkResult_(No)\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"711c8cd9-6847-47a3-a61b-28b47b605d1f\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"ChkResult\",\"value\":\"no\"}}}},\"expression\":{\"contains\":[\"@body('Select')\",\"@toLower(triggerBody()['text'])\"]},\"metadata\":{\"operationMetadataId\":\"ff40b1e3-3e12-4d36-83ec-905e53ac85da\"},\"type\":\"If\"}},\"runAfter\":{\"Get_items\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"b9a3190a-6a64-4a4f-b925-59fed92ea736\"},\"type\":\"Foreach\"},\"Respond_to_a_PowerApp_or_flow\":{\"runAfter\":{\"Apply_to_each\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"0168f830-8bd1-4923-ae81-3b767fc7c7b9\"},\"type\":\"Response\",\"kind\":\"PowerApp\",\"inputs\":{\"statusCode\":200,\"body\":{\"chkresult\":\"@variables('ChkResult')\"},\"schema\":{\"type\":\"object\",\"properties\":{\"chkresult\":{\"title\":\"ChkResult\",\"x-ms-dynamically-added\":true,\"type\":\"string\"}}}}}}},\"templateName\":\"\"},\"schemaVersion\":\"1.0.0.0\"}","createdBy":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","modifiedBy":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","ownerId":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","owningBusinessUnit":"ee0a9aec-b63d-e911-a81c-000d3a11eefe","owningUser":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff"},{"name":"GDMS_CheckInOutDoc_Lookup","createdOn":"2023-11-27T18:23:04Z","modifiedOn":"2023-12-11T14:31:48Z","workflowId":"5b816d00-528d-ee11-8179-000d3a1b983d","resourceId":"e03dab1e-04fc-6c7e-3739-6d3d1dcea9a4","stateCode":"Published","statusCode":"Published","definition":"{\"properties\":{\"connectionReferences\":{\"shared_sharepointonline\":{\"runtimeSource\":\"invoker\",\"connection\":{\"connectionReferenceLogicalName\":\"spo_sharedsharepointonline_e3ac5\"},\"api\":{\"name\":\"shared_sharepointonline\"}}},\"definition\":{\"$schema\":\"https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"$connections\":{\"defaultValue\":{},\"type\":\"Object\"},\"$authentication\":{\"defaultValue\":{},\"type\":\"SecureObject\"}},\"triggers\":{\"manual\":{\"metadata\":{\"operationMetadataId\":\"1fb55dac-b18f-4078-a4fb-c93e11eaa279\"},\"type\":\"Request\",\"kind\":\"PowerAppV2\",\"inputs\":{\"schema\":{\"type\":\"object\",\"properties\":{\"text\":{\"title\":\"DocName\",\"type\":\"string\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter your input\",\"x-ms-content-hint\":\"TEXT\"}},\"required\":[\"text\"]}}}},\"actions\":{\"Get_files_(properties_only)\":{\"runAfter\":{\"ApprovalInfoID\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"26f4bf51-4188-4c48-9e44-034589af542f\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"GetFileItems\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"bc460a20-664c-49e7-bfe7-2843495da717\",\"$filter\":\"substringof('@{triggerBody()['text']}',FileLeafRef)\",\"$top\":1},\"authentication\":\"@parameters('$authentication')\"}},\"If_File_Exists\":{\"actions\":{\"Set_variable\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"7d3c6b8a-e45d-47c2-b5b2-b7db9070cbda\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"Exist\",\"value\":\"Yes\"}},\"Get_ApprovalInfo\":{\"runAfter\":{\"Set_variable\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"1d1d0c16-c3ed-496b-a63a-cff705e05f58\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"GetItems\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"3f960b78-8bab-42f1-a5d4-fa18072ad762\",\"$filter\":\"Title eq '@{triggerBody()['text']}'\"},\"authentication\":\"@parameters('$authentication')\"}},\"Apply_to_each_2\":{\"foreach\":\"@outputs('Get_ApprovalInfo')?['body/value']\",\"actions\":{\"Set_ApprovalInfoID\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"2e08ab4b-e6df-4867-bcdc-f912ccde2030\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"ApprovalInfoID\",\"value\":\"@{string(items('Apply_to_each_2')?['ID'])}\"}}},\"runAfter\":{\"Get_ApprovalInfo\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"1f293d4e-298c-4d8f-9de0-7028f7eac637\"},\"type\":\"Foreach\"}},\"runAfter\":{\"Apply_to_each\":[\"Succeeded\"]},\"else\":{\"actions\":{\"Set_variable_2\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"bd29470e-ed1c-4632-a0cc-330a652d5942\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"Exist\",\"value\":\"No\"}}}},\"expression\":{\"greater\":[\"@length(string(outputs('Get_files_(properties_only)')?['body/value']))\",2]},\"metadata\":{\"operationMetadataId\":\"8f785f5f-80c1-4528-8d24-fa449fbca334\"},\"type\":\"If\"},\"Division\":{\"runAfter\":{\"Exist\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"bd635d5d-eae8-44f0-8d0b-a7af56d81375\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"Division\",\"type\":\"string\"}]}},\"Process\":{\"runAfter\":{\"Division\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"f25907a7-5fa3-4594-a7e9-71bad3480ed9\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"Process\",\"type\":\"string\"}]}},\"FileName\":{\"runAfter\":{\"Process\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"5a2a2bdd-36b8-427b-a60f-e3b46d7e42d5\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"FileName\",\"type\":\"string\"}]}},\"DocTitle\":{\"runAfter\":{\"FileName\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"b81948bd-b7b3-478d-9b98-510a1a7d8599\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"DocTitle\",\"type\":\"string\"}]}},\"Exist\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"ec1ffcc1-2745-43f6-8d42-94f8c75bdf0a\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"Exist\",\"type\":\"string\"}]}},\"Respond_to_a_PowerApp_or_flow\":{\"runAfter\":{\"If_File_Exists\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"bc2dab94-7640-4772-9e35-70a41ff79c77\"},\"type\":\"Response\",\"kind\":\"PowerApp\",\"inputs\":{\"statusCode\":200,\"body\":{\"exist\":\"@variables('Exist')\",\"doctitle\":\"@variables('DocTitle')\",\"filename\":\"@variables('FileName')\",\"division\":\"@variables('Division')\",\"process\":\"@variables('Process')\",\"status\":\"@variables('Status')\",\"originatorname\":\"@variables('OriginatorName')\",\"originatoremail\":\"@variables('OriginatorEmail')\",\"id\":\"@variables('ID')\",\"approvalinfoid\":\"@variables('ApprovalInfoID')\"},\"schema\":{\"type\":\"object\",\"properties\":{\"exist\":{\"title\":\"Exist\",\"x-ms-dynamically-added\":true,\"type\":\"string\"},\"doctitle\":{\"title\":\"DocTitle\",\"x-ms-dynamically-added\":true,\"type\":\"string\"},\"filename\":{\"title\":\"FileName\",\"x-ms-dynamically-added\":true,\"type\":\"string\"},\"division\":{\"title\":\"Division\",\"x-ms-dynamically-added\":true,\"type\":\"string\"},\"process\":{\"title\":\"Process\",\"x-ms-dynamically-added\":true,\"type\":\"string\"},\"status\":{\"title\":\"Status\",\"x-ms-dynamically-added\":true,\"type\":\"string\"},\"originatorname\":{\"title\":\"OriginatorName\",\"x-ms-dynamically-added\":true,\"type\":\"string\"},\"originatoremail\":{\"title\":\"OriginatorEmail\",\"x-ms-dynamically-added\":true,\"type\":\"string\"},\"id\":{\"title\":\"ID\",\"x-ms-dynamically-added\":true,\"type\":\"string\"},\"approvalinfoid\":{\"title\":\"approvalinfoid\",\"x-ms-dynamically-added\":true,\"type\":\"string\"}}}}},\"Apply_to_each\":{\"foreach\":\"@outputs('Get_files_(properties_only)')?['body/value']\",\"actions\":{\"Set_variable_3\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"9902e136-1028-4d5a-957b-eaa3efca334d\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"DocTitle\",\"value\":\"@items('Apply_to_each')?['GroteDocumentDescription']\"}},\"Set_variable_4\":{\"runAfter\":{\"Set_variable_3\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"13f33c13-cfa5-446f-958e-fbb51e25b721\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"FileName\",\"value\":\"@items('Apply_to_each')?['{Name}']\"}},\"Set_variable_5\":{\"runAfter\":{\"Set_variable_4\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"7b92fdbc-1465-4105-9471-95b31fee2f3c\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"Division\",\"value\":\"@items('Apply_to_each')?['GroteDivision/Value']\"}},\"Set_variable_6\":{\"runAfter\":{\"Set_variable_5\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"2085cd81-2f42-4607-8f90-8e51c447ad2f\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"Process\",\"value\":\"@items('Apply_to_each')?['GroteProcess/Value']\"}},\"Set_variable_7\":{\"runAfter\":{\"Set_variable_6\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"23e587cd-a8fb-405a-940b-1a233ade65ef\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"Status\",\"value\":\"@items('Apply_to_each')?['{ModerationStatus}']\"}},\"Set_variable_8\":{\"runAfter\":{\"Set_variable_7\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"acbabf3f-a548-46d8-a5a6-a4128513e892\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"OriginatorName\",\"value\":\"@items('Apply_to_each')?['OriginatorName']\"}},\"Set_variable_9\":{\"runAfter\":{\"Set_variable_8\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"baee25d3-b6c9-4f80-9031-402353efcba6\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"OriginatorEmail\",\"value\":\"@items('Apply_to_each')?['OriginatorEmail']\"}},\"Set_variable_10\":{\"runAfter\":{\"Set_variable_9\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"b52985c1-56bd-4f44-a39e-5827700c45a4\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"ID\",\"value\":\"@{items('Apply_to_each')?['ID']}\"}}},\"runAfter\":{\"Get_files_(properties_only)\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"2cd2397a-7216-471e-a07f-e1276330f255\"},\"type\":\"Foreach\",\"runtimeConfiguration\":{\"concurrency\":{\"repetitions\":1}}},\"Status\":{\"runAfter\":{\"DocTitle\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"64c4a620-de44-44f9-a226-39b556a2b62c\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"Status\",\"type\":\"string\"}]}},\"OriginatorName\":{\"runAfter\":{\"Status\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"e683f8a9-38b7-4a85-b98b-5b185416dc7e\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"OriginatorName\",\"type\":\"string\"}]}},\"OriginatorEmail\":{\"runAfter\":{\"OriginatorName\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"5a9f1b26-470d-4d8f-9cf1-18daa4124a0f\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"OriginatorEmail\",\"type\":\"string\"}]}},\"ID\":{\"runAfter\":{\"OriginatorEmail\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"855341db-27f5-44ae-ac90-968a5951f256\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"ID\",\"type\":\"string\"}]}},\"ApprovalInfoID\":{\"runAfter\":{\"ID\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"d838f221-2cc4-4d3a-baab-8a844267a347\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"ApprovalInfoID\",\"type\":\"string\"}]}}},\"outputs\":{}},\"templateName\":\"\"},\"schemaVersion\":\"1.0.0.0\"}","createdBy":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","modifiedBy":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","ownerId":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","owningBusinessUnit":"ee0a9aec-b63d-e911-a81c-000d3a11eefe","owningUser":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff"},{"name":"GDMS_Create_Approval","createdOn":"2023-07-31T04:02:29Z","modifiedOn":"2023-12-11T04:10:01Z","workflowId":"99f0690b-572f-ee11-bdf3-000d3a1b983d","resourceId":"bfaac62e-7adf-42a8-ad6b-539e7f439d62","stateCode":"Draft","statusCode":"Draft","definition":"{\"properties\":{\"connectionReferences\":{\"shared_sharepointonline\":{\"runtimeSource\":\"embedded\",\"connection\":{\"connectionReferenceLogicalName\":\"spo_sharedsharepointonline_e3ac5\"},\"api\":{\"name\":\"shared_sharepointonline\"}},\"shared_office365_1\":{\"runtimeSource\":\"embedded\",\"connection\":{\"connectionReferenceLogicalName\":\"spo_sharedoffice365_5e3dc\"},\"api\":{\"name\":\"shared_office365\"}},\"shared_approvals\":{\"runtimeSource\":\"embedded\",\"connection\":{\"connectionReferenceLogicalName\":\"spo_sharedapprovals_4eb02\"},\"api\":{\"name\":\"shared_approvals\"}}},\"definition\":{\"$schema\":\"https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"$connections\":{\"defaultValue\":{},\"type\":\"Object\"},\"$authentication\":{\"defaultValue\":{},\"type\":\"SecureObject\"}},\"triggers\":{\"When_a_file_is_created_(properties_only)\":{\"recurrence\":{\"interval\":1,\"frequency\":\"Minute\"},\"splitOn\":\"@triggerOutputs()?['body/value']\",\"metadata\":{\"operationMetadataId\":\"c5ee2ed4-f127-42b7-ae10-1cf999e5e054\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"GetOnNewFileItems\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"bc460a20-664c-49e7-bfe7-2843495da717\"},\"authentication\":\"@parameters('$authentication')\"}}},\"actions\":{\"Create_varOriginator_(Originator)\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"e8b9c745-1d7e-4803-b6a9-c72cee03499a\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"varOriginator\",\"type\":\"string\"}]}},\"Create_varOrigApp_(Origination_Approver)\":{\"runAfter\":{\"Create_varOriginator_(Originator)\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"d00f173e-fb55-41c4-b0c3-0174be94e874\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"varOrigApp\",\"type\":\"string\"}]}},\"Create_varApprovers_(Approvers)\":{\"runAfter\":{\"Create_varOrigApp_(Origination_Approver)\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"253e6c9a-94ec-4412-a470-fbc4bae5c000\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"varApprovers\",\"type\":\"string\"}]}},\"Create_varAppApp_(Approvers_Approver)\":{\"runAfter\":{\"Create_varApprovers_(Approvers)\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"89741cfa-f2d4-4538-86b8-abe7fa583730\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"varAppApp\",\"type\":\"string\"}]}},\"Create_varReviewers_(Reviewers)\":{\"runAfter\":{\"Create_varAppApp_(Approvers_Approver)\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"6cd1eb0a-8775-4177-b6a9-2ec74adc4f7c\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"varReviewers\",\"type\":\"string\"}]}},\"Create_varRevApp_(Reviewers_Approver)\":{\"runAfter\":{\"Create_varReviewers_(Reviewers)\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"726a16d0-7e8c-40cf-8565-075ed9a57d1e\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"varRevApp\",\"type\":\"string\"}]}},\"Get_file_properties\":{\"runAfter\":{\"Create_ApprovalID\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"4b38a5d0-b96f-4dad-b5eb-24c8aa13686b\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"GetFileItem\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"bc460a20-664c-49e7-bfe7-2843495da717\",\"id\":\"@triggerOutputs()?['body/ID']\"},\"authentication\":\"@parameters('$authentication')\"}},\"Update_file_properties\":{\"runAfter\":{\"Get_file_properties\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"be256fef-ce37-4e05-acff-154b8dc1973f\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"PatchFileItem\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"bc460a20-664c-49e7-bfe7-2843495da717\",\"id\":\"@triggerOutputs()?['body/ID']\",\"item/GroteDocumentDescription\":\"@triggerOutputs()?['body/GroteDocumentDescription']\",\"item/GroteDocumentShortDescription\":\"@triggerOutputs()?['body/GroteDocumentShortDescription']\",\"item/GroteDocumentRevision\":\"@triggerOutputs()?['body/GroteDocumentRevision']\",\"item/Comments\":\"Approval Started By @{triggerOutputs()?['body/Author/DisplayName']} (@{convertFromUtc(outputs('Get_file_properties')?['body/Modified'],'Eastern Standard Time','mm-dd-yyyy')})\",\"item/ObsoleteInProgress\":false},\"authentication\":\"@parameters('$authentication')\"}},\"Get_items\":{\"runAfter\":{\"Update_file_properties\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"18a06326-6929-4188-ab38-94465c1ad69f\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"GetItems\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"8817a49e-b48d-4634-9918-1c7716a2d1e5\",\"$filter\":\"(Location eq '@{triggerOutputs()?['body/GroteDivision/Value']}') and (Process eq '@{triggerOutputs()?['body/GroteProcess/Value']}')\"},\"authentication\":\"@parameters('$authentication')\"}},\"Get_file_metadata\":{\"runAfter\":{\"Get_items\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"93538256-2969-4f76-b72c-19a4ec1735e5\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"GetFileMetadata\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"id\":\"@triggerOutputs()?['body/{Identifier}']\"},\"authentication\":\"@parameters('$authentication')\"}},\"Set_varOriginator_to_file_creator\":{\"foreach\":\"@outputs('Get_items')?['body/value']\",\"actions\":{\"Set_varOriginator\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"b0010a51-70d4-4f2b-9979-81ef24d7bcce\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"varOriginator\",\"value\":\"@triggerOutputs()?['body/Author/Email']\"}}},\"runAfter\":{\"Set_as_Active_Approval\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"016da956-82cb-4462-b564-bd7ca9ff1d20\"},\"type\":\"Foreach\"},\"Outcome_of_Origination_Approval\":{\"actions\":{\"Set_varOrigApp_to_Origination_Approver\":{\"foreach\":\"@outputs('Wait_for_Origination_Approval')?['body/responses']\",\"actions\":{\"Set_varOrigApp\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"7cca6b74-e75e-4500-8b36-63ffc0242dd4\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"varOrigApp\",\"value\":\"@items('Set_varOrigApp_to_Origination_Approver')?['responder/displayName']\"}}},\"runAfter\":{\"Get-Create_Reviewers_list_for_document\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"58e4f491-1f8c-4836-963a-5c0aa3641396\"},\"type\":\"Foreach\"},\"Outcome_of_Reviewer_Approval\":{\"actions\":{\"Ser_varAppApp_to_Approval_Approver\":{\"foreach\":\"@outputs('Wait_for_Approver_Approval')?['body/responses']\",\"actions\":{\"Set_varAppApp\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"cf74de14-a767-474c-a159-f08aad7f89f9\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"varAppApp\",\"value\":\"@items('Ser_varAppApp_to_Approval_Approver')?['responder/displayName']\"}}},\"runAfter\":{\"Wait_for_Approver_Approval\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"0e61f556-2098-4006-8ae7-806f46d10e7f\"},\"type\":\"Foreach\"},\"Outcome_of_Approver_Approval\":{\"actions\":{\"Notify_Originator_3\":{\"runAfter\":{\"Set_content_approval_status\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"010954e2-ca05-4e57-93d4-d7c9424ff520\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_office365_1\",\"operationId\":\"SendEmailV2\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_office365\"},\"parameters\":{\"emailMessage/To\":\"@variables('varOriginator')\",\"emailMessage/Subject\":\"GDMS | Document Approved \",\"emailMessage/Body\":\"<p>Please do not reply, this is an automated message and responses to this email will not be monitored.<br>\\n<br>\\n<strong>STATUS</strong><br>\\n----------------<br>\\n<strong>Origination<br>\\n<br>\\nApproval<br>\\n<br>\\nReviewal</strong><br>\\n----------------<br>\\n<br>\\nYour originated document, @{triggerOutputs()?['body/{Name}']} (@{triggerOutputs()?['body/GroteDocumentDescription']}), has been approved. The document has been published and can be found at the attached link. @{triggerOutputs()?['body/{Link}']}</p>\",\"emailMessage/Importance\":\"Normal\"},\"authentication\":\"@parameters('$authentication')\"}},\"Delecte_Active_Approval_Approver_2\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"a001b966-d6ad-4c00-a0cc-8bca19164e65\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"DeleteItem\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"9139a2aa-626a-4e02-becc-60943ad79ccc\",\"id\":\"@variables('ActiveApprovalID')\"},\"authentication\":\"@parameters('$authentication')\"}},\"Set_content_approval_status\":{\"runAfter\":{\"Delecte_Active_Approval_Approver_2\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"de00c220-f23f-43df-a7ac-d40acab9c219\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"SetApprovalStatus\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"bc460a20-664c-49e7-bfe7-2843495da717\",\"id\":\"@triggerOutputs()?['body/ID']\",\"approvalAction\":\"Approve\",\"comments\":\"\",\"entityTag\":\"@outputs('Get_file_metadata')?['body/ETag']\"},\"authentication\":\"@parameters('$authentication')\"}}},\"runAfter\":{\"Ser_varAppApp_to_Approval_Approver\":[\"Succeeded\"]},\"else\":{\"actions\":{\"Approval_Reject_Email\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"c67e6f04-af4a-4b54-a40e-83cbc92aaf65\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_office365_1\",\"operationId\":\"SendEmailV2\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_office365\"},\"parameters\":{\"emailMessage/To\":\"@variables('varOriginator')\",\"emailMessage/Subject\":\"GDMS | Document Rejected\",\"emailMessage/Body\":\"<p><em>Please do not reply, this is an automated message and responses to this email will not be monitored.</em><br>\\n<br>\\nSTATUS<br>\\n----------------<br>\\n<strong>Origination</strong><br>\\n<br>\\n<strong>Reviewal</strong><br>\\n<br>\\n<strong>Approval</strong><br>\\n----------------<br>\\n<br>\\nYour originated document, @{triggerOutputs()?['body/{Name}']} (@{triggerOutputs()?['body/GroteDocumentDescription']}), has been rejected at the approval stage.<br>\\n</p>\",\"emailMessage/Importance\":\"Normal\"},\"authentication\":\"@parameters('$authentication')\"}},\"Delete_Doc_Number_3\":{\"foreach\":\"@outputs('Doc_Number_ID_on_List')?['body/value']\",\"actions\":{\"Delete_item_3\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"146f6ecd-1dfa-4d26-9f13-679c4bd5dc53\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"DeleteItem\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"66953198-05c9-40f9-bdfa-e0744efc90cc\",\"id\":\"@items('Delete_Doc_Number_3')?['ID']\"},\"authentication\":\"@parameters('$authentication')\"}}},\"runAfter\":{\"Approval_Reject_Email\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"4981787a-2ebb-4be3-bce5-1ba821404fc9\"},\"type\":\"Foreach\"},\"Delete_Active_Approval_Reviewer\":{\"runAfter\":{\"Delete_Doc_Number_3\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"1c74d6c9-1a16-4d2b-86c9-317244407b2b\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"DeleteItem\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"9139a2aa-626a-4e02-becc-60943ad79ccc\",\"id\":\"@variables('ActiveApprovalID')\"},\"authentication\":\"@parameters('$authentication')\"}},\"Delete_file_3\":{\"runAfter\":{\"Delete_Active_Approval_Reviewer\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"cfca141f-b733-4e3b-9ee0-60d6c094922b\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"DeleteFile\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"id\":\"@triggerOutputs()?['body/{Identifier}']\"},\"authentication\":\"@parameters('$authentication')\"}}}},\"expression\":{\"equals\":[\"@outputs('Wait_for_Approver_Approval')?['body/outcome']\",\"Approve\"]},\"metadata\":{\"operationMetadataId\":\"c90cdaeb-4aff-405d-9c7c-33cabb5d045e\"},\"type\":\"If\"},\"Update_Active_Approval_Approver\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"1caf4fe6-f5a1-4c9c-842f-d608a1e871e8\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"PatchItem\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"9139a2aa-626a-4e02-becc-60943ad79ccc\",\"id\":\"@variables('ActiveApprovalID')\",\"item/Title\":\"@triggerOutputs()?['body/{Name}']\",\"item/Status\":\"Awaiting Approver Approval\",\"item/Division\":\"@triggerOutputs()?['body/GroteDivision/Value']\",\"item/Process\":\"@triggerOutputs()?['body/GroteProcess/Value']\"},\"authentication\":\"@parameters('$authentication')\"}},\"Notify_Originator_2\":{\"runAfter\":{\"Update_Active_Approval_Approver\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"2c276476-b296-41f0-b683-0330b630bb1b\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_office365_1\",\"operationId\":\"SendEmailV2\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_office365\"},\"parameters\":{\"emailMessage/To\":\"@variables('varOriginator')\",\"emailMessage/Subject\":\"GDMS | Document Approval\",\"emailMessage/Body\":\"<p><em>Please do not reply, this is an automated message and responses to this email will not be monitored.</em><br>\\n<br>\\n<strong>STATUS</strong><br>\\n----------------<br>\\n<strong>Origination<br>\\n<br>\\nReviewal<br>\\n<br>\\n</strong><span style=\\\"color: rgb(0,0,0)\\\">Approval</span><br>\\n----------------<br>\\n<br>\\nYour originated document, @{triggerOutputs()?['body/{Name}']} (@{triggerOutputs()?['body/GroteDocumentDescription']}), has been reviewed and sent to the approval stage and is now awaiting approval from one of the process approvers.<br>\\n<br>\\nPlease note that this process may take some time, and you will be notified once the document furthers along in the process.</p>\",\"emailMessage/Importance\":\"Normal\"},\"authentication\":\"@parameters('$authentication')\"}},\"Get-Create_Approvers_list_for_document\":{\"foreach\":\"@outputs('Get_items')?['body/value']\",\"actions\":{\"Select\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"96d7c507-2b71-4ed1-a722-9650d8fdd2a5\"},\"type\":\"Select\",\"inputs\":{\"from\":\"@items('Get-Create_Approvers_list_for_document')?['Approvers']\",\"select\":\"@item()?['Email']\"}},\"Join\":{\"runAfter\":{\"Select\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"de9285b3-25eb-40ae-8302-4f28b6be8766\"},\"type\":\"Join\",\"inputs\":{\"from\":\"@body('Select')\",\"joinWith\":\";\"}},\"Set_varApprovers\":{\"runAfter\":{\"Join\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"19d23d1e-5243-468d-a8dc-d4db7ac55a8b\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"varApprovers\",\"value\":\"@body('Join')\"}}},\"runAfter\":{\"Notify_Originator_2\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"eb515a3b-c45d-4fea-b970-30ff81809668\"},\"type\":\"Foreach\"},\"Set_varRevApp_to_Reviewer_Approver\":{\"foreach\":\"@outputs('Wait_for_Reviewer_Approval')?['body/responses']\",\"actions\":{\"Set_varRevApp\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"6a21d4ba-0acd-4b36-a567-15cec2d96605\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"varRevApp\",\"value\":\"@items('Set_varRevApp_to_Reviewer_Approver')?['responder/displayName']\"}}},\"runAfter\":{\"Get-Create_Approvers_list_for_document\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"ab2845b1-88bd-42e2-b7b3-430ae5fcb4c3\"},\"type\":\"Foreach\"},\"Timeout_Retrigger_3\":{\"runAfter\":{\"Set_ApprovalID_2\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"940e151f-073d-4f6c-92cb-7cd854f14494\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"PostItem\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"4c86833c-1920-4dda-bdf8-c86549312eff\",\"item/FileName\":\"@triggerOutputs()?['body/{Name}']\",\"item/DocumentName\":\"@triggerOutputs()?['body/GroteDocumentDescription']\",\"item/StartedBy\":\"@variables('varOriginator')\",\"item/DocumentType\":\"@triggerOutputs()?['body/GroteDocumentType/Value']\",\"item/RetriggerType\":\"Create\",\"item/CurrentStageWaiting\":\"Approve\",\"item/Division\":\"@triggerOutputs()?['body/GroteDivision/Value']\",\"item/Process\":\"@triggerOutputs()?['body/GroteProcess/Value']\",\"item/DocumentNumber\":\"@triggerOutputs()?['body/GroteDocumentShortDescription']\",\"item/ItemID\":\"@triggerOutputs()?['body/ID']\",\"item/ActiveApprovalID\":\"@variables('ActiveApprovalID')\",\"item/ETag\":\"@outputs('Get_file_metadata')?['body/ETag']\"},\"authentication\":\"@parameters('$authentication')\"}},\"Notify_Approver\":{\"runAfter\":{\"Set_varRevApp_to_Reviewer_Approver\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"2f73786b-84c2-4004-9b91-281fb1f6ff85\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_office365_1\",\"operationId\":\"SendEmailV2\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_office365\"},\"parameters\":{\"emailMessage/To\":\"@variables('varApprovers')\",\"emailMessage/Subject\":\"GDMS | New Document to Approve\",\"emailMessage/Body\":\"<p><em>Please do not reply, this is an automated message and responses to this email will not be monitored.</em><br>\\n<br>\\nYou have a new document to approve. Please visit the <strong>Approvals </strong>tab via <strong>Teams </strong>to view the request.<br>\\n<br>\\n<strong>Document Name: </strong>@{triggerOutputs()?['body/{Name}']} <strong>|</strong> @{triggerOutputs()?['body/GroteDocumentDescription']}<br>\\n<strong>Originated By:</strong> @{triggerOutputs()?['body/Author/DisplayName']}<br>\\n<strong>Reviewed By:</strong> @{variables('varRevApp')}</p>\",\"emailMessage/Importance\":\"Normal\"},\"authentication\":\"@parameters('$authentication')\"}},\"Approver_Approval\":{\"runAfter\":{\"Notify_Approver\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"216a8fb2-99af-495b-b3ad-5d6ecef70e39\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_approvals\",\"operationId\":\"CreateAnApproval\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_approvals\"},\"parameters\":{\"approvalType\":\"Basic\",\"ApprovalCreationInput/title\":\"GDMS | Document Approval | @{triggerOutputs()?['body/GroteDocumentDescription']}\",\"ApprovalCreationInput/assignedTo\":\"@{variables('varApprovers')};\",\"ApprovalCreationInput/details\":\"**Grote Document Management System**\\n_You have a new document to approve._\\n\\n**Name:** @{triggerOutputs()?['body/{Name}']} | @{triggerOutputs()?['body/GroteDocumentDescription']}\\n**Document Type:** @{triggerOutputs()?['body/GroteDocumentType/Value']}\\n**Division:** @{triggerOutputs()?['body/GroteDivision/Value']}\\n**Process:**   @{triggerOutputs()?['body/GroteProcess/Value']}\\n\\n**Originated By:** @{triggerOutputs()?['body/Author/DisplayName']}\\n**Origination Approved By:** @{variables('varOrigApp')}\\n**Reviewed By:** @{variables('varAppApp')}\",\"ApprovalCreationInput/itemLink\":\"@triggerOutputs()?['body/{Link}']\",\"ApprovalCreationInput/itemLinkDescription\":\"View Document\",\"ApprovalCreationInput/requestor\":\"@{variables('varOriginator')};\",\"ApprovalCreationInput/enableNotifications\":false,\"ApprovalCreationInput/enableReassignment\":true},\"authentication\":\"@parameters('$authentication')\"}},\"Wait_for_Approver_Approval\":{\"runAfter\":{\"Approver_Approval\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"36884439-4fb8-4e06-9ce0-6220f8602346\"},\"type\":\"OpenApiConnectionWebhook\",\"inputs\":{\"host\":{\"connectionName\":\"shared_approvals\",\"operationId\":\"WaitForAnApproval\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_approvals\"},\"parameters\":{\"approvalName\":\"@outputs('Approver_Approval')?['body/name']\"},\"authentication\":\"@parameters('$authentication')\"}},\"Set_ApprovalID_2\":{\"runAfter\":{\"Wait_for_Approver_Approval\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"8acf78dc-323a-4f98-929f-9f0c17b80d48\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"ApprovalID\",\"value\":\"@outputs('Approver_Approval')?['body/name']\"}}},\"runAfter\":{\"Wait_for_Reviewer_Approval\":[\"Succeeded\"]},\"else\":{\"actions\":{\"Notify__Organizer_2_(Reject)\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"bb0b6e12-47a4-48c1-b051-49405ad8786e\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_office365_1\",\"operationId\":\"SendEmailV2\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_office365\"},\"parameters\":{\"emailMessage/To\":\"@variables('varOriginator')\",\"emailMessage/Subject\":\"GDMS | Document Rejected\",\"emailMessage/Body\":\"<p><em>Please do not reply, this is an automated message and responses to this email will not be monitored.</em><br>\\n<br>\\n<strong>STATUS</strong><br>\\n----------------<br>\\n<strong>Origination</strong><br>\\n<br>\\n<strong>Reviewal</strong><br>\\n<br>\\nApproval<br>\\n----------------<br>\\n<br>\\nYour originated document, @{triggerOutputs()?['body/{Name}']} (@{triggerOutputs()?['body/GroteDocumentDescription']}), has been rejected at the reviewal stage.<br>\\n</p>\",\"emailMessage/Importance\":\"Normal\"},\"authentication\":\"@parameters('$authentication')\"}},\"Delete_Doc_Number_2\":{\"foreach\":\"@outputs('Doc_Number_ID_on_List')?['body/value']\",\"actions\":{\"Delete_item_2\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"cd6cfcdf-47ac-414a-b32d-05fc5a563268\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"DeleteItem\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"66953198-05c9-40f9-bdfa-e0744efc90cc\",\"id\":\"@items('Delete_Doc_Number_2')?['ID']\"},\"authentication\":\"@parameters('$authentication')\"}}},\"runAfter\":{\"Notify__Organizer_2_(Reject)\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"2e2aab7f-3879-439f-8143-1062d23756e3\"},\"type\":\"Foreach\"},\"Delete_Active_Approval_Approver\":{\"runAfter\":{\"Delete_Doc_Number_2\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"7cc72852-2577-4ab7-9a75-d01f3b351026\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"DeleteItem\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"9139a2aa-626a-4e02-becc-60943ad79ccc\",\"id\":\"@variables('ActiveApprovalID')\"},\"authentication\":\"@parameters('$authentication')\"}},\"Delete_file_2\":{\"runAfter\":{\"Delete_Active_Approval_Approver\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"86caaeea-c683-4886-a274-e3a0298e9d5d\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"DeleteFile\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"id\":\"@triggerOutputs()?['body/{Identifier}']\"},\"authentication\":\"@parameters('$authentication')\"}}}},\"expression\":{\"equals\":[\"@outputs('Wait_for_Reviewer_Approval')?['body/outcome']\",\"Approve\"]},\"metadata\":{\"operationMetadataId\":\"0195044e-3043-469e-b989-e72af8f4687f\"},\"type\":\"If\"},\"Notify_Originator\":{\"runAfter\":{\"Update_Active_Approval_Reviewer\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"180b77a1-ebe4-4f33-8fc3-0ff2be69ddc4\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_office365_1\",\"operationId\":\"SendEmailV2\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_office365\"},\"parameters\":{\"emailMessage/To\":\"@variables('varOriginator')\",\"emailMessage/Subject\":\"GDMS | Document Origination Approved\",\"emailMessage/Body\":\"<p><em>Please do not reply, this is an automated message and responses to this email will not be monitored.<br>\\n<br>\\n</em><strong>STATUS</strong><em><br>\\n----------------<br>\\n</em><strong>Origination<br>\\n<br>\\n</strong>Reviewal<br>\\n<br>\\n<span style=\\\"color: rgb(71,85,119)\\\"><em>Approval</em></span><em><br>\\n----------------<br>\\n<br>\\n</em>Your originated document, @{triggerOutputs()?['body/{Name}']} (@{triggerOutputs()?['body/GroteDocumentDescription']}), has been sent to the review stage and is now awaiting reviewal from one of the process reviewers.<br>\\n<br>\\nPlease note that this process may take some time, and you will be notified once the document furthers along in the process.</p>\",\"emailMessage/Importance\":\"Normal\"},\"authentication\":\"@parameters('$authentication')\"}},\"Update_Active_Approval_Reviewer\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"f79987c5-8834-4e35-8f77-839eb85a4d4c\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"PatchItem\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"9139a2aa-626a-4e02-becc-60943ad79ccc\",\"id\":\"@variables('ActiveApprovalID')\",\"item/Title\":\"@triggerOutputs()?['body/{Name}']\",\"item/Status\":\"Awaiting Approval Reviewer\",\"item/Division\":\"@triggerOutputs()?['body/GroteDivision/Value']\",\"item/Process\":\"@triggerOutputs()?['body/GroteProcess/Value']\"},\"authentication\":\"@parameters('$authentication')\"}},\"Get-Create_Reviewers_list_for_document\":{\"foreach\":\"@outputs('Get_items')?['body/value']\",\"actions\":{\"Select_2\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"1fe0af15-331f-47e6-86e9-43b3ba1ad235\"},\"type\":\"Select\",\"inputs\":{\"from\":\"@items('Get-Create_Reviewers_list_for_document')?['Reviewers']\",\"select\":\"@item()['Email']\"}},\"Join_2\":{\"runAfter\":{\"Select_2\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"127a2f0d-6401-49a5-849a-32c974e89d8b\"},\"type\":\"Join\",\"inputs\":{\"from\":\"@body('Select_2')\",\"joinWith\":\";\"}},\"Set_varReviewers\":{\"runAfter\":{\"Join_2\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"bd4686bd-154a-4fe5-b419-cb59614ea5a2\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"varReviewers\",\"value\":\"@body('Join_2')\"}}},\"runAfter\":{\"Notify_Originator\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"00e12b3c-1aee-4f9f-9b2c-790fcc518986\"},\"type\":\"Foreach\"},\"Notify_Reviewer\":{\"runAfter\":{\"Set_varOrigApp_to_Origination_Approver\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"8c087b80-125b-4b60-98ff-b791f9d792af\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_office365_1\",\"operationId\":\"SendEmailV2\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_office365\"},\"parameters\":{\"emailMessage/To\":\"@variables('varReviewers')\",\"emailMessage/Subject\":\"GDMS | New Document to Review\",\"emailMessage/Body\":\"<p><em>Please do not reply, this is an automated message and responses to this email will not be monitored.<br>\\n<br>\\n</em>You have a new document to review. Please visit the <strong>Approvals </strong>tab via <strong>Teams </strong>to view the request.<br>\\n<strong><br>\\nDocument Name: </strong>@{triggerOutputs()?['body/{Name}']} <strong>|</strong> @{triggerOutputs()?['body/GroteDocumentDescription']}<strong><br>\\nOriginated By:</strong> @{triggerOutputs()?['body/Author/DisplayName']}</p>\",\"emailMessage/Importance\":\"Normal\"},\"authentication\":\"@parameters('$authentication')\"}},\"Timeout_Retrigger_2\":{\"runAfter\":{\"Set_ApprovalID_Reviewer\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"bc417b63-6568-48f3-8356-dda09bd20072\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"PostItem\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"4c86833c-1920-4dda-bdf8-c86549312eff\",\"item/FileName\":\"@triggerOutputs()?['body/{Name}']\",\"item/DocumentName\":\"@triggerOutputs()?['body/GroteDocumentDescription']\",\"item/StartedBy\":\"@variables('varOriginator')\",\"item/DocumentType\":\"@triggerOutputs()?['body/GroteDocumentType/Value']\",\"item/RetriggerType\":\"Create\",\"item/CurrentStageWaiting\":\"Review\",\"item/Division\":\"@triggerOutputs()?['body/GroteDivision/Value']\",\"item/Process\":\"@triggerOutputs()?['body/GroteProcess/Value']\",\"item/DocumentNumber\":\"@triggerOutputs()?['body/GroteDocumentShortDescription']\",\"item/ItemID\":\"@triggerOutputs()?['body/ID']\",\"item/DocNumberID\":\"@variables('DocNumID')\",\"item/ActiveApprovalID\":\"@variables('ActiveApprovalID')\",\"item/ETag\":\"@outputs('Get_file_metadata')?['body/ETag']\",\"item/ApprovalID\":\"@variables('ApprovalID')\"},\"authentication\":\"@parameters('$authentication')\"}},\"Reviewer_Approval\":{\"runAfter\":{\"Notify_Reviewer\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"7e838471-e868-442e-9a9d-8d9910db7db9\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_approvals\",\"operationId\":\"CreateAnApproval\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_approvals\"},\"parameters\":{\"approvalType\":\"Basic\",\"ApprovalCreationInput/title\":\"GDMS | Document Review | @{triggerOutputs()?['body/GroteDocumentDescription']}\",\"ApprovalCreationInput/assignedTo\":\"@{variables('varReviewers')};\",\"ApprovalCreationInput/details\":\"**Grote Document Management System**\\n_You have a new document to review._\\n\\n**Name:** @{triggerOutputs()?['body/{Name}']} | @{triggerOutputs()?['body/GroteDocumentDescription']}\\n**Document Type:** @{triggerOutputs()?['body/GroteDocumentType/Value']}\\n**Division:** @{triggerOutputs()?['body/GroteDivision/Value']}\\n**Process:**   @{triggerOutputs()?['body/GroteProcess/Value']}\\n\\n**Originated By:** @{triggerOutputs()?['body/Author/DisplayName']}\\n**Origination Approved By:** @{variables('varOrigApp')}\",\"ApprovalCreationInput/itemLink\":\"@triggerOutputs()?['body/{Link}']\",\"ApprovalCreationInput/itemLinkDescription\":\"View Document\",\"ApprovalCreationInput/requestor\":\"@{variables('varOriginator')};\",\"ApprovalCreationInput/enableNotifications\":false,\"ApprovalCreationInput/enableReassignment\":true},\"authentication\":\"@parameters('$authentication')\"}},\"Wait_for_Reviewer_Approval\":{\"runAfter\":{\"Reviewer_Approval\":[\"Succeeded\"]},\"limit\":{\"timeout\":\"P29D\"},\"metadata\":{\"operationMetadataId\":\"d51a596e-81c1-4ad6-918c-15d8878fdf46\"},\"type\":\"OpenApiConnectionWebhook\",\"inputs\":{\"host\":{\"connectionName\":\"shared_approvals\",\"operationId\":\"WaitForAnApproval\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_approvals\"},\"parameters\":{\"approvalName\":\"@outputs('Reviewer_Approval')?['body/name']\"},\"authentication\":\"@parameters('$authentication')\"}},\"Set_ApprovalID_Reviewer\":{\"runAfter\":{\"Wait_for_Reviewer_Approval\":[\"TimedOut\"]},\"metadata\":{\"operationMetadataId\":\"80748ffe-dfb4-4c15-aa0c-98d0e9e5bb57\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"ApprovalID\",\"value\":\"@outputs('Wait_for_Reviewer_Approval')?['body/name']\"}}},\"runAfter\":{\"Wait_for_Origination_Approval\":[\"Succeeded\"]},\"else\":{\"actions\":{\"Delete_Doc_Number\":{\"foreach\":\"@outputs('Doc_Number_ID_on_List')?['body/value']\",\"actions\":{\"Delete_item\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"6bbf0d24-37fa-4c3c-8d7c-87f9e73a2b04\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"DeleteItem\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"66953198-05c9-40f9-bdfa-e0744efc90cc\",\"id\":\"@items('Delete_Doc_Number')?['ID']\"},\"authentication\":\"@parameters('$authentication')\"}}},\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"152ccc71-0adb-4571-91c8-294dbe7b343c\"},\"type\":\"Foreach\"},\"Delete_Active_Approval_Originator\":{\"runAfter\":{\"Delete_Doc_Number\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"d5ff75d5-eaef-48ae-a40d-8ffeda8fe289\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"DeleteItem\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"9139a2aa-626a-4e02-becc-60943ad79ccc\",\"id\":\"@variables('ActiveApprovalID')\"},\"authentication\":\"@parameters('$authentication')\"}},\"Delete_file\":{\"runAfter\":{\"Delete_Active_Approval_Originator\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"a74f47b3-3c0f-46b9-88ff-95d83c16c5d1\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"DeleteFile\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"id\":\"@triggerOutputs()?['body/{Identifier}']\"},\"authentication\":\"@parameters('$authentication')\"}}}},\"expression\":{\"equals\":[\"@outputs('Wait_for_Origination_Approval')?['body/outcome']\",\"Approve\"]},\"metadata\":{\"operationMetadataId\":\"36ec1d9e-e1d6-40a6-be54-85880fc37bf1\"},\"type\":\"If\"},\"Doc_Number_ID_on_List\":{\"runAfter\":{\"Get_file_metadata\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"762d41a8-52a4-4592-bb2d-922bcfb1024d\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"GetItems\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"66953198-05c9-40f9-bdfa-e0744efc90cc\",\"$filter\":\"(Title eq '@{triggerOutputs()?['body/GroteDivision/Value']}') and (Process eq '@{triggerOutputs()?['body/GroteProcess/Value']}') and (DocNumber eq '@{triggerOutputs()?['body/GroteDocumentShortDescription']}')\"},\"authentication\":\"@parameters('$authentication')\"}},\"Set_as_Active_Approval\":{\"foreach\":\"@outputs('Doc_Number_ID_on_List')?['body/value']\",\"actions\":{\"Create_Active_Approval_Originator\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"3f3d20ba-5698-4cf1-b00d-e70762e45c85\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"PostItem\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"9139a2aa-626a-4e02-becc-60943ad79ccc\",\"item/Title\":\"@triggerOutputs()?['body/{Name}']\",\"item/Status\":\"Awaiting Originator Approval\",\"item/Division\":\"@triggerOutputs()?['body/GroteDivision/Value']\",\"item/Process\":\"@triggerOutputs()?['body/GroteProcess/Value']\"},\"authentication\":\"@parameters('$authentication')\"}},\"Set_ActiveApprovalID\":{\"runAfter\":{\"Create_Active_Approval_Originator\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"abfb9de2-7ae6-4485-884a-61d9fd34cfc8\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"ActiveApprovalID\",\"value\":\"@{outputs('Create_Active_Approval_Originator')?['body/ID']}\"}}},\"runAfter\":{\"Populate_DocNumID\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"efb6d851-9b33-4f69-8f8a-a8a3c64142c7\"},\"type\":\"Foreach\"},\"Create_ActiveApprovalID\":{\"runAfter\":{\"Create_varRevApp_(Reviewers_Approver)\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"a0b8081e-0d0f-4247-ac21-5e6203db2479\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"ActiveApprovalID\",\"type\":\"string\"}]}},\"Timeout_Retrigger\":{\"runAfter\":{\"Set_ApprovalID\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"8bd3606d-a0dd-4531-a10d-1c46c6331b37\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"PostItem\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"4c86833c-1920-4dda-bdf8-c86549312eff\",\"item/FileName\":\"@triggerOutputs()?['body/{Name}']\",\"item/DocumentName\":\"@triggerOutputs()?['body/GroteDocumentDescription']\",\"item/StartedBy\":\"@variables('varOriginator')\",\"item/DocumentType\":\"@triggerOutputs()?['body/GroteDocumentType/Value']\",\"item/RetriggerType\":\"Create\",\"item/CurrentStageWaiting\":\"Originate\",\"item/Division\":\"@triggerOutputs()?['body/GroteDivision/Value']\",\"item/Process\":\"@triggerOutputs()?['body/GroteProcess/Value']\",\"item/DocumentNumber\":\"@triggerOutputs()?['body/GroteDocumentShortDescription']\",\"item/ItemID\":\"@triggerOutputs()?['body/ID']\",\"item/DocNumberID\":\"@variables('DocNumID')\",\"item/ActiveApprovalID\":\"@variables('ActiveApprovalID')\",\"item/ETag\":\"@outputs('Get_file_metadata')?['body/ETag']\",\"item/ApprovalID\":\"@variables('ApprovalID')\"},\"authentication\":\"@parameters('$authentication')\"}},\"Populate_DocNumID\":{\"foreach\":\"@outputs('Doc_Number_ID_on_List')?['body/value']\",\"actions\":{\"Set_DocNumID\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"4560549c-4d0d-4c16-ad7e-e439426c948e\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"DocNumID\",\"value\":\"@{items('Populate_DocNumID')?['ID']}\"}}},\"runAfter\":{\"Doc_Number_ID_on_List\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"c8d5f794-4fde-4273-8b6c-e8dc50abb75c\"},\"type\":\"Foreach\"},\"Create_DocNumID\":{\"runAfter\":{\"Create_ActiveApprovalID\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"97a994fd-2681-42b7-8f22-299c26badde4\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"DocNumID\",\"type\":\"string\"}]}},\"Create_ApprovalID\":{\"runAfter\":{\"Create_DocNumID\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"068db59d-7c4a-4ec8-88c7-b456dfc2051b\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"ApprovalID\",\"type\":\"string\"}]}},\"Set_ApprovalID\":{\"runAfter\":{\"Wait_for_Origination_Approval\":[\"TimedOut\"]},\"metadata\":{\"operationMetadataId\":\"dc27ac64-a2a3-46fd-9f71-1e64972c102c\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"ApprovalID\",\"value\":\"@outputs('Origination_Approval')?['body/name']\"}},\"Origination_Approval\":{\"runAfter\":{\"Set_varOriginator_to_file_creator\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"da3b7236-6ee8-442a-b17a-0a44b6ac5d42\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_approvals\",\"operationId\":\"CreateAnApproval\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_approvals\"},\"parameters\":{\"approvalType\":\"BasicAwaitAll\",\"ApprovalCreationInput/title\":\"GDMS | Document Origination | @{triggerOutputs()?['body/GroteDocumentDescription']}\",\"ApprovalCreationInput/assignedTo\":\"@{variables('varOriginator')};\",\"ApprovalCreationInput/details\":\"**Grote Document Management System**\\n_You have a new originated document to approve._\\n\\n**Name:** @{triggerOutputs()?['body/{Name}']} | @{triggerOutputs()?['body/GroteDocumentDescription']}\\n**Originated By:** @{triggerOutputs()?['body/Author/DisplayName']}\\n**Document Type:** @{triggerOutputs()?['body/GroteDocumentType/Value']}\\n**Division:** @{triggerOutputs()?['body/GroteDivision/Value']}\\n**Process:**   @{triggerOutputs()?['body/GroteProcess/Value']}\",\"ApprovalCreationInput/itemLink\":\"@triggerOutputs()?['body/{Link}']\",\"ApprovalCreationInput/itemLinkDescription\":\"View Document\",\"ApprovalCreationInput/requestor\":\"@{variables('varOriginator')};\",\"ApprovalCreationInput/enableNotifications\":false,\"ApprovalCreationInput/enableReassignment\":true},\"authentication\":\"@parameters('$authentication')\"}},\"Wait_for_Origination_Approval\":{\"runAfter\":{\"Origination_Approval\":[\"Succeeded\"]},\"limit\":{\"timeout\":\"PT1M\"},\"metadata\":{\"operationMetadataId\":\"e845bb25-375e-4393-b687-6278016670f7\"},\"type\":\"OpenApiConnectionWebhook\",\"inputs\":{\"host\":{\"connectionName\":\"shared_approvals\",\"operationId\":\"WaitForAnApproval\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_approvals\"},\"parameters\":{\"approvalName\":\"@outputs('Origination_Approval')?['body/name']\"},\"authentication\":\"@parameters('$authentication')\"}}}},\"templateName\":\"\"},\"schemaVersion\":\"1.0.0.0\"}","createdBy":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","modifiedBy":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","ownerId":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","owningBusinessUnit":"ee0a9aec-b63d-e911-a81c-000d3a11eefe","owningUser":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff"},{"name":"GDMS_Approver","createdOn":"2023-07-31T04:02:29Z","modifiedOn":"2023-11-27T05:01:01Z","workflowId":"84f0690b-572f-ee11-bdf3-000d3a1b983d","resourceId":"45c5766f-a92f-4d92-89e9-fa16782296ef","stateCode":"Published","statusCode":"Published","definition":"{\"properties\":{\"connectionReferences\":{\"shared_approvals\":{\"runtimeSource\":\"embedded\",\"connection\":{\"name\":\"4108f82f6250453eb5ddddeb83641672\"},\"api\":{\"name\":\"shared_approvals\"}},\"shared_sharepointonline\":{\"runtimeSource\":\"embedded\",\"connection\":{\"name\":\"shared-sharepointonl-947cca0b-9618-4af1-b27f-1d5711ca17b2\"},\"api\":{\"name\":\"shared_sharepointonline\"}},\"shared_wordonlinebusiness\":{\"runtimeSource\":\"embedded\",\"connection\":{\"name\":\"shared-wordonlinebus-0de0bf99-6e0c-41e1-9c62-5159c5fd82af\"},\"api\":{\"name\":\"shared_wordonlinebusiness\"}},\"shared_office365_1\":{\"runtimeSource\":\"embedded\",\"connection\":{\"name\":\"shared-office365-5bd6a51a-7202-4b32-b2cb-5d99c414fe6e\"},\"api\":{\"name\":\"shared_office365\"}}},\"definition\":{\"$schema\":\"https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"$connections\":{\"defaultValue\":{},\"type\":\"Object\"},\"$authentication\":{\"defaultValue\":{},\"type\":\"SecureObject\"}},\"triggers\":{\"When_an_item_is_created_or_modified\":{\"recurrence\":{\"interval\":1,\"frequency\":\"Minute\"},\"splitOn\":\"@triggerOutputs()?['body/value']\",\"metadata\":{\"operationMetadataId\":\"af013535-e1c7-4fac-a546-34c0b2d4f05b\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"GetOnUpdatedItems\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"3f960b78-8bab-42f1-a5d4-fa18072ad762\"},\"authentication\":\"@parameters('$authentication')\"},\"conditions\":[{\"expression\":\"@equals(triggerBody()?['Stage'], 'Approval')\"}]}},\"actions\":{\"ApproverEmail\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"4d929604-b350-4ba2-ba19-37544cb2443d\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"ApproverEmail\",\"type\":\"string\",\"value\":\"@triggerBody()?['Approver']\"}]}},\"Wait_for_an_approval\":{\"runAfter\":{\"Condition_2\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"3f4d00b0-410c-4d21-b84a-4f629758029b\"},\"type\":\"OpenApiConnectionWebhook\",\"inputs\":{\"host\":{\"connectionName\":\"shared_approvals\",\"operationId\":\"WaitForAnApproval\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_approvals\"},\"parameters\":{\"approvalName\":\"@variables('ApprovalID')\"},\"authentication\":\"@parameters('$authentication')\"}},\"Outcome_of_Approver_Approval\":{\"actions\":{\"Condition_4\":{\"actions\":{\"Delete_ApprovalInfo\":{\"runAfter\":{\"Update_file_properties\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"602f4593-689f-4d03-ab5a-0e795e1f4166\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"DeleteItem\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"3f960b78-8bab-42f1-a5d4-fa18072ad762\",\"id\":\"@triggerOutputs()?['body/ID']\"},\"authentication\":\"@parameters('$authentication')\"}},\"Get_file_properties\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"14a1dc95-32c7-4450-9838-31866931b27b\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"GetFileItem\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"bc460a20-664c-49e7-bfe7-2843495da717\",\"id\":\"@variables('DocID')\"},\"authentication\":\"@parameters('$authentication')\"}},\"Get_file_content\":{\"runAfter\":{\"Get_file_properties\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"7a3e9a8c-ebc9-471a-a61f-333a044bc509\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"GetFileContent\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"id\":\"@outputs('Get_file_properties')?['body/{Identifier}']\",\"inferContentType\":true},\"authentication\":\"@parameters('$authentication')\"}},\"Create_file\":{\"runAfter\":{\"Get_file_content\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"2563dbb2-7559-46fe-a837-e401a090313d\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"CreateFile\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"folderPath\":\"/Obsolete Documents\",\"name\":\"@outputs('Get_file_properties')?['body/{FilenameWithExtension}']\",\"body\":\"@body('Get_file_content')\"},\"authentication\":\"@parameters('$authentication')\"},\"runtimeConfiguration\":{\"contentTransfer\":{\"transferMode\":\"Chunked\"}}},\"Update_file_properties\":{\"runAfter\":{\"Create_file\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"8d48e6f6-742c-4b61-835e-1244d2853e4f\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"PatchFileItem\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"70e663f2-0378-4f54-8ec7-e95fb8e3288d\",\"id\":\"@outputs('Create_file')?['body/ItemId']\",\"item/GroteDocumentShortDescription\":\"@outputs('Get_file_properties')?['body/GroteDocumentShortDescription']\",\"item/GroteDocumentDescription\":\"@outputs('Get_file_properties')?['body/OData__ExtendedDescription']\",\"item/GroteDivision/Id\":\"@outputs('Get_file_properties')?['body/GroteDivision/Value']\",\"item/GroteProcess/Id\":\"@outputs('Get_file_properties')?['body/GroteProcess/Value']\",\"item/GroteApprovedBy\":\"@variables('ApproverName')\",\"item/GroteDocumentRevision\":\"@outputs('Get_file_properties')?['body/GroteDocumentRevision']\",\"item/Obsolete_x0020_Date\":\"@utcNow()\"},\"authentication\":\"@parameters('$authentication')\"}}},\"runAfter\":{},\"else\":{\"actions\":{\"Get_file_properties_2\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"14a1dc95-32c7-4450-9838-31866931b27b\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"GetFileItem\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"bc460a20-664c-49e7-bfe7-2843495da717\",\"id\":\"@variables('DocID')\"},\"authentication\":\"@parameters('$authentication')\"}},\"Get_file_metadata_2\":{\"runAfter\":{\"Word_File\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"34c9a476-f580-478c-9894-ace1bde1669e\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"GetFileMetadata\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"id\":\"@outputs('Get_file_properties_2')?['body/{Identifier}']\"},\"authentication\":\"@parameters('$authentication')\"}},\"Set_content_approval_status_2\":{\"runAfter\":{\"Get_file_metadata_2\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"69067203-c828-452c-a535-b89ab36398be\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"SetApprovalStatus\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"bc460a20-664c-49e7-bfe7-2843495da717\",\"id\":\"@outputs('Get_file_properties_2')?['body/ID']\",\"approvalAction\":\"Approve\",\"comments\":\"\",\"entityTag\":\"@outputs('Get_file_metadata_2')?['body/ETag']\"},\"authentication\":\"@parameters('$authentication')\"}},\"Word_File\":{\"actions\":{\"Populate_a_Microsoft_Word_template_2\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"989ee9af-8e05-40ad-8708-7551a85a73a5\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_wordonlinebusiness\",\"operationId\":\"CreateFileItem\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_wordonlinebusiness\"},\"parameters\":{\"source\":\"sites/grote0.sharepoint.com,f909bc20-b673-4273-a341-7163e496f030,6fb26e95-d03a-410b-ac27-1097249577b6\",\"drive\":\"b!ILwJ-XO2c0KjQXFj5JbwMJVusm860AtBrCcQlySVd7YgCka8TGbnSb_nKENJXacX\",\"file\":\"@{substring(outputs('Get_file_properties_2')?['body/{Path}'], 17)}@{outputs('Get_file_properties_2')?['body/{FilenameWithExtension}']}\",\"dynamicFileSchema\":{\"-613754213\":\"Approved\"}},\"authentication\":\"@parameters('$authentication')\"}}},\"runAfter\":{\"Get_file_properties_2\":[\"Succeeded\"]},\"expression\":{\"contains\":[\"@outputs('Get_file_properties_2')?['body/{FilenameWithExtension}']\",\"docx\"]},\"metadata\":{\"operationMetadataId\":\"cc5cec27-2611-451d-af72-1217895c2739\"},\"type\":\"If\"},\"Update_ApprovalInfo\":{\"runAfter\":{\"Set_content_approval_status_2\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"9e0cff60-9acb-4167-b216-71cbdf6147b8\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"PatchItem\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"3f960b78-8bab-42f1-a5d4-fa18072ad762\",\"id\":\"@triggerBody()?['ID']\",\"item/Stage\":\"Distribution\"},\"authentication\":\"@parameters('$authentication')\"}}}},\"expression\":{\"equals\":[\"@triggerOutputs()?['body/ApprovalType']\",\"Obsoletion\"]},\"metadata\":{\"operationMetadataId\":\"f6cceea7-6876-4449-a9af-44d6d271d71a\"},\"type\":\"If\"}},\"runAfter\":{\"Set_Approver_Name\":[\"Succeeded\"]},\"expression\":{\"and\":[{\"equals\":[\"@body('Wait_for_an_approval')?['outcome']\",\"Approve\"]}]},\"metadata\":{\"operationMetadataId\":\"082b233f-e9b5-4290-98a6-b9d0e8b0e967\"},\"type\":\"If\"},\"DocID\":{\"runAfter\":{\"ApproverEmail\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"eda47deb-8961-4138-ba7d-756604051171\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"DocID\",\"type\":\"string\",\"value\":\"@triggerBody()?['DocID']\"}]}},\"ApproverType\":{\"runAfter\":{\"DocID\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"32dbd6bc-2688-4ed3-b845-f3257a5509e8\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"ApproverType\",\"type\":\"string\",\"value\":\"@triggerOutputs()?['body/ApproverType']\"}]}},\"Condition_2\":{\"actions\":{\"Condition_3\":{\"actions\":{\"Obsoletion_Approval_-_One\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"f7916e80-2f0a-4479-94c5-a8bf55f4dbc7\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_approvals\",\"operationId\":\"CreateAnApproval\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_approvals\"},\"parameters\":{\"approvalType\":\"Basic\",\"ApprovalCreationInput/title\":\"GDMS | Obsoletion Approval | @{triggerBody()?['Title']}\",\"ApprovalCreationInput/assignedTo\":\"@{variables('ApproverEmail')}\",\"ApprovalCreationInput/details\":\"**Grote Document Management System**\\n_You have a new obsoleted document to approve._\\n\\n**Name:** @{triggerBody()?['Title']} | @{triggerBody()?['Descripton']}\\n**Originated By:** @{triggerBody()?['OriginatorName']}\\n**Document Type:** @{triggerBody()?['DocumentType']}\\n**Division:** @{triggerBody()?['Division']}\\n**Process:**   @{triggerBody()?['Process']}\\n**Reason to Obsolete:** @{triggerOutputs()?['body/Reason']}\",\"ApprovalCreationInput/itemLink\":\"@triggerBody()?['DocumentLink']\",\"ApprovalCreationInput/itemLinkDescription\":\"View document\",\"ApprovalCreationInput/requestor\":\"@triggerBody()?['Originator']\",\"ApprovalCreationInput/enableNotifications\":false,\"ApprovalCreationInput/enableReassignment\":false},\"authentication\":\"@parameters('$authentication')\"}},\"Set_ApprovalID\":{\"runAfter\":{\"Obsoletion_Approval_-_One\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"b442e565-a66a-4987-a82e-9f537560fea6\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"ApprovalID\",\"value\":\"@body('Obsoletion_Approval_-_One')?['name']\"}}},\"runAfter\":{},\"else\":{\"actions\":{\"Obsoletion_Approval_-_All\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"f7916e80-2f0a-4479-94c5-a8bf55f4dbc7\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_approvals\",\"operationId\":\"CreateAnApproval\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_approvals\"},\"parameters\":{\"approvalType\":\"BasicAwaitAll\",\"ApprovalCreationInput/title\":\"GDMS | Obsoletion Approval | @{triggerBody()?['Title']}\",\"ApprovalCreationInput/assignedTo\":\"@variables('ApproverEmail')\",\"ApprovalCreationInput/details\":\"**Grote Document Management System**\\n_You have a new obsoleted document to approve._\\n\\n**Name:** @{triggerBody()?['Title']} | @{triggerBody()?['Descripton']}\\n**Originated By:** @{triggerBody()?['OriginatorName']}\\n**Document Type:** @{triggerBody()?['DocumentType']}\\n**Division:** @{triggerBody()?['Division']}\\n**Process:**   @{triggerBody()?['Process']}\\n**Reason to Obsolete:** @{triggerOutputs()?['body/Reason']}\",\"ApprovalCreationInput/itemLink\":\"@{triggerBody()?['DocumentLink']}\",\"ApprovalCreationInput/itemLinkDescription\":\"View document\",\"ApprovalCreationInput/requestor\":\"@{triggerBody()?['Originator']}\",\"ApprovalCreationInput/enableNotifications\":false,\"ApprovalCreationInput/enableReassignment\":false},\"authentication\":\"@parameters('$authentication')\"}},\"Set_ApprovalID_2\":{\"runAfter\":{\"Obsoletion_Approval_-_All\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"78edcb1d-b5bb-4ed0-9e33-eb9a2ce4c868\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"ApprovalID\",\"value\":\"@body('Obsoletion_Approval_-_All')?['name']\"}}}},\"expression\":{\"equals\":[\"@variables('ApproverType')\",\"One\"]},\"metadata\":{\"operationMetadataId\":\"0a8d853b-57f5-4c45-837f-6a7def6318be\"},\"type\":\"If\"},\"Send_Obsoletion_Approval_Email\":{\"runAfter\":{\"Condition_3\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"5d791e3c-b493-4332-83c9-e4d2f40345c1\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_office365_1\",\"operationId\":\"SendEmailV2\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_office365\"},\"parameters\":{\"emailMessage/To\":\"@variables('ApproverEmail')\",\"emailMessage/Subject\":\"GDMS | New Obsoletion to Approve\",\"emailMessage/Body\":\"<p><i><em>Please do not reply, this is an automated message and responses to this email will not be monitored.</em></i></p><p><br></p><p>You have a new document to approve. Please visit the <b><strong>Approvals </strong></b>tab via <b><strong>Teams </strong></b>to view the request.</p><p><br></p><p><br></p><p><b><strong>Document Name: </strong></b>@{triggerBody()?['Title']} <b><strong>|</strong></b> @{triggerBody()?['Descripton']}</p><p><b><strong>Originated By: </strong></b>@{triggerBody()?['OriginatorName']} </p><p><b><strong>Reason for Obsoletion: </strong></b>@{triggerBody()?['Reason']}<span>\\n</span></p>\",\"emailMessage/Importance\":\"Normal\"},\"authentication\":\"@parameters('$authentication')\"}}},\"runAfter\":{\"RespondLink\":[\"Succeeded\"]},\"else\":{\"actions\":{\"Condition\":{\"actions\":{\"Creation_Approval_-_One\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"fa17c52f-dfcd-4866-a47f-cc6c59bd60d8\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_approvals\",\"operationId\":\"CreateAnApproval\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_approvals\"},\"parameters\":{\"approvalType\":\"Basic\",\"ApprovalCreationInput/title\":\"GDMS | Creation Approval | @{triggerBody()?['Title']}\",\"ApprovalCreationInput/assignedTo\":\"@{variables('ApproverEmail')}\",\"ApprovalCreationInput/details\":\"**Grote Document Management System**\\n_You have a new document creation to approve._\\n\\n**Name:** @{triggerBody()?['Title']} | @{triggerBody()?['Descripton']}\\n**Originated By:** @{triggerBody()?['OriginatorName']}\\n**Document Type:** @{triggerBody()?['DocumentType']}\\n**Division:** @{triggerBody()?['Division']}\\n**Process:**   @{triggerBody()?['Process']}\",\"ApprovalCreationInput/itemLink\":\"@{triggerBody()?['DocumentLink']}\",\"ApprovalCreationInput/itemLinkDescription\":\"View document\",\"ApprovalCreationInput/requestor\":\"@{triggerBody()?['Originator']}\",\"ApprovalCreationInput/enableNotifications\":false,\"ApprovalCreationInput/enableReassignment\":false},\"authentication\":\"@parameters('$authentication')\"}},\"Set_ApprovalID_3\":{\"runAfter\":{\"Creation_Approval_-_One\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"629dca08-cc8d-4138-bdd3-61f34a621cfc\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"ApprovalID\",\"value\":\"@body('Creation_Approval_-_One')?['name']\"}},\"Set_RespondLink\":{\"runAfter\":{\"Set_ApprovalID_3\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"9894a423-76a2-449b-8497-d16aa158d8fa\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"RespondLink\",\"value\":\"@outputs('Creation_Approval_-_One')?['body/respondLink']\"}}},\"runAfter\":{},\"else\":{\"actions\":{\"Creation_Approval_-_All\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"42d221e2-dbcd-47ff-8390-44acea300e2e\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_approvals\",\"operationId\":\"CreateAnApproval\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_approvals\"},\"parameters\":{\"approvalType\":\"BasicAwaitAll\",\"ApprovalCreationInput/title\":\"GDMS | Creation Approval | @{triggerBody()?['Title']}\",\"ApprovalCreationInput/assignedTo\":\"@{variables('ApproverEmail')}\",\"ApprovalCreationInput/details\":\"**Grote Document Management System**\\n_You have a new document creation to approve._\\n\\n**Name:** @{triggerBody()?['Title']} | @{triggerBody()?['Descripton']}\\n**Originated By:** @{triggerBody()?['OriginatorName']}\\n**Document Type:** @{triggerBody()?['DocumentType']}\\n**Division:** @{triggerBody()?['Division']}\\n**Process:**   @{triggerBody()?['Process']}\",\"ApprovalCreationInput/itemLink\":\"@{triggerBody()?['DocumentLink']}\",\"ApprovalCreationInput/itemLinkDescription\":\"View document\",\"ApprovalCreationInput/requestor\":\"@{triggerBody()?['Originator']}\",\"ApprovalCreationInput/enableNotifications\":false,\"ApprovalCreationInput/enableReassignment\":false},\"authentication\":\"@parameters('$authentication')\"}},\"Set_ApprovalID_4\":{\"runAfter\":{\"Creation_Approval_-_All\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"f0dcaba5-11c2-4a70-92ba-f6ed2ac8e94f\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"ApprovalID\",\"value\":\"@body('Creation_Approval_-_All')?['name']\"}},\"Set_RespondLink_2\":{\"runAfter\":{\"Set_ApprovalID_4\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"c1485074-4f9d-4147-8ddc-2b383fc93a92\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"RespondLink\",\"value\":\"@outputs('Creation_Approval_-_All')?['body/respondLink']\"}}}},\"expression\":{\"and\":[{\"equals\":[\"@variables('ApproverType')\",\"One\"]}]},\"metadata\":{\"operationMetadataId\":\"8751bbad-7cad-4f83-890d-7589b7f2653c\"},\"type\":\"If\"},\"Send_Creation_Approval_Email\":{\"runAfter\":{\"Condition\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"5d225452-7bd6-48a3-87f8-6ab90c7e2f45\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_office365_1\",\"operationId\":\"SendEmailV2\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_office365\"},\"parameters\":{\"emailMessage/To\":\"@variables('ApproverEmail')\",\"emailMessage/Subject\":\"GDMS | New Document to Approve\",\"emailMessage/Body\":\"<p><i><em>Please do not reply, this is an automated message and responses to this email will not be monitored.</em></i></p><p>You have a new document to approve. Please visit the <b><strong>Approvals </strong></b>tab via <b><strong>Teams </strong></b>to view the request.</p><p><b><strong>Document Name: </strong></b>@{triggerBody()?['Title']} <b><strong>|</strong></b> @{triggerBody()?['Descripton']}</p><p><b><strong>Originated By:</strong></b> @{triggerBody()?['OriginatorName']}</p><p><br></p><p><b><strong>Response Link: </strong></b>@{variables('RespondLink')}</p><p></p>\",\"emailMessage/Importance\":\"Normal\"},\"authentication\":\"@parameters('$authentication')\"}}}},\"expression\":{\"equals\":[\"@triggerOutputs()?['body/ApprovalType']\",\"Obsoletion\"]},\"metadata\":{\"operationMetadataId\":\"3f528312-e620-4128-b89f-2cd1283f1b1a\"},\"type\":\"If\"},\"ApprovalID\":{\"runAfter\":{\"ApproverType\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"8e9c4d63-01b6-4ec2-98f0-650dc246d1db\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"ApprovalID\",\"type\":\"string\"}]}},\"ApproverName\":{\"runAfter\":{\"ApprovalID\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"9eda89e6-6763-4a51-b030-d47f048edf07\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"ApproverName\",\"type\":\"string\"}]}},\"Set_Approver_Name\":{\"foreach\":\"@outputs('Wait_for_an_approval')?['body/responses']\",\"actions\":{\"Set_ApproverName\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"7a1ebd0a-305e-4caa-836c-674e9517b9db\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"ApproverName\",\"value\":\"@items('Set_Approver_Name')?['responder/displayName']\"}}},\"runAfter\":{\"Wait_for_an_approval\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"1f140f86-dae1-4b10-bcca-43f5dee85b9d\"},\"type\":\"Foreach\"},\"RespondLink\":{\"runAfter\":{\"ApproverName\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"d08bd493-9305-46c0-8ed9-cbee18b4173d\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"RespondLink\",\"type\":\"string\"}]}}},\"outputs\":{}},\"templateName\":\"\"},\"schemaVersion\":\"1.0.0.0\"}","createdBy":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","modifiedBy":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","ownerId":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","owningBusinessUnit":"ee0a9aec-b63d-e911-a81c-000d3a11eefe","owningUser":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff"},{"name":"GDMS_Modify_Approval","createdOn":"2023-07-31T04:02:30Z","modifiedOn":"2023-11-26T19:46:02Z","workflowId":"3c376211-572f-ee11-bdf3-000d3a1b983d","resourceId":"c1161530-9cef-44c3-b0db-5c9b8e04fb89","stateCode":"Draft","statusCode":"Draft","definition":"{\"properties\":{\"connectionReferences\":{\"shared_sharepointonline\":{\"runtimeSource\":\"embedded\",\"connection\":{\"name\":\"shared-sharepointonl-947cca0b-9618-4af1-b27f-1d5711ca17b2\",\"connectionReferenceLogicalName\":\"spo_sharedsharepointonline_e3ac5\"},\"api\":{\"name\":\"shared_sharepointonline\"}},\"shared_approvals\":{\"runtimeSource\":\"embedded\",\"connection\":{\"name\":\"4108f82f6250453eb5ddddeb83641672\",\"connectionReferenceLogicalName\":\"spo_sharedapprovals_4eb02\"},\"api\":{\"name\":\"shared_approvals\"}},\"shared_office365_1\":{\"runtimeSource\":\"embedded\",\"connection\":{\"name\":\"shared-office365-5bd6a51a-7202-4b32-b2cb-5d99c414fe6e\",\"connectionReferenceLogicalName\":\"spo_sharedoffice365_5e3dc\"},\"api\":{\"name\":\"shared_office365\"}},\"shared_office365\":{\"runtimeSource\":\"embedded\",\"connection\":{\"name\":\"shared-office365-359508f2-3484-4ea4-8f85-24831ac9d9fc\",\"connectionReferenceLogicalName\":\"spo_sharedoffice365_36d3c\"},\"api\":{\"name\":\"shared_office365\"}}},\"definition\":{\"$schema\":\"https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"$connections\":{\"defaultValue\":{},\"type\":\"Object\"},\"$authentication\":{\"defaultValue\":{},\"type\":\"SecureObject\"}},\"triggers\":{\"When_an_item_or_a_file_is_modified\":{\"recurrence\":{\"frequency\":\"Minute\",\"interval\":1},\"splitOn\":\"@triggerOutputs()?['body/value']\",\"metadata\":{\"operationMetadataId\":\"ced1efd5-95cf-4c0a-8c86-294ccb1093fc\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"GetOnChangedItems\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"bc460a20-664c-49e7-bfe7-2843495da717\"},\"authentication\":\"@parameters('$authentication')\"}}},\"actions\":{\"Create_varOriginator_(Originator)\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"e8b9c745-1d7e-4803-b6a9-c72cee03499a\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"varOriginator\",\"type\":\"string\"}]}},\"Create_varOrigApp_(Origination_Approver)\":{\"runAfter\":{\"Create_varOriginator_(Originator)\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"d00f173e-fb55-41c4-b0c3-0174be94e874\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"varOrigApp\",\"type\":\"string\"}]}},\"Create_varApprovers_(Approvers)\":{\"runAfter\":{\"Create_varOrigApp_(Origination_Approver)\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"253e6c9a-94ec-4412-a470-fbc4bae5c000\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"varApprovers\",\"type\":\"string\"}]}},\"Create_varAppApp_(Approvers_Approver)\":{\"runAfter\":{\"Create_varApprovers_(Approvers)\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"89741cfa-f2d4-4538-86b8-abe7fa583730\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"varAppApp\",\"type\":\"string\"}]}},\"Create_varReviewers_(Reviewers)\":{\"runAfter\":{\"Create_varAppApp_(Approvers_Approver)\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"6cd1eb0a-8775-4177-b6a9-2ec74adc4f7c\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"varReviewers\",\"type\":\"string\"}]}},\"Create_varRevApp_(Reviewers_Approver)\":{\"runAfter\":{\"Create_varReviewers_(Reviewers)\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"726a16d0-7e8c-40cf-8565-075ed9a57d1e\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"varRevApp\",\"type\":\"string\"}]}},\"Get_file_properties\":{\"runAfter\":{\"Create_ActiveApprovalID\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"4b38a5d0-b96f-4dad-b5eb-24c8aa13686b\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"GetFileItem\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"bc460a20-664c-49e7-bfe7-2843495da717\",\"id\":\"@triggerOutputs()?['body/ID']\"},\"authentication\":\"@parameters('$authentication')\"}},\"Get_items\":{\"runAfter\":{\"Get_file_properties\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"18a06326-6929-4188-ab38-94465c1ad69f\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"GetItems\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"8817a49e-b48d-4634-9918-1c7716a2d1e5\",\"$filter\":\"(Location eq '') and (Process eq '')\"},\"authentication\":\"@parameters('$authentication')\"}},\"Get_file_metadata\":{\"runAfter\":{\"Get_items\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"93538256-2969-4f76-b72c-19a4ec1735e5\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"GetFileMetadata\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"id\":\"@triggerOutputs()?['body/{Identifier}']\"},\"authentication\":\"@parameters('$authentication')\"}},\"Set_varOriginator_to_file_creator\":{\"foreach\":\"@outputs('Get_items')?['body/value']\",\"actions\":{\"Set_varOriginator\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"b0010a51-70d4-4f2b-9979-81ef24d7bcce\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"varOriginator\",\"value\":\"@triggerOutputs()?['body/Editor/Email']\"}}},\"runAfter\":{\"Set_as_Active_Approval\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"016da956-82cb-4462-b564-bd7ca9ff1d20\"},\"type\":\"Foreach\"},\"Origination_Approval\":{\"runAfter\":{\"Set_varOriginator_to_file_creator\":[\"Succeeded\"]},\"limit\":{\"timeout\":\"P29D\"},\"metadata\":{\"operationMetadataId\":\"fcc3111c-fd57-473a-a7cb-33a866dd749e\"},\"type\":\"OpenApiConnectionWebhook\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_approvals\",\"connectionName\":\"shared_approvals\",\"operationId\":\"StartAndWaitForAnApproval\"},\"parameters\":{\"approvalType\":\"BasicAwaitAll\",\"WebhookApprovalCreationInput/title\":\"GDMS | Document Origination | @{triggerOutputs()?['body/GroteDocumentDescription']}\",\"WebhookApprovalCreationInput/assignedTo\":\"@{triggerOutputs()?['body/Editor/Email']};\",\"WebhookApprovalCreationInput/details\":\"**Grote Document Management System**\\n_You have a new originated document to approve._\\n\\n**Name:** @{triggerOutputs()?['body/{Name}']} | @{triggerOutputs()?['body/GroteDocumentDescription']}\\n**Originated By:** @{triggerOutputs()?['body/Author/DisplayName']}\\n**Document Type:** @{triggerOutputs()?['body/GroteDocumentType']}\\n**Division:** @{triggerOutputs()?['body/GroteDivision/Value']}\\n**Process:**   @{triggerOutputs()?['body/GroteProcess/Value']}\",\"WebhookApprovalCreationInput/itemLink\":\"@triggerOutputs()?['body/{Link}']\",\"WebhookApprovalCreationInput/itemLinkDescription\":\"View Document\",\"WebhookApprovalCreationInput/requestor\":\"@{variables('varOriginator')};\",\"WebhookApprovalCreationInput/enableNotifications\":false,\"WebhookApprovalCreationInput/enableReassignment\":false},\"authentication\":\"@parameters('$authentication')\"}},\"Outcome_of_Origination_Approval\":{\"actions\":{\"Outcome_of_Approver_Approval\":{\"actions\":{\"Condition\":{\"actions\":{\"Notify_Originator_3\":{\"runAfter\":{\"Update_file_properties\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"010954e2-ca05-4e57-93d4-d7c9424ff520\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_office365\",\"connectionName\":\"shared_office365_1\",\"operationId\":\"SendEmailV2\"},\"parameters\":{\"emailMessage/To\":\"@variables('varOriginator')\",\"emailMessage/Subject\":\"GDMS | Document Approved\",\"emailMessage/Body\":\"<p>Please do not reply, this is an automated message and responses to this email will not be monitored.<br>\\n<br>\\n<strong>STATUS</strong><br>\\n----------------<br>\\n<strong>Origination<br>\\n<br>\\nApproval<br>\\n<br>\\nReviewal</strong><br>\\n----------------<br>\\n<br>\\nYour originated document,  (), has been reviewed and approved. The document has been published and can be found at the attached link. </p>\",\"emailMessage/Importance\":\"Normal\"},\"authentication\":\"@parameters('$authentication')\"}},\"Update_file_properties\":{\"runAfter\":{\"Set_content_approval_status\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"cba9c71d-a825-4b11-a3a1-892e47498a5d\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"PatchFileItem\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"bc460a20-664c-49e7-bfe7-2843495da717\",\"id\":\"@triggerOutputs()?['body/ID']\",\"item/GroteDocumentShortDescription\":\"@triggerOutputs()?['body/GroteDocumentShortDescription']\",\"item/GroteDocumentDescription\":\"@triggerOutputs()?['body/GroteDocumentDescription']\",\"item/GroteDocumentRevision\":\"@add(triggerOutputs()?['body/{VersionNumber}'],1)\",\"item/ObsoleteInProgress\":false},\"authentication\":\"@parameters('$authentication')\"}},\"Delecte_Active_Approval_Approver_2\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"5c377fac-4202-46f8-b7ec-153447cb4921\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"DeleteItem\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"9139a2aa-626a-4e02-becc-60943ad79ccc\",\"id\":\"@variables('ActiveApprovalID')\"},\"authentication\":\"@parameters('$authentication')\"}},\"Set_content_approval_status\":{\"runAfter\":{\"Delecte_Active_Approval_Approver_2\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"de00c220-f23f-43df-a7ac-d40acab9c219\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"SetApprovalStatus\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"bc460a20-664c-49e7-bfe7-2843495da717\",\"id\":\"@triggerOutputs()?['body/ID']\",\"approvalAction\":\"Approve\",\"comments\":\"\",\"entityTag\":\"@outputs('Get_file_metadata')?['body/ETag']\"},\"authentication\":\"@parameters('$authentication')\"}}},\"runAfter\":{\"Ser_varAppApp_to_Approval_Approver\":[\"Succeeded\"]},\"else\":{\"actions\":{\"Reviewal_Reject_Email\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"4b713837-d3fa-4c23-9a98-6fab677df4fd\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_office365\",\"connectionName\":\"shared_office365\",\"operationId\":\"SendEmailV2\"},\"parameters\":{\"emailMessage/To\":\"@variables('varOriginator')\",\"emailMessage/Subject\":\"GDMS | Document Rejected\",\"emailMessage/Body\":\"<p><em>Please do not reply, this is an automated message and responses to this email will not be monitored.</em><br>\\n<br>\\nSTATUS<br>\\n----------------<br>\\n<strong>Origination</strong><br>\\n<br>\\n<strong>Approval</strong><br>\\n<br>\\n<strong>Reviewal</strong><br>\\n----------------<br>\\n<br>\\nYour originated document, @{triggerOutputs()?['body/{Name}']} (@{triggerOutputs()?['body/GroteDocumentDescription']}), has been rejected at the approval stage.<br>\\n</p>\",\"emailMessage/Importance\":\"Normal\"},\"authentication\":\"@parameters('$authentication')\"}},\"Delete_Doc_Number_3\":{\"foreach\":\"@outputs('Doc_Number_ID_on_List')?['body/value']\",\"actions\":{\"Delete_item\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"ca5e10ec-6e0e-41ff-a9ee-2a612ec79a10\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"DeleteItem\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"66953198-05c9-40f9-bdfa-e0744efc90cc\",\"id\":\"@items('Delete_Doc_Number_3')?['ID']\"},\"authentication\":\"@parameters('$authentication')\"}}},\"runAfter\":{\"Reviewal_Reject_Email\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"74d88ff6-0e73-4405-83fd-7fa861b1e41c\"},\"type\":\"Foreach\"},\"Delect_Active_Approval_Reviewer\":{\"runAfter\":{\"Delete_Doc_Number_3\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"3438ecd2-afc2-42f7-9f50-15e2cefd9375\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"DeleteItem\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"9139a2aa-626a-4e02-becc-60943ad79ccc\",\"id\":\"@variables('ActiveApprovalID')\"},\"authentication\":\"@parameters('$authentication')\"}},\"Delete_file\":{\"runAfter\":{\"Delect_Active_Approval_Reviewer\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"d0499910-2ab9-42d1-bbbd-abbb4acc9ec3\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"DeleteFile\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"id\":\"@triggerOutputs()?['body/{Identifier}']\"},\"authentication\":\"@parameters('$authentication')\"}}}},\"expression\":{\"equals\":[\"@outputs('Approver_Approval')?['body/outcome']\",\"Approve\"]},\"metadata\":{\"operationMetadataId\":\"c90cdaeb-4aff-405d-9c7c-33cabb5d045e\"},\"type\":\"If\"},\"Get-Create_Approvers_list_for_document\":{\"foreach\":\"@outputs('Get_items')?['body/value']\",\"actions\":{\"Select\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"96d7c507-2b71-4ed1-a722-9650d8fdd2a5\"},\"type\":\"Select\",\"inputs\":{\"from\":\"@items('Get-Create_Approvers_list_for_document')?['Approvers']\",\"select\":\"@item()?['Email']\"}},\"Join\":{\"runAfter\":{\"Select\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"de9285b3-25eb-40ae-8302-4f28b6be8766\"},\"type\":\"Join\",\"inputs\":{\"from\":\"@body('Select')\",\"joinWith\":\";\"}},\"Set_variable\":{\"runAfter\":{\"Join\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"19d23d1e-5243-468d-a8dc-d4db7ac55a8b\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"varApprovers\",\"value\":\"@body('Join')\"}}},\"runAfter\":{\"Notify_Originator_2\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"eb515a3b-c45d-4fea-b970-30ff81809668\"},\"type\":\"Foreach\"},\"Approver_Approval\":{\"runAfter\":{\"Notify_Approver\":[\"Succeeded\"]},\"limit\":{\"timeout\":\"P29D\"},\"metadata\":{\"operationMetadataId\":\"9db5eb7c-baa2-4159-a403-b91d5c9175b8\"},\"type\":\"OpenApiConnectionWebhook\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_approvals\",\"connectionName\":\"shared_approvals\",\"operationId\":\"StartAndWaitForAnApproval\"},\"parameters\":{\"approvalType\":\"BasicAwaitAll\",\"WebhookApprovalCreationInput/title\":\"GDMS | Document Approval | @{triggerOutputs()?['body/GroteDocumentDescription']}\",\"WebhookApprovalCreationInput/assignedTo\":\"@{variables('varApprovers')};\",\"WebhookApprovalCreationInput/details\":\"**Grote Document Management System**\\n_You have a new document to approve._\\n\\n**Name:** @{triggerOutputs()?['body/{Name}']} | @{triggerOutputs()?['body/GroteDocumentDescription']}\\n**Document Type:** @{triggerOutputs()?['body/GroteDocumentType/Value']}\\n**Division:** @{triggerOutputs()?['body/GroteDivision/Value']}\\n**Process:**   @{triggerOutputs()?['body/GroteProcess/Value']}\\n\\n**Originated By:** @{triggerOutputs()?['body/Author/DisplayName']}\\n**Origination Approved By:** @{variables('varOrigApp')}\\n**Reviewed By:** @{variables('varAppApp')}\",\"WebhookApprovalCreationInput/itemLink\":\"@triggerOutputs()?['body/{Link}']\",\"WebhookApprovalCreationInput/itemLinkDescription\":\"View Document\",\"WebhookApprovalCreationInput/requestor\":\"@{variables('varOriginator')};\",\"WebhookApprovalCreationInput/enableNotifications\":false,\"WebhookApprovalCreationInput/enableReassignment\":false},\"authentication\":\"@parameters('$authentication')\"}},\"Update_Active_Approval_Approver\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"21ce26ca-c70f-4615-abac-fdde000f7516\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"PatchItem\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"9139a2aa-626a-4e02-becc-60943ad79ccc\",\"id\":\"@variables('ActiveApprovalID')\",\"item/Title\":\"@triggerOutputs()?['body/{Name}']\",\"item/Status\":\"Awaiting Approver Approval\",\"item/Division\":\"@triggerOutputs()?['body/GroteDivision/Value']\",\"item/Process\":\"@triggerOutputs()?['body/GroteProcess/Value']\"},\"authentication\":\"@parameters('$authentication')\"}},\"Notify_Originator_2\":{\"runAfter\":{\"Update_Active_Approval_Approver\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"2c276476-b296-41f0-b683-0330b630bb1b\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_office365\",\"connectionName\":\"shared_office365_1\",\"operationId\":\"SendEmailV2\"},\"parameters\":{\"emailMessage/To\":\"@variables('varOriginator')\",\"emailMessage/Subject\":\"GDMS | Document Approval\",\"emailMessage/Body\":\"<p><em>Please do not reply, this is an automated message and responses to this email will not be monitored.</em><br>\\n<br>\\n<strong>STATUS</strong><br>\\n----------------<br>\\n<strong>Origination<br>\\n<br>\\nReviewal<br>\\n<br>\\n</strong><span style=\\\"color: rgb(0,0,0)\\\">Approval</span><br>\\n----------------<br>\\n<br>\\nYour originated document, @{triggerOutputs()?['body/{Name}']} (@{triggerOutputs()?['body/GroteDocumentDescription']}), has been reviewed and sent to the approval stage and is now awaiting approval from one of the process approvers.<br>\\n<br>\\nPlease note that this process may take some time, and you will be notified once the document furthers along in the process.</p>\",\"emailMessage/Importance\":\"Normal\"},\"authentication\":\"@parameters('$authentication')\"}},\"Notify_Approver\":{\"runAfter\":{\"Set_varRevApp_to_Reviewer_Approver\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"f6fe1631-bfe7-4ba8-9f25-04b32c90dd59\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_office365\",\"connectionName\":\"shared_office365\",\"operationId\":\"SendEmailV2\"},\"parameters\":{\"emailMessage/To\":\"@variables('varApprovers')\",\"emailMessage/Subject\":\"GDMS | New Document to Approve\",\"emailMessage/Body\":\"<p><em>Please do not reply, this is an automated message and responses to this email will not be monitored.<br>\\n</em><br>\\nYou have a new document to approve. Please visit the <strong>Approvals </strong>tab via <strong>Teams </strong>to view the request.<br>\\n<br>\\n<strong>Document Name:</strong> @{triggerOutputs()?['body/{Name}']} <strong>|</strong> @{triggerOutputs()?['body/GroteDocumentDescription']}<br>\\n<strong>Originated By:</strong> @{triggerOutputs()?['body/Author/DisplayName']}<br>\\n<strong>Reviewed By:</strong> @{variables('varRevApp')}</p>\",\"emailMessage/Importance\":\"Normal\"},\"authentication\":\"@parameters('$authentication')\"}},\"Ser_varAppApp_to_Approval_Approver\":{\"foreach\":\"@outputs('Approver_Approval')?['body/responses']\",\"actions\":{\"Set_varAppApp\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"cf74de14-a767-474c-a159-f08aad7f89f9\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"varAppApp\",\"value\":\"@items('Ser_varAppApp_to_Approval_Approver')?['responder/displayName']\"}}},\"runAfter\":{\"Approver_Approval\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"0e61f556-2098-4006-8ae7-806f46d10e7f\"},\"type\":\"Foreach\"},\"Timeout_Retrigger_3\":{\"runAfter\":{\"Approver_Approval\":[\"TimedOut\"]},\"metadata\":{\"operationMetadataId\":\"0983264c-51ed-4cec-ad91-9b3be5698997\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"PostItem\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"4c86833c-1920-4dda-bdf8-c86549312eff\",\"item/FileName\":\"@triggerOutputs()?['body/{Name}']\",\"item/DocumentName\":\"@triggerOutputs()?['body/GroteDocumentDescription']\",\"item/StartedBy\":\"@variables('varOriginator')\",\"item/DocumentType\":\"@triggerOutputs()?['body/GroteDocumentType/Value']\",\"item/RetriggerType\":\"Create\",\"item/CurrentStageWaiting\":\"Approve\",\"item/Division\":\"@triggerOutputs()?['body/GroteDivision/Value']\",\"item/Process\":\"@triggerOutputs()?['body/GroteProcess/Value']\",\"item/DocumentNumber\":\"@triggerOutputs()?['body/GroteDocumentShortDescription']\",\"item/ItemID\":\"@triggerOutputs()?['body/ID']\",\"item/ETag\":\"@outputs('Get_file_metadata')?['body/ETag']\",\"item/ApprovalID\":\"@outputs('Approver_Approval')?['body/name']\"},\"authentication\":\"@parameters('$authentication')\"}},\"Set_varRevApp_to_Reviewer_Approver\":{\"foreach\":\"@outputs('Reviewer_Approval')?['body/responses']\",\"actions\":{\"Set_varRevApp\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"e8d4a065-7a23-48d7-a9d6-658708dae306\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"varRevApp\",\"value\":\"@items('Set_varRevApp_to_Reviewer_Approver')?['responder/displayName']\"}}},\"runAfter\":{\"Get-Create_Approvers_list_for_document\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"4a5059fe-ab21-4068-9f5d-b48188283324\"},\"type\":\"Foreach\"}},\"runAfter\":{\"Reviewer_Approval\":[\"Succeeded\"]},\"else\":{\"actions\":{\"Notify_Originator_2_(Reject)\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"6d4b3873-a3c4-469c-a8d1-99e5fa62dd3f\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_office365\",\"connectionName\":\"shared_office365\",\"operationId\":\"SendEmailV2\"},\"parameters\":{\"emailMessage/To\":\"@variables('varOriginator')\",\"emailMessage/Subject\":\"GDMS | Document Rejected\",\"emailMessage/Body\":\"<p><em>Please do not reply, this is an automated message and responses to this email will not be monitored.</em><br>\\n<br>\\nSTATUS<br>\\n----------------<br>\\n<strong>Origination</strong><br>\\n<br>\\n<strong>Approval</strong><br>\\n<br>\\nReviewal<br>\\n----------------<br>\\n<br>\\nYour originated document, @{triggerOutputs()?['body/{Name}']} (@{triggerOutputs()?['body/GroteDocumentDescription']}), has been rejected at the approval stage.<br>\\n</p>\",\"emailMessage/Importance\":\"Normal\"},\"authentication\":\"@parameters('$authentication')\"}},\"Delete_Doc_Number_2\":{\"foreach\":\"@outputs('Doc_Number_ID_on_List')?['body/value']\",\"actions\":{\"Delete_item_2\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"80fd56a0-6445-4c7e-83fc-465fa0a17ad5\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"DeleteItem\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"66953198-05c9-40f9-bdfa-e0744efc90cc\",\"id\":\"@items('Delete_Doc_Number_2')?['ID']\"},\"authentication\":\"@parameters('$authentication')\"}}},\"runAfter\":{\"Notify_Originator_2_(Reject)\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"54f9f8c6-cc7a-4f58-a5d6-647fe59f71af\"},\"type\":\"Foreach\"},\"Delete_Active_Approval_Approver\":{\"runAfter\":{\"Delete_Doc_Number_2\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"dc30ee2b-b1f7-4f75-a96b-73da8972c739\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"DeleteItem\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"9139a2aa-626a-4e02-becc-60943ad79ccc\",\"id\":\"@variables('ActiveApprovalID')\"},\"authentication\":\"@parameters('$authentication')\"}},\"Delete_file_2\":{\"runAfter\":{\"Delete_Active_Approval_Approver\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"8ba07906-25dd-4cda-9160-dd89971fc682\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"DeleteFile\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"id\":\"@triggerOutputs()?['body/{Identifier}']\"},\"authentication\":\"@parameters('$authentication')\"}}}},\"expression\":{\"equals\":[\"@outputs('Reviewer_Approval')?['body/outcome']\",\"Approve\"]},\"metadata\":{\"operationMetadataId\":\"0195044e-3043-469e-b989-e72af8f4687f\"},\"type\":\"If\"},\"Update_Active_Approval_Reviewer\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"195293e3-3e96-45f1-82bc-e4ea0be90a4b\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"PatchItem\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"9139a2aa-626a-4e02-becc-60943ad79ccc\",\"id\":\"@variables('ActiveApprovalID')\",\"item/Title\":\"@triggerOutputs()?['body/{Name}']\",\"item/Status\":\"Awaiting Approval Reviewer\",\"item/Division\":\"@triggerOutputs()?['body/GroteDivision/Value']\",\"item/Process\":\"@triggerOutputs()?['body/GroteProcess/Value']\"},\"authentication\":\"@parameters('$authentication')\"}},\"Notify_Originator\":{\"runAfter\":{\"Update_Active_Approval_Reviewer\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"180b77a1-ebe4-4f33-8fc3-0ff2be69ddc4\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_office365\",\"connectionName\":\"shared_office365_1\",\"operationId\":\"SendEmailV2\"},\"parameters\":{\"emailMessage/To\":\"@variables('varOriginator')\",\"emailMessage/Subject\":\"GDMS | Document Origination Approved\",\"emailMessage/Body\":\"<p><em>Please do not reply, this is an automated message and responses to this email will not be monitored.<br>\\n<br>\\n</em><strong>STATUS</strong><em><br>\\n----------------<br>\\n</em><strong>Origination<br>\\n<br>\\n</strong>Reviewal<br>\\n<br>\\n<span style=\\\"color: rgb(71,85,119)\\\"><em>Approval</em></span><em><br>\\n----------------<br>\\n<br>\\n</em>Your originated document, @{triggerOutputs()?['body/{Name}']} (@{triggerOutputs()?['body/GroteDocumentDescription']}), has been sent to the review stage and is now awaiting reviewal from one of the department approvers.<br>\\n<br>\\nPlease note that this process may take some time, and you will be notified once the document furthers along in the process.</p>\",\"emailMessage/Importance\":\"Normal\"},\"authentication\":\"@parameters('$authentication')\"}},\"Get-Create_Reviewers_list_for_document\":{\"foreach\":\"@outputs('Get_items')?['body/value']\",\"actions\":{\"Select_2\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"1fe0af15-331f-47e6-86e9-43b3ba1ad235\"},\"type\":\"Select\",\"inputs\":{\"from\":\"@items('Get-Create_Reviewers_list_for_document')?['Reviewers']\",\"select\":\"@item()['Email']\"}},\"Join_2\":{\"runAfter\":{\"Select_2\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"127a2f0d-6401-49a5-849a-32c974e89d8b\"},\"type\":\"Join\",\"inputs\":{\"from\":\"@body('Select_2')\",\"joinWith\":\";\"}},\"Set_varReviewers\":{\"runAfter\":{\"Join_2\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"bd4686bd-154a-4fe5-b419-cb59614ea5a2\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"varReviewers\",\"value\":\"@body('Join_2')\"}}},\"runAfter\":{\"Notify_Originator\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"00e12b3c-1aee-4f9f-9b2c-790fcc518986\"},\"type\":\"Foreach\"},\"Reviewer_Approval\":{\"runAfter\":{\"Notify_Reviewer\":[\"Succeeded\"]},\"limit\":{\"timeout\":\"P29D\"},\"metadata\":{\"operationMetadataId\":\"32bf34ff-e8cb-4126-b980-cb24d173e151\"},\"type\":\"OpenApiConnectionWebhook\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_approvals\",\"connectionName\":\"shared_approvals\",\"operationId\":\"StartAndWaitForAnApproval\"},\"parameters\":{\"approvalType\":\"Basic\",\"WebhookApprovalCreationInput/title\":\"GDMS | Document Review | @{triggerOutputs()?['body/GroteDocumentDescription']}\",\"WebhookApprovalCreationInput/assignedTo\":\"@{variables('varReviewers')};\",\"WebhookApprovalCreationInput/details\":\"**Grote Document Management System**\\n_You have a new document to review._\\n\\n**Name:** @{triggerOutputs()?['body/{Name}']} | @{triggerOutputs()?['body/GroteDocumentDescription']}\\n**Document Type:** @{triggerOutputs()?['body/GroteDocumentType']}\\n**Division:** @{triggerOutputs()?['body/GroteDivision/Value']}\\n**Process:**   @{triggerOutputs()?['body/GroteProcess/Value']}\\n\\n**Originated By:** @{triggerOutputs()?['body/Author/DisplayName']}\\n**Origination Approved By:** @{variables('varOrigApp')}\",\"WebhookApprovalCreationInput/itemLink\":\"@triggerOutputs()?['body/{Link}']\",\"WebhookApprovalCreationInput/itemLinkDescription\":\"View Document\",\"WebhookApprovalCreationInput/requestor\":\"@{variables('varOriginator')};\",\"WebhookApprovalCreationInput/enableNotifications\":false,\"WebhookApprovalCreationInput/enableReassignment\":false},\"authentication\":\"@parameters('$authentication')\"}},\"Set_varOrigApp_to_Origination_Approver\":{\"foreach\":\"@outputs('Origination_Approval')?['body/responses']\",\"actions\":{\"Set_varOrigApp\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"7cca6b74-e75e-4500-8b36-63ffc0242dd4\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"varOrigApp\",\"value\":\"@items('Set_varOrigApp_to_Origination_Approver')?['responder/displayName']\"}}},\"runAfter\":{\"Get-Create_Reviewers_list_for_document\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"58e4f491-1f8c-4836-963a-5c0aa3641396\"},\"type\":\"Foreach\"},\"Notify_Reviewer\":{\"runAfter\":{\"Set_varOrigApp_to_Origination_Approver\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"321a8a39-c9b9-48da-920c-029966ab5b09\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_office365\",\"connectionName\":\"shared_office365\",\"operationId\":\"SendEmailV2\"},\"parameters\":{\"emailMessage/To\":\"@variables('varReviewers')\",\"emailMessage/Subject\":\"GDMS | New Document to Review\",\"emailMessage/Body\":\"<p><em>Please do not reply, this is an automated message and responses to this email will not be monitored.</em><br>\\n<br>\\nYou have a new document to review. Please visit the <strong>Approvals </strong>tab via <strong>Teams </strong>to view the request.<br>\\n<br>\\n<strong>Document Name:</strong> @{triggerOutputs()?['body/{Name}']} <strong>|</strong> @{triggerOutputs()?['body/GroteDocumentDescription']}<br>\\n<strong>Originated By:</strong> @{triggerOutputs()?['body/Author/DisplayName']}</p>\",\"emailMessage/Importance\":\"Normal\"},\"authentication\":\"@parameters('$authentication')\"}},\"Timeout_Retrigger_2\":{\"runAfter\":{\"Reviewer_Approval\":[\"TimedOut\"]},\"metadata\":{\"operationMetadataId\":\"56e5ed1f-e322-4671-9e2e-f97beb1e3b2d\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"PostItem\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"4c86833c-1920-4dda-bdf8-c86549312eff\",\"item/FileName\":\"@triggerOutputs()?['body/{Name}']\",\"item/DocumentName\":\"@triggerOutputs()?['body/GroteDocumentDescription']\",\"item/StartedBy\":\"@variables('varOriginator')\",\"item/DocumentType\":\"@triggerOutputs()?['body/GroteDocumentType/Value']\",\"item/RetriggerType\":\"Modify\",\"item/CurrentStageWaiting\":\"Review\",\"item/Division\":\"@triggerOutputs()?['body/GroteDivision/Value']\",\"item/Process\":\"@triggerOutputs()?['body/GroteProcess/Value']\",\"item/DocumentNumber\":\"@triggerOutputs()?['body/GroteDocumentShortDescription']\",\"item/ItemID\":\"@triggerOutputs()?['body/ID']\",\"item/ETag\":\"@outputs('Get_file_metadata')?['body/ETag']\",\"item/ApprovalID\":\"@outputs('Reviewer_Approval')?['body/name']\"},\"authentication\":\"@parameters('$authentication')\"}}},\"runAfter\":{\"Origination_Approval\":[\"Succeeded\"]},\"else\":{\"actions\":{\"Delete_Doc_Number\":{\"foreach\":\"@outputs('Doc_Number_ID_on_List')?['body/value']\",\"actions\":{\"Delete_item_3\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"6d7a4755-1539-45a0-b042-118dcc4c2036\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"DeleteItem\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"66953198-05c9-40f9-bdfa-e0744efc90cc\",\"id\":\"@items('Delete_Doc_Number')?['ID']\"},\"authentication\":\"@parameters('$authentication')\"}}},\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"cf1ba032-80e8-4fb4-98a2-78b9a8c99244\"},\"type\":\"Foreach\"},\"Delete_item_4\":{\"runAfter\":{\"Delete_Doc_Number\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"a68848cb-89fe-4508-8dac-c71847804319\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"DeleteItem\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"9139a2aa-626a-4e02-becc-60943ad79ccc\",\"id\":\"@variables('ActiveApprovalID')\"},\"authentication\":\"@parameters('$authentication')\"}},\"Delete_file_3\":{\"runAfter\":{\"Delete_item_4\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"0e93557f-1aaa-45c5-92d1-619b96627f84\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"DeleteFile\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"id\":\"@triggerOutputs()?['body/{Identifier}']\"},\"authentication\":\"@parameters('$authentication')\"}}}},\"expression\":{\"equals\":[\"@outputs('Origination_Approval')?['body/outcome']\",\"Approve\"]},\"metadata\":{\"operationMetadataId\":\"36ec1d9e-e1d6-40a6-be54-85880fc37bf1\"},\"type\":\"If\"},\"Create_ActiveApprovalID\":{\"runAfter\":{\"Create_varRevApp_(Reviewers_Approver)\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"b2a22dc7-613b-4a3d-815a-9b2ec5a0ea3e\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"ActiveApprovalID\",\"type\":\"string\"}]}},\"Set_as_Active_Approval\":{\"foreach\":\"@outputs('Doc_Number_ID_on_List')?['body/value']\",\"actions\":{\"Create_Active_Approval_Originator\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"f92ccadb-cb4b-4821-9791-d263b886088f\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"PostItem\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"9139a2aa-626a-4e02-becc-60943ad79ccc\",\"item/Title\":\"@triggerOutputs()?['body/{Name}']\",\"item/Status\":\"Awaiting Originator Approval\",\"item/Division\":\"@triggerOutputs()?['body/GroteDivision/Value']\",\"item/Process\":\"@triggerOutputs()?['body/GroteProcess/Value']\"},\"authentication\":\"@parameters('$authentication')\"}},\"Set_ActiveApprovalID\":{\"runAfter\":{\"Create_Active_Approval_Originator\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"ee3218d0-277f-445c-a6f0-d961de0d4b68\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"ActiveApprovalID\",\"value\":\"@{outputs('Create_Active_Approval_Originator')?['body/ID']}\"}}},\"runAfter\":{\"Doc_Number_ID_on_List\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"60e0fb4f-1f5c-4fd7-9375-3bdfdc423fe0\"},\"type\":\"Foreach\"},\"Doc_Number_ID_on_List\":{\"runAfter\":{\"Get_file_metadata\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"3aa36c5c-1b45-47bb-86af-ce0bf03ae84c\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"GetItems\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"66953198-05c9-40f9-bdfa-e0744efc90cc\",\"$filter\":\"(Title eq '@{triggerOutputs()?['body/GroteDivision/Value']}') and (Process eq '@{triggerOutputs()?['body/GroteProcess/Value']}') and (DocNumber eq '@{triggerOutputs()?['body/GroteDocumentShortDescription']}')\"},\"authentication\":\"@parameters('$authentication')\"}},\"Timeout_Retrigger\":{\"runAfter\":{\"Origination_Approval\":[\"TimedOut\"]},\"metadata\":{\"operationMetadataId\":\"c3ef2ab9-8e01-483d-ad31-199fc344159d\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"PostItem\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"4c86833c-1920-4dda-bdf8-c86549312eff\",\"item/Title\":\"@triggerOutputs()?['body/{Name}']\",\"item/DocumentName\":\"@triggerOutputs()?['body/GroteDocumentDescription']\",\"item/StartedBy\":\"@variables('varOriginator')\",\"item/DocumentType\":\"@triggerOutputs()?['body/GroteDocumentType/Value']\",\"item/RetriggerType\":\"Modify\",\"item/CurrentStageWaiting\":\"Originate\",\"item/Division\":\"@triggerOutputs()?['body/GroteDivision/Value']\",\"item/Process\":\"@triggerOutputs()?['body/GroteProcess/Value']\",\"item/DocumentNumber\":\"@triggerOutputs()?['body/GroteDocumentShortDescription']\",\"item/ItemID\":\"@triggerOutputs()?['body/ID']\",\"item/ETag\":\"@outputs('Get_file_metadata')?['body/ETag']\",\"item/ApprovalID\":\"@outputs('Origination_Approval')?['body/name']\"},\"authentication\":\"@parameters('$authentication')\"}}}}},\"schemaVersion\":\"1.0.0.0\"}","createdBy":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","modifiedBy":"cea9be8a-91c2-eb11-8235-0022481d5f87","ownerId":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","owningBusinessUnit":"ee0a9aec-b63d-e911-a81c-000d3a11eefe","owningUser":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff"},{"name":"GDMS_UserLang","createdOn":"2023-07-31T15:13:43Z","modifiedOn":"2023-11-21T17:54:11Z","workflowId":"61421dd6-b42f-ee11-bdf3-000d3a1b983d","resourceId":"e8f3038e-7ff9-4c48-b727-a188539c0283","stateCode":"Published","statusCode":"Published","definition":"{\"properties\":{\"connectionReferences\":{\"shared_sharepointonline\":{\"runtimeSource\":\"invoker\",\"connection\":{\"connectionReferenceLogicalName\":\"spo_sharedsharepointonline_e3ac5\"},\"api\":{\"name\":\"shared_sharepointonline\"}}},\"definition\":{\"$schema\":\"https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"$connections\":{\"defaultValue\":{},\"type\":\"Object\"},\"$authentication\":{\"defaultValue\":{},\"type\":\"SecureObject\"}},\"triggers\":{\"manual\":{\"metadata\":{\"operationMetadataId\":\"488952fa-e87f-4be0-bbad-7d38620e56f5\"},\"type\":\"Request\",\"kind\":\"PowerAppV2\",\"inputs\":{\"schema\":{\"type\":\"object\",\"properties\":{\"text\":{\"title\":\"UserEmail\",\"type\":\"string\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter your input\",\"x-ms-content-hint\":\"TEXT\"},\"text_1\":{\"title\":\"Language\",\"type\":\"string\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter your input\",\"x-ms-content-hint\":\"TEXT\"}},\"required\":[\"text\",\"text_1\"]}}}},\"actions\":{\"UserEmail\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"3ce09b5c-ab39-4269-9fc5-c6a303fe2afd\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"UserEmail\",\"type\":\"string\"}]}},\"Language\":{\"runAfter\":{\"UserEmail\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"ee3e9664-5b00-493d-af3b-900064e8d28a\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"Language\",\"type\":\"string\"}]}},\"Get_items\":{\"runAfter\":{\"OutputLanguage\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"862c464d-eca0-43be-a34a-0358e80beb16\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"GetItems\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"08f2d82c-58b8-4a0d-becb-cd2ce6f73780\",\"$filter\":\"(Title eq '@{triggerBody()['text']}')\"},\"authentication\":\"@parameters('$authentication')\"}},\"Condition\":{\"actions\":{},\"runAfter\":{\"Apply_to_each_3\":[\"Succeeded\"]},\"else\":{\"actions\":{\"Apply_to_each_2\":{\"foreach\":\"@outputs('Get_items')?['body/value']\",\"actions\":{\"Update_item\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"8c021b9a-a0ae-44cb-adac-6c61b0a7433a\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"PatchItem\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"08f2d82c-58b8-4a0d-becb-cd2ce6f73780\",\"id\":\"@items('Apply_to_each_2')?['ID']\",\"item/Language\":\"@triggerBody()['text_1']\"},\"authentication\":\"@parameters('$authentication')\"}}},\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"426f3e51-5b47-49f4-b253-aa0d72257ead\"},\"type\":\"Foreach\"}}},\"expression\":{\"equals\":[\"@triggerBody()['text_1']\",\"\"]},\"metadata\":{\"operationMetadataId\":\"a27ae71d-9b72-40d7-9ac6-29ce6cd26fd6\"},\"type\":\"If\"},\"OutputLanguage\":{\"runAfter\":{\"Language\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"2a0fefce-2845-4cfc-a73c-9002450610a7\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"OutputLanguage\",\"type\":\"string\"}]}},\"Condition_2\":{\"actions\":{\"Create_item\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"bd0655fd-c15b-484d-88eb-8eae49b49f8a\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"PostItem\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"08f2d82c-58b8-4a0d-becb-cd2ce6f73780\",\"item/Title\":\"@triggerBody()['text']\",\"item/Language\":\"en-US\"},\"authentication\":\"@parameters('$authentication')\"}},\"Set_variable\":{\"runAfter\":{\"Create_item\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"e4c1bb24-7c79-4f8f-9952-fda88d166a91\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"OutputLanguage\",\"value\":\"@outputs('Create_item')?['body/Language']\"}}},\"runAfter\":{\"Condition\":[\"Succeeded\"]},\"expression\":{\"equals\":[\"@variables('OutputLanguage')\",\"\"]},\"metadata\":{\"operationMetadataId\":\"721a6ec1-095a-4878-8f65-3ea999764b4c\"},\"type\":\"If\"},\"Apply_to_each_3\":{\"foreach\":\"@outputs('Get_items')?['body/value']\",\"actions\":{\"Set_variable_3\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"123866d9-db67-43f7-a756-9c8372967e75\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"OutputLanguage\",\"value\":\"@items('Apply_to_each_3')?['Language']\"}}},\"runAfter\":{\"Get_items\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"850dd802-eab8-4f47-be6e-492fc5305323\"},\"type\":\"Foreach\"},\"Respond_to_a_PowerApp_or_flow\":{\"runAfter\":{\"Condition_2\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"6c03dc5a-2331-4292-ba0f-9aaf7aa0ad40\"},\"type\":\"Response\",\"kind\":\"PowerApp\",\"inputs\":{\"statusCode\":200,\"body\":{\"varuserlang\":\"@variables('OutputLanguage')\"},\"schema\":{\"type\":\"object\",\"properties\":{\"varuserlang\":{\"title\":\"varUserLang\",\"x-ms-dynamically-added\":true,\"type\":\"string\"}}}}}}},\"templateName\":\"\"},\"schemaVersion\":\"1.0.0.0\"}","createdBy":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","modifiedBy":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","ownerId":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","owningBusinessUnit":"ee0a9aec-b63d-e911-a81c-000d3a11eefe","owningUser":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff"},{"name":"GDMS_Reviewer","createdOn":"2023-07-31T04:02:34Z","modifiedOn":"2023-11-21T17:51:30Z","workflowId":"7a3a6211-572f-ee11-bdf3-000d3a1b983d","resourceId":"5ff66570-9db5-4082-bdcf-90f4809ef506","stateCode":"Published","statusCode":"Published","definition":"{\"properties\":{\"connectionReferences\":{\"shared_approvals_1\":{\"runtimeSource\":\"embedded\",\"connection\":{\"connectionReferenceLogicalName\":\"spo_sharedapprovals_4eb02\"},\"api\":{\"name\":\"shared_approvals\"}},\"shared_sharepointonline_1\":{\"runtimeSource\":\"embedded\",\"connection\":{\"connectionReferenceLogicalName\":\"spo_sharedsharepointonline_e3ac5\"},\"api\":{\"name\":\"shared_sharepointonline\"}},\"shared_office365\":{\"runtimeSource\":\"embedded\",\"connection\":{\"connectionReferenceLogicalName\":\"spo_sharedoffice365_5e3dc\"},\"api\":{\"name\":\"shared_office365\"}}},\"definition\":{\"$schema\":\"https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"$connections\":{\"defaultValue\":{},\"type\":\"Object\"},\"$authentication\":{\"defaultValue\":{},\"type\":\"SecureObject\"}},\"triggers\":{\"When_an_item_is_created_or_modified\":{\"recurrence\":{\"interval\":1,\"frequency\":\"Minute\"},\"splitOn\":\"@triggerOutputs()?['body/value']\",\"metadata\":{\"operationMetadataId\":\"bf218889-03a3-4331-a6a9-c370961f6ab3\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline_1\",\"operationId\":\"GetOnUpdatedItems\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"3f960b78-8bab-42f1-a5d4-fa18072ad762\"},\"authentication\":\"@parameters('$authentication')\"},\"conditions\":[{\"expression\":\"@equals(triggerBody()?['Stage'], 'Review')\"}]}},\"actions\":{\"ReviewerEmail\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"8af29c0a-eb73-40b1-8a48-d62e8a0d7a52\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"ReviewerEmail\",\"type\":\"string\",\"value\":\"@triggerOutputs()?['body/Reviewer']\"}]}},\"Wait_for_an_approval\":{\"runAfter\":{\"Condition\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"2a4baf17-a339-4e31-851a-4180a854ba7e\"},\"type\":\"OpenApiConnectionWebhook\",\"inputs\":{\"host\":{\"connectionName\":\"shared_approvals_1\",\"operationId\":\"WaitForAnApproval\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_approvals\"},\"parameters\":{\"approvalName\":\"@variables('ApprovalID')\"},\"authentication\":\"@parameters('$authentication')\"}},\"Outcome_of_Reviewer_Approval\":{\"actions\":{\"Update_item\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"60307c31-3370-4b20-b24f-c167de29db8f\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline_1\",\"operationId\":\"PatchItem\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"3f960b78-8bab-42f1-a5d4-fa18072ad762\",\"id\":\"@triggerBody()?['ID']\",\"item/Stage\":\"Approval\"},\"authentication\":\"@parameters('$authentication')\"}}},\"runAfter\":{\"Wait_for_an_approval\":[\"Succeeded\"]},\"else\":{\"actions\":{\"Get_items\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"c31ea62a-ab57-432e-a5e1-b55df99eabfd\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline_1\",\"operationId\":\"GetItems\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"66953198-05c9-40f9-bdfa-e0744efc90cc\",\"$filter\":\"(Division eq '@{triggerBody()?['Division']}') and (Process eq '@{triggerBody()?['Process']}') and (Number eq '@{triggerBody()?['Number']}')\"},\"authentication\":\"@parameters('$authentication')\"}},\"For_each\":{\"foreach\":\"@outputs('Get_items')?['body/value']\",\"actions\":{\"Delete_item\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"38745ed6-2963-4763-b4e6-aba91ca360bc\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline_1\",\"operationId\":\"DeleteItem\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"66953198-05c9-40f9-bdfa-e0744efc90cc\",\"id\":\"@items('For_each')?['ID']\"},\"authentication\":\"@parameters('$authentication')\"}}},\"runAfter\":{\"Get_items\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"bf2a0d84-75af-4f93-9ae1-33f8faf65325\"},\"type\":\"Foreach\"},\"Send_an_email_(V2)_1\":{\"runAfter\":{\"For_each\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"85c5aff2-c440-4a88-a80a-51fbf2df318f\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_office365\",\"operationId\":\"SendEmailV2\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_office365\"},\"parameters\":{\"emailMessage/To\":\"@triggerBody()?['Originator']\",\"emailMessage/Subject\":\"GDMS | Document Rejected\",\"emailMessage/Body\":\"<p><i><em>Please do not reply, this is an automated message and responses to this email will not be monitored.</em></i></p><p><br></p><p>Your document, @{triggerBody()?['Title']} | @{triggerBody()?['Descripton']}, has been rejected.</p><p><br></p><p>Reason rejected: @{body('Wait_for_an_approval')?['responseSummary']}<span>\\n</span></p>\",\"emailMessage/Importance\":\"Normal\"},\"authentication\":\"@parameters('$authentication')\"}}}},\"expression\":{\"and\":[{\"equals\":[\"@body('Wait_for_an_approval')?['outcome']\",\"Approve\"]}]},\"metadata\":{\"operationMetadataId\":\"1092d004-d000-42e4-801c-713eb85f1d37\"},\"type\":\"If\"},\"ReviewerType\":{\"runAfter\":{\"ReviewerEmail\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"41d8f7bf-00d6-443e-b084-aa23ea26accd\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"ReviewerType\",\"type\":\"string\",\"value\":\"@triggerOutputs()?['body/ReviewerType']\"}]}},\"Condition\":{\"actions\":{\"Reviewer_Approval_-_One\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"96efc39a-e979-49aa-84bb-7e152729e854\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_approvals_1\",\"operationId\":\"CreateAnApproval\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_approvals\"},\"parameters\":{\"approvalType\":\"BasicAwaitAll\",\"ApprovalCreationInput/title\":\"GDMS | Document Review | @{triggerBody()?['Title']}\",\"ApprovalCreationInput/assignedTo\":\"@triggerBody()?['Reviewer']\",\"ApprovalCreationInput/details\":\"**Grote Document Management System**\\n_You have a new originated document to approve._\\n\\n**Name:** @{triggerBody()?['Title']} | @{triggerBody()?['Descripton']}\\n**Originated By:** @{triggerBody()?['OriginatorName']}\\n**Document Type:** @{triggerBody()?['DocumentType']}\\n**Division:** @{triggerBody()?['Division']}\\n**Process:**   @{triggerBody()?['Process']}\",\"ApprovalCreationInput/itemLink\":\"@triggerBody()?['DocumentLink']\",\"ApprovalCreationInput/itemLinkDescription\":\"View document\",\"ApprovalCreationInput/requestor\":\"@triggerBody()?['Originator']\",\"ApprovalCreationInput/enableNotifications\":false,\"ApprovalCreationInput/enableReassignment\":false},\"authentication\":\"@parameters('$authentication')\"}},\"Send_an_email_(V2)_3\":{\"runAfter\":{\"Reviewer_Approval_-_One\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"e7bb841c-4b60-404e-9fe1-ccfd62c6cf15\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_office365\",\"operationId\":\"SendEmailV2\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_office365\"},\"parameters\":{\"emailMessage/To\":\"@variables('ReviewerEmail')\",\"emailMessage/Subject\":\"GDMS | New Document to Review\",\"emailMessage/Body\":\"<p><i><em>Please do not reply, this is an automated message and responses to this email will not be monitored.</em></i></p><p><span>\\n</span></p><p>You have a new document to review. Please click the following response link or visit the <b><strong>Approvals</strong></b> section via <b><strong>Teams</strong></b> to view the request.</p><p><span>\\n</span></p><p><b><strong>Document Name:</strong></b> @{triggerBody()?['Title']} <b><strong>|</strong></b> @{triggerBody()?['Descripton']}</p><p><b><strong>Originated By: </strong></b>@{triggerBody()?['OriginatorName']}</p><p><br></p><p><b><strong>Response Link: </strong></b>@{outputs('Reviewer_Approval_-_One')?['body/respondLink']}</p><p></p>\",\"emailMessage/Importance\":\"Normal\"},\"authentication\":\"@parameters('$authentication')\"}},\"Set_ApprovalID\":{\"runAfter\":{\"Send_an_email_(V2)_3\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"16a19675-35b1-4db2-94e6-d14823cf36a8\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"ApprovalID\",\"value\":\"@outputs('Reviewer_Approval_-_One')?['body/name']\"}}},\"runAfter\":{\"ApprovalID\":[\"Succeeded\"]},\"else\":{\"actions\":{\"Reviewer_Approval_-_All\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"96efc39a-e979-49aa-84bb-7e152729e854\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_approvals_1\",\"operationId\":\"CreateAnApproval\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_approvals\"},\"parameters\":{\"approvalType\":\"BasicAwaitAll\",\"ApprovalCreationInput/title\":\"GDMS | Document Review | @{triggerBody()?['Title']}\",\"ApprovalCreationInput/assignedTo\":\"@triggerBody()?['Reviewer']\",\"ApprovalCreationInput/details\":\"**Grote Document Management System**\\n_You have a new originated document to approve._\\n\\n**Name:** @{triggerBody()?['Title']} | @{triggerBody()?['Descripton']}\\n**Originated By:** @{triggerBody()?['OriginatorName']}\\n**Document Type:** @{triggerBody()?['DocumentType']}\\n**Division:** @{triggerBody()?['Division']}\\n**Process:**   @{triggerBody()?['Process']}\",\"ApprovalCreationInput/itemLink\":\"@triggerBody()?['DocumentLink']\",\"ApprovalCreationInput/itemLinkDescription\":\"View document\",\"ApprovalCreationInput/requestor\":\"@triggerBody()?['Originator']\",\"ApprovalCreationInput/enableNotifications\":false,\"ApprovalCreationInput/enableReassignment\":false},\"authentication\":\"@parameters('$authentication')\"}},\"Send_an_email_(V2)_2\":{\"runAfter\":{\"Reviewer_Approval_-_All\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"e7bb841c-4b60-404e-9fe1-ccfd62c6cf15\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_office365\",\"operationId\":\"SendEmailV2\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_office365\"},\"parameters\":{\"emailMessage/To\":\"@variables('ReviewerEmail')\",\"emailMessage/Subject\":\"GDMS | New Document to Review\",\"emailMessage/Body\":\"<p><i><em>Please do not reply, this is an automated message and responses to this email will not be monitored.</em></i></p><p><span>\\n</span></p><p>You have a new document to review. Please click the following response link or visit the <b><strong>Approvals</strong></b> section via <b><strong>Teams</strong></b> to view the request.</p><p><span>\\n</span></p><p><b><strong>Document Name:</strong></b> @{triggerBody()?['Title']} <b><strong>|</strong></b> @{triggerBody()?['Descripton']}</p><p><b><strong>Originated By: </strong></b>@{triggerBody()?['OriginatorName']}</p><p><br></p><p><b><strong>Response Link: </strong></b>@{outputs('Reviewer_Approval_-_All')?['body/respondLink']}</p><p></p>\",\"emailMessage/Importance\":\"Normal\"},\"authentication\":\"@parameters('$authentication')\"}},\"Set_ApprovalID_2\":{\"runAfter\":{\"Send_an_email_(V2)_2\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"14004973-106f-41f5-8f97-905e9b7ca794\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"ApprovalID\",\"value\":\"@outputs('Reviewer_Approval_-_All')?['body/name']\"}}}},\"expression\":{\"equals\":[\"@variables('ReviewerType')\",\"One\"]},\"metadata\":{\"operationMetadataId\":\"8211839b-4644-42f6-9b70-105853da3b3d\"},\"type\":\"If\"},\"ApprovalID\":{\"runAfter\":{\"ReviewerType\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"65157465-c7a2-410d-bd86-a622f8a42115\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"ApprovalID\",\"type\":\"string\"}]}}},\"outputs\":{}},\"templateName\":\"\"},\"schemaVersion\":\"1.0.0.0\"}","createdBy":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","modifiedBy":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","ownerId":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","owningBusinessUnit":"ee0a9aec-b63d-e911-a81c-000d3a11eefe","owningUser":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff"},{"name":"GDMS_DocNumberGet","createdOn":"2023-07-31T17:09:44Z","modifiedOn":"2023-11-21T14:10:44Z","workflowId":"78edd60a-c52f-ee11-bdf3-000d3a1b983d","resourceId":"3645145c-7d2d-40d7-b5d5-8b3b96a897d3","stateCode":"Published","statusCode":"Published","definition":"{\"properties\":{\"connectionReferences\":{\"shared_sharepointonline_1\":{\"runtimeSource\":\"invoker\",\"connection\":{\"connectionReferenceLogicalName\":\"spo_sharedsharepointonline_e3ac5\"},\"api\":{\"name\":\"shared_sharepointonline\"}}},\"definition\":{\"$schema\":\"https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"$connections\":{\"defaultValue\":{},\"type\":\"Object\"},\"$authentication\":{\"defaultValue\":{},\"type\":\"SecureObject\"}},\"triggers\":{\"manual\":{\"metadata\":{\"operationMetadataId\":\"9f5ed8e8-256f-44df-8489-5b3a2605ed3a\"},\"type\":\"Request\",\"kind\":\"PowerAppV2\",\"inputs\":{\"schema\":{\"type\":\"object\",\"properties\":{\"text\":{\"title\":\"Division\",\"type\":\"string\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter your input\",\"x-ms-content-hint\":\"TEXT\"},\"text_1\":{\"title\":\"Process\",\"type\":\"string\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter your input\",\"x-ms-content-hint\":\"TEXT\"}},\"required\":[\"text\",\"text_1\"]}}}},\"actions\":{\"Create_NextDocNumber\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"f027dc2d-f4c6-4782-a1ba-305bbcc9dd04\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"NextDocNumber\",\"type\":\"string\"}]}},\"Get_items\":{\"runAfter\":{\"Initialize_variable_2\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"279540aa-fa2d-417b-b309-3a87c1bb541d\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline_1\",\"operationId\":\"GetItems\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"66953198-05c9-40f9-bdfa-e0744efc90cc\",\"$filter\":\"(Title eq '@{triggerBody()['text']}') and (Process eq '@{triggerBody()['text_1']}') and (DocNumber gt '@{variables('StartNum')}') and (DocNumber lt '@{variables('EndNum')}')\"},\"authentication\":\"@parameters('$authentication')\"}},\"Create_Division\":{\"runAfter\":{\"Create_NextDocNumber\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"5f75d9f2-8928-4c49-b584-b2609d4f7e59\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"Division\",\"type\":\"string\"}]}},\"Create_Process\":{\"runAfter\":{\"Create_Division\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"22b5074d-3947-434f-b82e-cb729bf1581d\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"Process\",\"type\":\"string\"}]}},\"Get_Start\":{\"runAfter\":{\"testdocnum\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"74fb0b7c-91a1-4fef-81d0-e5d3c65ad347\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline_1\",\"operationId\":\"GetItems\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"66953198-05c9-40f9-bdfa-e0744efc90cc\",\"$filter\":\"(Title eq '@{triggerBody()['text']}') and (Process eq '@{triggerBody()['text_1']}') and (Start_x002f_End eq 'Start')\"},\"authentication\":\"@parameters('$authentication')\"}},\"Get_End\":{\"runAfter\":{\"Add_StartNum_and_1_to_NumCheck\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"f9f60f87-3422-497a-89c8-8dd375d8509a\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline_1\",\"operationId\":\"GetItems\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"66953198-05c9-40f9-bdfa-e0744efc90cc\",\"$filter\":\"(Title eq '@{triggerBody()['text']}') and (Process eq '@{triggerBody()['text_1']}') and (Start_x002f_End eq 'End')\"},\"authentication\":\"@parameters('$authentication')\"}},\"Start\":{\"foreach\":\"@outputs('Get_Start')?['body/value']\",\"actions\":{\"Set_StartNum\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"ed3389b9-e169-4c60-89ae-98e92ef0ded4\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"StartNum\",\"value\":\"@items('Start')?['DocNumber']\"}}},\"runAfter\":{\"Get_Start\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"1d55b183-9d5b-4a1d-9e72-9699c74cbd1d\"},\"type\":\"Foreach\"},\"End\":{\"foreach\":\"@outputs('Get_End')?['body/value']\",\"actions\":{\"Set_EndNum\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"bbc6ecca-7a33-4bf1-aa31-934bb28f404c\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"EndNum\",\"value\":\"@items('End')?['DocNumber']\"}}},\"runAfter\":{\"Get_End\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"939da1a9-9886-4f7a-ad0a-6b1754637809\"},\"type\":\"Foreach\"},\"StartNum\":{\"runAfter\":{\"Create_Process\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"cda2f2b8-eb67-4100-929b-7deda765df90\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"StartNum\",\"type\":\"string\"}]}},\"EndNum\":{\"runAfter\":{\"NumCheck\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"79ef9e24-1e39-4976-8cc3-ab66073722c8\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"EndNum\",\"type\":\"string\"}]}},\"NumCheck\":{\"runAfter\":{\"StartNum\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"5bcca5d4-0c78-4928-867e-05337516a0d7\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"NumCheck\",\"type\":\"integer\"}]}},\"Add_StartNum_and_1_to_NumCheck\":{\"runAfter\":{\"Start\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"6bb61289-9915-4c9f-9cc0-f9a46d0604df\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"NumCheck\",\"value\":\"@add(int(variables('StartNum')),1)\"}},\"testdocnum\":{\"runAfter\":{\"EndNum\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"116ff70f-21fb-42dc-b1f1-48729ed693b1\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"testdocnum\",\"type\":\"string\",\"value\":\"0\"}]}},\"Initialize_variable_2\":{\"runAfter\":{\"Compose\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"6fa1226a-dc9b-4da8-b469-179d213f5341\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"inttestdocnum\",\"type\":\"integer\",\"value\":\"@outputs('Compose')\"}]}},\"Compose\":{\"runAfter\":{\"End\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"caa32317-18d0-4e43-a092-156d2f43227d\"},\"type\":\"Compose\",\"inputs\":\"@int(variables('testdocnum'))\"},\"Do_for_each_Item_in_DocNum_area\":{\"foreach\":\"@outputs('Get_items')?['body/value']\",\"actions\":{\"Condition\":{\"actions\":{},\"runAfter\":{},\"else\":{\"actions\":{\"If_no_available_nums\":{\"actions\":{},\"runAfter\":{},\"else\":{\"actions\":{\"If_num_exist\":{\"actions\":{\"Increment_variable\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"76c39e59-719a-4673-930b-a6f92020e325\"},\"type\":\"IncrementVariable\",\"inputs\":{\"name\":\"NumCheck\",\"value\":1}}},\"runAfter\":{},\"else\":{\"actions\":{\"Set_variable_2\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"1a117597-93a4-480c-ad53-04534d9f4317\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"testdocnum\",\"value\":\"@items('Do_for_each_Item_in_DocNum_area')?['DocNumber']\"}}}},\"expression\":{\"equals\":[\"@items('Do_for_each_Item_in_DocNum_area')?['DocNumber']\",\"@variables('NumCheck')\"]},\"metadata\":{\"operationMetadataId\":\"0ebbc8eb-8207-46c1-9e15-371251ebfec7\"},\"type\":\"If\"}}},\"expression\":{\"equals\":[\"@variables('NumCheck')\",\"@variables('EndNum')\"]},\"metadata\":{\"operationMetadataId\":\"2eec57df-4eb5-4291-afbc-5d18a2a75451\"},\"type\":\"If\"}}},\"expression\":{\"greater\":[\"@variables('inttestdocnum')\",0]},\"metadata\":{\"operationMetadataId\":\"c25d6840-de1b-4faf-ad3b-c4d08d23b7a2\"},\"type\":\"If\"}},\"runAfter\":{\"Get_items\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"b684a411-d9aa-4a66-a34c-7839e606e58e\"},\"type\":\"Foreach\"},\"Respond_to_a_PowerApp_or_flow\":{\"runAfter\":{\"Do_for_each_Item_in_DocNum_area\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"e78b8316-c165-4710-9233-15daaa8b4e68\"},\"type\":\"Response\",\"kind\":\"PowerApp\",\"inputs\":{\"statusCode\":200,\"body\":{\"nextdocnumber\":\"@variables('testdocnum')\"},\"schema\":{\"type\":\"object\",\"properties\":{\"nextdocnumber\":{\"title\":\"NextDocNumber\",\"x-ms-dynamically-added\":true,\"type\":\"string\"}}}}}}},\"templateName\":\"\"},\"schemaVersion\":\"1.0.0.0\"}","createdBy":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","modifiedBy":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","ownerId":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","owningBusinessUnit":"ee0a9aec-b63d-e911-a81c-000d3a11eefe","owningUser":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff"},{"name":"GDMS_DocNumberChk","createdOn":"2023-07-31T16:39:57Z","modifiedOn":"2023-11-21T14:04:33Z","workflowId":"deebbbe1-c02f-ee11-bdf3-000d3a1b983d","resourceId":"7aad6cda-4fcc-4b0d-ac08-a9f01d6c5d7f","stateCode":"Published","statusCode":"Published","definition":"{\"properties\":{\"connectionReferences\":{\"shared_sharepointonline_1\":{\"runtimeSource\":\"invoker\",\"connection\":{\"connectionReferenceLogicalName\":\"spo_sharedsharepointonline_e3ac5\"},\"api\":{\"name\":\"shared_sharepointonline\"}}},\"definition\":{\"$schema\":\"https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"$connections\":{\"defaultValue\":{},\"type\":\"Object\"},\"$authentication\":{\"defaultValue\":{},\"type\":\"SecureObject\"}},\"triggers\":{\"manual\":{\"metadata\":{\"operationMetadataId\":\"57e5d669-13e3-4c50-a4b6-6d32965ea117\"},\"type\":\"Request\",\"kind\":\"PowerAppV2\",\"inputs\":{\"schema\":{\"type\":\"object\",\"properties\":{\"text\":{\"title\":\"Division\",\"type\":\"string\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter your input\",\"x-ms-content-hint\":\"TEXT\"},\"text_1\":{\"title\":\"Process\",\"type\":\"string\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter your input\",\"x-ms-content-hint\":\"TEXT\"},\"text_2\":{\"title\":\"RequestedDocNum\",\"type\":\"string\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter your input\",\"x-ms-content-hint\":\"TEXT\"}},\"required\":[\"text\",\"text_1\",\"text_2\"]}}}},\"actions\":{\"Response\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"e4fe1e2b-06ec-42c1-91ed-79494c4ccf00\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"Response\",\"type\":\"string\"}]}},\"StartNum\":{\"runAfter\":{\"Response\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"3847fc20-0d1d-4546-8f20-c98c283ad3c2\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"StartNum\",\"type\":\"string\"}]}},\"EndNum\":{\"runAfter\":{\"StartNum\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"61135042-2645-4835-9b68-a542bbbc2d21\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"EndNum\",\"type\":\"string\"}]}},\"Get_Start\":{\"runAfter\":{\"EndNum\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"78f123a8-e8af-4ab1-b123-41dc566f16c4\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline_1\",\"operationId\":\"GetItems\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"66953198-05c9-40f9-bdfa-e0744efc90cc\",\"$filter\":\"(Title eq '@{triggerBody()['text']}') and (Process eq '@{triggerBody()['text_1']}') and (Start_x002f_End eq 'Start')\"},\"authentication\":\"@parameters('$authentication')\"}},\"Start\":{\"foreach\":\"@outputs('Get_Start')?['body/value']\",\"actions\":{\"Set_StartNum\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"5bf84dd2-e9ce-4a0f-9800-54fbe75cd883\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"StartNum\",\"value\":\"@items('Start')?['DocNumber']\"}}},\"runAfter\":{\"Get_Start\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"622e8542-e423-4952-8e01-0e1f1def4a79\"},\"type\":\"Foreach\"},\"Get_End\":{\"runAfter\":{\"Start\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"1a2b57c5-85e9-4dea-842d-4a5a762eb54a\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline_1\",\"operationId\":\"GetItems\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"66953198-05c9-40f9-bdfa-e0744efc90cc\",\"$filter\":\"(Title eq '@{triggerBody()['text']}') and (Process eq '@{triggerBody()['text_1']}') and (Start_x002f_End eq 'End')\"},\"authentication\":\"@parameters('$authentication')\"}},\"End\":{\"foreach\":\"@outputs('Get_End')?['body/value']\",\"actions\":{\"Set_EndNum\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"bd29a58e-9cee-433b-ae68-2f8fb1e5cc6f\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"EndNum\",\"value\":\"@items('End')?['DocNumber']\"}}},\"runAfter\":{\"Get_End\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"88f3837b-8483-4291-81cb-8ab2286e58f2\"},\"type\":\"Foreach\"},\"Get_items\":{\"runAfter\":{\"End\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"2b182798-2da1-4768-be69-30717292c0a6\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline_1\",\"operationId\":\"GetItems\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"66953198-05c9-40f9-bdfa-e0744efc90cc\",\"$filter\":\"(Title eq '@{triggerBody()['text']}') and (Process eq '@{triggerBody()['text_1']}') and (DocNumber gt '@{variables('StartNum')}') and (DocNumber lt '@{variables('EndNum')}')\"},\"authentication\":\"@parameters('$authentication')\"}},\"Select\":{\"runAfter\":{\"Get_items\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"279782cb-4006-4fa6-b052-bbeb9161e9e3\"},\"type\":\"Select\",\"inputs\":{\"from\":\"@outputs('Get_items')?['body/value']\",\"select\":\"@item()?['DocNumber']\"}},\"Condition\":{\"actions\":{\"Set_variable\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"981eb273-feec-46b7-853d-880934e2a965\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"Response\",\"value\":\"used\"}}},\"runAfter\":{\"Select\":[\"Succeeded\"]},\"else\":{\"actions\":{\"Set_variable_2\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"f64835c5-f40f-491e-9aac-1e4e76efd8cb\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"Response\",\"value\":\"free\"}}}},\"expression\":{\"contains\":[\"@body('Select')\",\"@triggerBody()['text_2']\"]},\"metadata\":{\"operationMetadataId\":\"fa83819f-a3a1-4c9f-b901-980246901006\"},\"type\":\"If\"},\"Respond_to_a_PowerApp_or_flow\":{\"runAfter\":{\"Condition\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"73dbd496-b5f4-4b44-b4d7-5227b9d2e01d\"},\"type\":\"Response\",\"kind\":\"PowerApp\",\"inputs\":{\"statusCode\":200,\"body\":{\"response\":\"@variables('Response')\"},\"schema\":{\"type\":\"object\",\"properties\":{\"response\":{\"title\":\"response\",\"x-ms-dynamically-added\":true,\"type\":\"string\"}}}}}}},\"templateName\":\"\"},\"schemaVersion\":\"1.0.0.0\"}","createdBy":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","modifiedBy":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","ownerId":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","owningBusinessUnit":"ee0a9aec-b63d-e911-a81c-000d3a11eefe","owningUser":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff"},{"name":"GDMS_Created","createdOn":"2023-07-31T04:02:26Z","modifiedOn":"2023-11-21T00:56:30Z","workflowId":"6eee690b-572f-ee11-bdf3-000d3a1b983d","resourceId":"49b1e39a-dc84-492f-8b48-323db980b59a","stateCode":"Published","statusCode":"Published","definition":"{\"properties\":{\"connectionReferences\":{\"shared_sharepointonline\":{\"runtimeSource\":\"embedded\",\"connection\":{\"connectionReferenceLogicalName\":\"spo_sharedsharepointonline_e3ac5\"},\"api\":{\"name\":\"shared_sharepointonline\"}}},\"definition\":{\"$schema\":\"https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"$authentication\":{\"defaultValue\":{},\"type\":\"SecureObject\"},\"$connections\":{\"defaultValue\":{},\"type\":\"Object\"}},\"triggers\":{\"When_a_GDMS_Document_is_created\":{\"recurrence\":{\"frequency\":\"Minute\",\"interval\":1},\"splitOn\":\"@triggerOutputs()?['body/value']\",\"metadata\":{\"operationMetadataId\":\"737ba3d6-6270-4699-bde4-c4ddc8fd4e8d\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"bc460a20-664c-49e7-bfe7-2843495da717\"},\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"operationId\":\"GetOnNewFileItems\",\"connectionName\":\"shared_sharepointonline\"}}}},\"actions\":{\"Create_item_in_ApprovalInfo\":{\"runAfter\":{\"Create_Distribution_List\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"8a65251a-f299-4d77-ac5f-b1f308f62a58\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"3f960b78-8bab-42f1-a5d4-fa18072ad762\",\"item/Title\":\"@triggerOutputs()?['body/{Name}']\",\"item/Number\":\"@triggerOutputs()?['body/GroteDocumentShortDescription']\",\"item/Descripton\":\"@triggerBody()?['GroteDocumentDescription']\",\"item/DocumentType\":\"@triggerOutputs()?['body/GroteDocumentType/Value']\",\"item/Division\":\"@triggerOutputs()?['body/GroteDivision/Value']\",\"item/Process\":\"@triggerOutputs()?['body/GroteProcess/Value']\",\"item/Stage\":\"Origination\",\"item/OriginatorName\":\"@triggerOutputs()?['body/OriginatorName']\",\"item/Originator\":\"@triggerOutputs()?['body/OriginatorEmail']\",\"item/Approver\":\"@variables('ApproversList')\",\"item/Reviewer\":\"@variables('ReviewersList')\",\"item/Distribution\":\"@variables('DistributionList')\",\"item/DocumentLink\":\"@triggerOutputs()?['body/{Link}']\",\"item/DocID\":\"@triggerOutputs()?['body/ID']\",\"item/Reason\":\"@triggerOutputs()?['body/GroteRecentChangesReason']\",\"item/UploadType\":\"@triggerOutputs()?['body/Upload_x0020_Type']\"},\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"operationId\":\"PostItem\",\"connectionName\":\"shared_sharepointonline\"}}},\"Get_OARD\":{\"runAfter\":{\"DistributionList\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"4adb989d-3219-4f9e-ad91-a87ed42a5bd9\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"8817a49e-b48d-4634-9918-1c7716a2d1e5\",\"$filter\":\"(Location eq '@{triggerBody()?['GroteDivision']?['Value']}') and (Process eq '@{triggerBody()?['GroteProcess']?['Value']}')\"},\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"operationId\":\"GetItems\",\"connectionName\":\"shared_sharepointonline\"}}},\"Create_Approvers_List\":{\"foreach\":\"@outputs('Get_OARD')?['body/value']\",\"actions\":{\"Select_Approvers\":{\"metadata\":{\"operationMetadataId\":\"9ebb034e-9fa1-4fde-974f-fec066ca5fc7\"},\"type\":\"Select\",\"inputs\":{\"from\":\"@items('Create_Approvers_List')?['Approvers']\",\"select\":\"@item()?['Email']\"}},\"Join_Approvers\":{\"runAfter\":{\"Select_Approvers\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"f6847035-fe24-4ff7-b09f-cce8865d32ab\"},\"type\":\"Join\",\"inputs\":{\"from\":\"@body('Select_Approvers')\",\"joinWith\":\";\"}},\"Set_ApproversList\":{\"runAfter\":{\"Join_Approvers\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"6950e687-b3bc-4a4e-b54b-e0ff2e3895b5\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"ApproversList\",\"value\":\"@body('Join_Approvers')\"}}},\"runAfter\":{\"Get_OARD\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"bce855cc-c345-48bc-8540-3c90fbb669d4\"},\"type\":\"Foreach\"},\"ApproversList\":{\"runAfter\":{\"Start_content_approval_status\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"89df1aed-5aa3-4ff3-98b1-a9e89d17cd0c\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"ApproversList\",\"type\":\"string\"}]}},\"ReviewersList\":{\"runAfter\":{\"ApproversList\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"3a41e865-b617-4d64-955a-c05148e12ba7\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"ReviewersList\",\"type\":\"string\"}]}},\"DistributionList\":{\"runAfter\":{\"ReviewersList\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"3c22f79b-f736-4a07-8f9e-29f30388a5b8\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"DistributionList\",\"type\":\"string\"}]}},\"Create_Distribution_List\":{\"foreach\":\"@outputs('Get_OARD')?['body/value']\",\"actions\":{\"Select_Distributors\":{\"metadata\":{\"operationMetadataId\":\"1049b1f2-fcad-4071-bfa1-c2d534cd4795\"},\"type\":\"Select\",\"inputs\":{\"from\":\"@items('Create_Distribution_List')?['Distribution']\",\"select\":\"@item()?['Email']\"}},\"Join_Distributors\":{\"runAfter\":{\"Select_Distributors\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"ba2bf1d4-31a5-4545-9f40-c4bcacab1ff2\"},\"type\":\"Join\",\"inputs\":{\"from\":\"@body('Select_Distributors')\",\"joinWith\":\";\"}},\"Set_Distributors\":{\"runAfter\":{\"Join_Distributors\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"3321bcc7-600c-44d1-a5ea-71a30f1dea20\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"DistributionList\",\"value\":\"@body('Join_Distributors')\"}}},\"runAfter\":{\"Create_Reviewers_List\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"dd1c9a3c-70d2-4f14-94d9-b0b5bcd83dd4\"},\"type\":\"Foreach\"},\"Get_file_metadata\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"0309b246-a867-4e91-a11a-652a440f9519\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"id\":\"@triggerBody()?['{Identifier}']\"},\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"operationId\":\"GetFileMetadata\",\"connectionName\":\"shared_sharepointonline\"}}},\"Start_content_approval_status\":{\"runAfter\":{\"Get_file_metadata\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"428ad0d6-a58b-4212-b72a-a924fa85ec69\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"bc460a20-664c-49e7-bfe7-2843495da717\",\"id\":\"@outputs('Get_file_metadata')?['body/ItemId']\",\"approvalAction\":\"Submit\",\"comments\":\"\",\"entityTag\":\"@outputs('Get_file_metadata')?['body/ETag']\"},\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"operationId\":\"SetApprovalStatus\",\"connectionName\":\"shared_sharepointonline\"}}},\"Create_Reviewers_List\":{\"foreach\":\"@outputs('Get_OARD')?['body/value']\",\"actions\":{\"Select_Reviewers\":{\"metadata\":{\"operationMetadataId\":\"a95804f8-a5d9-4fa5-8942-0be0b11f962f\"},\"type\":\"Select\",\"inputs\":{\"from\":\"@items('Create_Reviewers_List')?['Reviewers']\",\"select\":\"@item()?['Email']\"}},\"Join_Reviewers\":{\"runAfter\":{\"Select_Reviewers\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"4b413e81-8335-432a-8b8c-500dee29527f\"},\"type\":\"Join\",\"inputs\":{\"from\":\"@body('Select_Reviewers')\",\"joinWith\":\";\"}},\"Set_Reviewers\":{\"runAfter\":{\"Join_Reviewers\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"b0acbcf6-b2f3-4456-8c2b-d7e69ebb9314\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"ReviewersList\",\"value\":\"@body('Join_Reviewers')\"}}},\"runAfter\":{\"Create_Approvers_List\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"81d65695-4cd3-491b-8b87-8b82ce9257e1\"},\"type\":\"Foreach\"}},\"outputs\":{}}},\"schemaVersion\":\"1.0.0.0\"}","createdBy":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","modifiedBy":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","ownerId":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","owningBusinessUnit":"ee0a9aec-b63d-e911-a81c-000d3a11eefe","owningUser":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff"},{"name":"GDMS_CreateFileUpload","createdOn":"2023-07-31T17:18:35Z","modifiedOn":"2023-11-20T14:24:39Z","workflowId":"9d669442-c62f-ee11-bdf3-000d3a1b983d","resourceId":"6ebd6c13-e1f3-458c-8e60-d1641be70fe8","stateCode":"Published","statusCode":"Published","definition":"{\"properties\":{\"connectionReferences\":{\"shared_sharepointonline\":{\"runtimeSource\":\"invoker\",\"connection\":{\"connectionReferenceLogicalName\":\"spo_sharedsharepointonline_e3ac5\"},\"api\":{\"name\":\"shared_sharepointonline\"}}},\"definition\":{\"$schema\":\"https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"$authentication\":{\"defaultValue\":{},\"type\":\"SecureObject\"},\"$connections\":{\"defaultValue\":{},\"type\":\"Object\"}},\"triggers\":{\"manual\":{\"metadata\":{\"operationMetadataId\":\"ae3c4af2-b437-43c0-b603-1694c4d5ccc0\"},\"type\":\"Request\",\"kind\":\"PowerAppV2\",\"inputs\":{\"schema\":{\"type\":\"object\",\"properties\":{\"text\":{\"title\":\"FileName\",\"type\":\"string\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter your input\",\"x-ms-content-hint\":\"TEXT\"},\"text_1\":{\"title\":\"DivisionSelected\",\"type\":\"string\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter your input\",\"x-ms-content-hint\":\"TEXT\"},\"text_2\":{\"title\":\"ProcessSelected\",\"type\":\"string\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter your input\",\"x-ms-content-hint\":\"TEXT\"},\"text_3\":{\"title\":\"DocumentType\",\"type\":\"string\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter your input\",\"x-ms-content-hint\":\"TEXT\"},\"text_4\":{\"title\":\"DocNumber\",\"type\":\"string\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter your input\",\"x-ms-content-hint\":\"TEXT\"},\"text_5\":{\"title\":\"DocTitle\",\"type\":\"string\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter your input\",\"x-ms-content-hint\":\"TEXT\"},\"number\":{\"title\":\"DocRevNumber\",\"type\":\"number\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter a number\",\"x-ms-content-hint\":\"NUMBER\"},\"number_1\":{\"title\":\"DivisionNumber\",\"type\":\"number\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter a number\",\"x-ms-content-hint\":\"NUMBER\"},\"number_2\":{\"title\":\"ProcessNumber\",\"type\":\"number\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter a number\",\"x-ms-content-hint\":\"NUMBER\"},\"number_3\":{\"title\":\"DocumentTypeID\",\"type\":\"number\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter a number\",\"x-ms-content-hint\":\"NUMBER\"},\"text_6\":{\"title\":\"ReasonChanged\",\"type\":\"string\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter your input\",\"x-ms-content-hint\":\"TEXT\"},\"text_7\":{\"title\":\"Division\",\"type\":\"string\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter your input\",\"x-ms-content-hint\":\"TEXT\"},\"text_8\":{\"title\":\"Process\",\"type\":\"string\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter your input\",\"x-ms-content-hint\":\"TEXT\"},\"text_9\":{\"title\":\"FileContent\",\"type\":\"string\",\"x-ms-dynamically-added\":true,\"description\":\"Please enter your input\",\"x-ms-content-hint\":\"TEXT\"},\"text_10\":{\"description\":\"Please enter your input\",\"title\":\"UserName\",\"type\":\"string\",\"x-ms-content-hint\":\"TEXT\",\"x-ms-dynamically-added\":true},\"text_11\":{\"description\":\"Please enter your input\",\"title\":\"UserEmail\",\"type\":\"string\",\"x-ms-content-hint\":\"TEXT\",\"x-ms-dynamically-added\":true}},\"required\":[\"text\",\"text_1\",\"text_2\",\"text_3\",\"text_4\",\"text_5\",\"number\",\"number_1\",\"number_2\",\"number_3\",\"text_6\",\"text_7\",\"text_8\",\"text_9\",\"text_10\",\"text_11\"]}}}},\"actions\":{\"Create_file_in_Documents\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"266aad08-e0cd-4c6f-a253-ccbe122a36fa\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"folderPath\":\"/Shared Documents/@{triggerBody()['text_1']}/@{triggerBody()['text_2']}\",\"name\":\"@triggerBody()['text']\",\"body\":\"@base64ToBinary(triggerBody()['text_9'])\"},\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"operationId\":\"CreateFile\",\"connectionName\":\"shared_sharepointonline\"}},\"runtimeConfiguration\":{\"contentTransfer\":{\"transferMode\":\"Chunked\"}}},\"Update_file_properties\":{\"runAfter\":{\"Create_file_in_Documents\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"5adc451d-c212-434d-baa9-c7685c708af2\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"bc460a20-664c-49e7-bfe7-2843495da717\",\"id\":\"@outputs('Create_file_in_Documents')?['body/ItemId']\",\"item/GroteDocumentShortDescription\":\"@triggerBody()['text_4']\",\"item/GroteDocumentDescription\":\"@triggerBody()['text_5']\",\"item/GroteDocumentRevision\":\"@triggerBody()['number']\",\"item/Title\":\"@triggerBody()['text_7']\",\"item/GroteDivision/Id\":\"@triggerBody()['number_1']\",\"item/GroteProcess/Id\":\"@triggerBody()['number_2']\",\"item/OriginatorName\":\"@triggerBody()?['text_10']\",\"item/OriginatorEmail\":\"@triggerBody()?['text_11']\",\"item/GroteDocumentType/Id\":\"@triggerBody()['number_3']\",\"item/ObsoleteInProgress\":false,\"item/GroteRecentChangesReason\":\"@triggerBody()['text_6']\",\"item/Status\":\"New\"},\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"operationId\":\"PatchFileItem\",\"connectionName\":\"shared_sharepointonline\"}}},\"Create_DocNumber\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"5ef64110-2f2e-4f5e-b302-dd9713cfbf8d\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"66953198-05c9-40f9-bdfa-e0744efc90cc\",\"item/Title\":\"@triggerBody()['text_7']\",\"item/Process\":\"@triggerBody()['text_8']\",\"item/DocNumber\":\"@triggerBody()['text_4']\"},\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"operationId\":\"PostItem\",\"connectionName\":\"shared_sharepointonline\"}}}}}},\"schemaVersion\":\"1.0.0.0\"}","createdBy":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","modifiedBy":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","ownerId":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","owningBusinessUnit":"ee0a9aec-b63d-e911-a81c-000d3a11eefe","owningUser":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff"},{"name":"GDMS_Distribution","createdOn":"2023-07-31T04:02:34Z","modifiedOn":"2023-11-20T12:56:22Z","workflowId":"8a3a6211-572f-ee11-bdf3-000d3a1b983d","resourceId":"74fc7be2-9c82-47f8-a465-815b74974f23","stateCode":"Published","statusCode":"Published","definition":"{\"properties\":{\"connectionReferences\":{\"shared_office365-2\":{\"runtimeSource\":\"embedded\",\"connection\":{\"name\":\"shared-office365-5bd6a51a-7202-4b32-b2cb-5d99c414fe6e\"},\"api\":{\"name\":\"shared_office365\"}},\"shared_sharepointonline\":{\"runtimeSource\":\"embedded\",\"connection\":{\"name\":\"shared-sharepointonl-947cca0b-9618-4af1-b27f-1d5711ca17b2\"},\"api\":{\"name\":\"shared_sharepointonline\"}}},\"definition\":{\"$schema\":\"https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"$connections\":{\"defaultValue\":{},\"type\":\"Object\"},\"$authentication\":{\"defaultValue\":{},\"type\":\"SecureObject\"}},\"triggers\":{\"When_an_item's_stage_is_set_to_Distribute\":{\"recurrence\":{\"frequency\":\"Minute\",\"interval\":1},\"splitOn\":\"@triggerOutputs()?['body/value']\",\"metadata\":{\"operationMetadataId\":\"e8832903-30b8-43c0-927f-b9baa700e5b6\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"GetOnUpdatedItems\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"3f960b78-8bab-42f1-a5d4-fa18072ad762\"},\"authentication\":\"@parameters('$authentication')\"},\"conditions\":[{\"expression\":\"@equals(triggerBody()?['Stage'], 'Distribution')\"}]}},\"actions\":{\"DistributionList\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"da35e55a-26ee-4504-9c2a-89e481c4f0e0\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"DistributionList\",\"type\":\"string\",\"value\":\"@triggerBody()?['Distribution']\"}]}},\"Send_email_to_Distribution_List\":{\"runAfter\":{\"Create_ReadingTask_item\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"24b27e62-cae8-4cb0-b9b5-94ae8fa7ecfc\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_office365\",\"connectionName\":\"shared_office365-2\",\"operationId\":\"SendEmailV2\"},\"parameters\":{\"emailMessage/To\":\"@variables('DistributionList')\",\"emailMessage/Subject\":\"GDMS | Reading Task Assigned\",\"emailMessage/Body\":\"<p><i><em>Please do not reply, this is an automated message and responses to this email will not be monitored.</em></i></p><p><span>\\n</span></p><p>A new reading task has been created and assigned to you. You are required to read the document \\\"@{triggerBody()?['Title']} | @{triggerBody()?['Descripton']}\\\" before the deadline date of @{variables('DueDate')}.</p>\",\"emailMessage/Importance\":\"Normal\"},\"authentication\":\"@parameters('$authentication')\"}},\"Create_ReadingTask_item\":{\"runAfter\":{\"DocID\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"a18ece92-d68b-40e7-9471-0ed2a47707bf\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"PostItem\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"8507b581-d54b-4dc7-a03f-eecfae8ab0af\",\"item/Title\":\"@triggerBody()?['Title']\",\"item/Name\":\"@triggerBody()?['Descripton']\",\"item/DueDate\":\"@variables('DueDate')\",\"item/AllDistribution\":\"@triggerBody()?['Distribution']\",\"item/Link1\":\"@triggerBody()?['DocumentLink']\"},\"authentication\":\"@parameters('$authentication')\"}},\"Update_item\":{\"runAfter\":{\"Send_email_to_Distribution_List\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"1e07792f-ecf5-4ada-878c-2b62c9b1be8f\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"PatchItem\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"3f960b78-8bab-42f1-a5d4-fa18072ad762\",\"id\":\"@triggerBody()?['ID']\",\"item/Stage\":\"Approved\"},\"authentication\":\"@parameters('$authentication')\"}},\"Initialize_variable\":{\"runAfter\":{\"DistributionList\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"f1f2f016-441b-4082-a027-9d3e83dce23b\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"DueDate\",\"type\":\"string\",\"value\":\"@{addDays(utcNow(),7)}\"}]}},\"Set_content_approval_status\":{\"runAfter\":{\"Get_file_metadata\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"01c8478c-104d-4f48-bb1b-9f1679440e06\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"SetApprovalStatus\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"bc460a20-664c-49e7-bfe7-2843495da717\",\"id\":\"@variables('DocID')\",\"approvalAction\":\"Approve\",\"comments\":\"\",\"entityTag\":\"@outputs('Get_file_metadata')?['body/ETag']\"},\"authentication\":\"@parameters('$authentication')\"}},\"DocID\":{\"runAfter\":{\"Initialize_variable\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"9c94cb81-18b3-48f8-bac7-240ba2d33c25\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"DocID\",\"type\":\"string\",\"value\":\"@triggerOutputs()?['body/DocID']\"}]}},\"Set_file_Status_to_Approved\":{\"runAfter\":{\"Get_file_properties\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"6df87eb3-9501-46b9-8813-b987a068fa95\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"PatchFileItem\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"bc460a20-664c-49e7-bfe7-2843495da717\",\"id\":\"@variables('DocID')\",\"item/GroteDocumentShortDescription\":\"@body('Get_file_properties')?['GroteDocumentShortDescription']\",\"item/GroteDocumentDescription\":\"@body('Get_file_properties')?['GroteDocumentDescription']\",\"item/GroteDocumentRevision\":\"@body('Get_file_properties')?['GroteDocumentRevision']\",\"item/ObsoleteInProgress\":false,\"item/Status\":\"Approved\"},\"authentication\":\"@parameters('$authentication')\"}},\"Get_file_properties\":{\"runAfter\":{\"Update_item\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"b0b1ec0e-914a-4ad3-a2b3-340700a71ef6\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"GetFileItem\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"bc460a20-664c-49e7-bfe7-2843495da717\",\"id\":\"@variables('DocID')\"},\"authentication\":\"@parameters('$authentication')\"}},\"Get_file_metadata\":{\"runAfter\":{\"Set_file_Status_to_Approved\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"59333936-4696-43f7-8e81-336f1e1443de\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"GetFileMetadata\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"id\":\"@outputs('Get_file_properties')?['body/{Identifier}']\"},\"authentication\":\"@parameters('$authentication')\"}}},\"outputs\":{}}},\"schemaVersion\":\"1.0.0.0\"}","createdBy":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","modifiedBy":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","ownerId":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","owningBusinessUnit":"ee0a9aec-b63d-e911-a81c-000d3a11eefe","owningUser":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff"},{"name":"GDMS_ReadingTask_Retrigger","createdOn":"2023-07-31T04:02:26Z","modifiedOn":"2023-10-05T16:21:56Z","workflowId":"6dee690b-572f-ee11-bdf3-000d3a1b983d","resourceId":"139e5606-4435-49a3-9742-18d5e171288f","stateCode":"Published","statusCode":"Published","definition":"{\"properties\":{\"connectionReferences\":{\"shared_sharepointonline\":{\"runtimeSource\":\"embedded\",\"connection\":{\"name\":\"shared-sharepointonl-947cca0b-9618-4af1-b27f-1d5711ca17b2\",\"connectionReferenceLogicalName\":\"spo_sharedsharepointonline_e3ac5\"},\"api\":{\"name\":\"shared_sharepointonline\"}},\"shared_office365\":{\"runtimeSource\":\"embedded\",\"connection\":{\"name\":\"shared-office365-359508f2-3484-4ea4-8f85-24831ac9d9fc\",\"connectionReferenceLogicalName\":\"spo_sharedoffice365_36d3c\"},\"api\":{\"name\":\"shared_office365\"}}},\"definition\":{\"$schema\":\"https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"$connections\":{\"defaultValue\":{},\"type\":\"Object\"},\"$authentication\":{\"defaultValue\":{},\"type\":\"SecureObject\"}},\"triggers\":{\"When_an_reading_task's_status_is_set_to_Retrigger\":{\"recurrence\":{\"frequency\":\"Minute\",\"interval\":1},\"splitOn\":\"@triggerOutputs()?['body/value']\",\"metadata\":{\"operationMetadataId\":\"a60bae90-6d35-4e0a-a553-65b09ce03f28\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"GetOnUpdatedItems\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"8507b581-d54b-4dc7-a03f-eecfae8ab0af\"},\"authentication\":\"@parameters('$authentication')\"},\"conditions\":[{\"expression\":\"@equals(triggerBody()?['Status'], 'Retrigger')\"}]}},\"actions\":{\"Reset_status_to_Overdue\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"2b5ff1b3-37c7-468c-8f0f-90b012b8b3ba\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"PatchItem\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"8507b581-d54b-4dc7-a03f-eecfae8ab0af\",\"id\":\"@triggerOutputs()?['body/ID']\",\"item/Status\":\"Overdue\"},\"authentication\":\"@parameters('$authentication')\"}},\"Send_an_email_(V2)\":{\"runAfter\":{\"Reset_status_to_Overdue\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"2cd3ab4a-2456-4d64-9bc3-20892c49cc84\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_office365\",\"connectionName\":\"shared_office365\",\"operationId\":\"SendEmailV2\"},\"parameters\":{\"emailMessage/To\":\"Kyle.Corum@grote.com\",\"emailMessage/Subject\":\"asd\",\"emailMessage/Body\":\"<p>asd</p>\",\"emailMessage/Importance\":\"Normal\"},\"authentication\":\"@parameters('$authentication')\"}}}}},\"schemaVersion\":\"1.0.0.0\"}","createdBy":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","modifiedBy":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","ownerId":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","owningBusinessUnit":"ee0a9aec-b63d-e911-a81c-000d3a11eefe","owningUser":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff"},{"name":"GDMS Approval","createdOn":"2023-07-31T04:02:26Z","modifiedOn":"2023-08-11T00:25:43Z","workflowId":"70ee690b-572f-ee11-bdf3-000d3a1b983d","resourceId":"e5edaf87-f25a-4855-baf7-3f14dc62f2cf","stateCode":"Draft","statusCode":"Draft","definition":"{\"properties\":{\"connectionReferences\":{\"shared_sharepointonline\":{\"runtimeSource\":\"embedded\",\"connection\":{\"name\":\"shared-sharepointonl-e919b6bd-5b48-4ebc-b8d9-5edd-1ceade6f\"},\"api\":{\"name\":\"shared_sharepointonline\"}},\"shared_approvals\":{\"runtimeSource\":\"embedded\",\"connection\":{\"name\":\"shared-approvals-a4fc1f79-6f74-4c82-978d-c757-44a4a8f7\"},\"api\":{\"name\":\"shared_approvals\"}},\"shared_sendmail\":{\"runtimeSource\":\"embedded\",\"connection\":{\"name\":\"shared-sendmail-c78240be-01db-4712-bc0e-614ccce9247b\"},\"api\":{\"name\":\"shared_sendmail\"}}},\"definition\":{\"$schema\":\"https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"$connections\":{\"defaultValue\":{},\"type\":\"Object\"},\"$authentication\":{\"defaultValue\":{},\"type\":\"SecureObject\"}},\"triggers\":{\"When_a_file_is_created_or_modified_(properties_only)\":{\"recurrence\":{\"frequency\":\"Minute\",\"interval\":5},\"splitOn\":\"@triggerOutputs()?['body/value']\",\"metadata\":{\"operationMetadataId\":\"412e0c0f-c3f2-42e7-aae0-4cc41ccc3757\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"GetOnUpdatedFileItems\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"bc460a20-664c-49e7-bfe7-2843495da717\"},\"authentication\":\"@parameters('$authentication')\"},\"conditions\":[{\"expression\":\"@equals(triggerOutputs()?['body/{ModerationStatus}'],'Pending')\"},{\"expression\":\"@equals(triggerOutputs()?['body/{ObsoleteInProgress}'],false)\"}]}},\"actions\":{\"Initialize_variable:_redirectURL\":{\"runAfter\":{\"Initialize_variable:_division\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"ae8d23ce-0b47-42fc-9e28-2ba69585d8f7\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"redirectURL\",\"type\":\"string\",\"value\":\"https://grote0.sharepoint.com/sites/GDMS\"}]}},\"Initialize_variable:_allReviewers\":{\"runAfter\":{\"Initialize_variable:_redirectURL\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"b9e6c7c9-bbe4-4aa5-ab61-fa94546c0318\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"allReviewers\",\"type\":\"string\",\"value\":\"Yes\"}]}},\"Initialize_variable:_allApprovers\":{\"runAfter\":{\"Initialize_variable:_allReviewers\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"4761e6d7-4403-4e61-8c0f-6e9cc45ef07e\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"allApprovers\",\"type\":\"string\",\"value\":\"No\"}]}},\"Initialize_variable:_rejected\":{\"runAfter\":{\"Initialize_variable:_allApprovers\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"591895f3-bcd5-4087-9df6-5a756ef58208\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"rejected\",\"type\":\"string\",\"value\":\"No\"}]}},\"Initialize_variable:_documentType\":{\"runAfter\":{\"Initialize_variable:_rejected\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"d7594ba3-3fa5-44d7-9eb8-eec6137b7f16\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"documentType\",\"type\":\"string\",\"value\":\"@outputs('Get_file_properties')?['body/GroteDocumentType_x003A_Description/Value']\"}]}},\"Get_file_properties\":{\"runAfter\":{\"Get_file_metadata\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"ec1185a4-02b8-4832-9e55-15cabc8cf32d\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"GetFileItem\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"bc460a20-664c-49e7-bfe7-2843495da717\",\"id\":\"@outputs('Get_file_metadata')?['body/ItemId']\"},\"authentication\":\"@parameters('$authentication')\"}},\"Get_file_metadata\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"271aec5d-7052-4d57-b021-64fd2e3408fc\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"GetFileMetadata\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"id\":\"@triggerOutputs()?['body/{Identifier}']\"},\"authentication\":\"@parameters('$authentication')\"}},\"Initialize_variable:_process\":{\"runAfter\":{\"Initialize_variable:_documentType\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"7d4f5dea-eaae-4d90-85a0-ac1d645b883d\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"process\",\"type\":\"string\",\"value\":\"@outputs('Get_file_properties')?['body/GroteProcess/Value']\"}]}},\"level_lookup\":{\"runAfter\":{\"Initialize_variable:_process\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"3ddfad9b-3114-4af9-a6d1-e76d2c0c0c27\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"GetItems\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"9aa9b174-ee24-4e87-bfe8-dfafd76f8624\",\"$filter\":\"Description eq '@{variables('documentType')}'\",\"$top\":1},\"authentication\":\"@parameters('$authentication')\"}},\"processes_lookup\":{\"runAfter\":{\"Initialize_variable:_level\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"0f3ea9a1-48c6-4d48-9f78-9d9267a3bad7\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"GetItems\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"b0035a39-3ba2-4fd4-8aac-f1b158eb5ea6\",\"$filter\":\"Title eq '@{variables('process')}'\",\"$top\":1},\"authentication\":\"@parameters('$authentication')\"}},\"Initialize_variable:_level\":{\"runAfter\":{\"level_lookup\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"bae7e012-4a4e-4e4c-95bf-73b8eb159c97\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"level\",\"type\":\"string\",\"value\":\"@{first(body('level_lookup')['value'])['Level/Value']}\"}]}},\"Initialize_variable:_division\":{\"runAfter\":{\"Initialize_variable:_documentRelativeURL\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"82f3067d-a7c9-4011-89d7-00a952103fcb\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"division\",\"type\":\"string\",\"value\":\"@outputs('Get_file_properties')?['body/GroteDivision/Value']\"}]}},\"Initialize_variable:_approversGroupID\":{\"runAfter\":{\"Filter_array_using_approversGroupName\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"44358378-f534-46d1-9b47-67bc2aa2004c\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"approversGroupID\",\"type\":\"integer\",\"value\":\"@body('Filter_array_using_approversGroupName')?[0]['Id']\"}]}},\"WorkflowRules_Lookup\":{\"runAfter\":{\"Switch:_Set_allApprovers\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"556d446c-b439-45a0-aaf7-a8e28358969d\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"GetItems\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"b2716a58-165d-4a57-b8b7-3d84f80fdc99\",\"$filter\":\"Title eq '@{concat(variables('division'), ' ', variables('process'), ' ', variables('level'))}'\"},\"authentication\":\"@parameters('$authentication')\"}},\"Initialize_variable:_reviewerType\":{\"runAfter\":{\"processes_lookup\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"812ed1bf-ce44-4c18-a61d-6b26a9a65dc4\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"reviewerType\",\"type\":\"string\",\"value\":\"@{first(body('processes_lookup')['value'])['ReviewerType/Value']}\"}]}},\"Switch:_Set_allReviewers\":{\"runAfter\":{\"Initialize_variable:_reviewerType\":[\"Succeeded\"]},\"cases\":{\"ReviewerType_eq_One\":{\"case\":\"One\",\"actions\":{\"Set_variable:_allReviewers\":{\"runAfter\":{},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"allReviewers\",\"value\":\"No\"}}}}},\"default\":{\"actions\":{}},\"expression\":\"@variables('reviewerType')\",\"metadata\":{\"operationMetadataId\":\"9409c0cd-31fc-4630-87f8-4cb046d0a80c\"},\"type\":\"Switch\"},\"Get_Approver_Group_Members\":{\"runAfter\":{\"Initialize_variable:_approversGroupID\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"124ab135-1297-4ad7-a367-408c64dd7639\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"HttpRequest\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"parameters/method\":\"GET\",\"parameters/uri\":\"_api/web/sitegroups(@{variables('approversGroupID')})/users\"},\"authentication\":\"@parameters('$authentication')\"}},\"Get_Reviewers_Group_Members\":{\"runAfter\":{\"Initialize_variable:_reviewersGroupID\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"3d43ec3a-8d13-4e7c-84dc-70c7102753d5\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"HttpRequest\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"parameters/method\":\"GET\",\"parameters/uri\":\"_api/web/sitegroups(@{variables('reviewersGroupID')})/users\"},\"authentication\":\"@parameters('$authentication')\"}},\"Initialize_variable:_reviewersEmails\":{\"runAfter\":{\"Select_Reviewers_Emails\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"407e7b26-0b57-4399-a172-0b8e92503e1c\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"reviewersEmails\",\"type\":\"string\",\"value\":\"@{join(body('Select_Reviewers_Emails'),';')}\"}]}},\"Select_Approver_Emails\":{\"runAfter\":{\"Get_Approver_Group_Members\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"211fc3c7-de2e-44b4-bad2-5dd96d6cf069\"},\"type\":\"Select\",\"inputs\":{\"from\":\"@body('Get_Approver_Group_Members')?['d']?['results']\",\"select\":\"@item()?['Email']\"}},\"Initialize_variable:_approversEmails\":{\"runAfter\":{\"Select_Approver_Emails\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"744280dd-144e-4b7c-b7f7-47a03f73ce54\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"approversEmails\",\"type\":\"string\",\"value\":\"@{join(body('Select_Approver_Emails'), ';')}\"}]}},\"Initialize_variable:_reviewerComments\":{\"runAfter\":{\"Get_All_Groups\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"c02fcdb9-6dcd-4f41-9332-ad9866e83ee0\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"reviewerComments\",\"type\":\"string\",\"value\":\"@outputs('Get_file_properties')?['body/GroteRecentChangesReason']\"}]}},\"Initialize_variable:_documentRelativeURL\":{\"runAfter\":{\"Initialize_variable:_reviewerComments\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"330a4a72-048a-4a9e-9a30-667e16eb22d6\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"documentRelativeURL\",\"type\":\"string\",\"value\":\"@outputs('Get_file_properties')?['body/{Link}']\"}]}},\"Initialize_variable:_approverType\":{\"runAfter\":{\"Switch:_Set_allReviewers\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"812ed1bf-ce44-4c18-a61d-6b26a9a65dc4\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"approverType\",\"type\":\"string\",\"value\":\"@{first(body('processes_lookup')['value'])['ReviewerType/Value']}\"}]}},\"Switch:_Set_allApprovers\":{\"runAfter\":{\"Initialize_variable:_approverType\":[\"Succeeded\"]},\"cases\":{\"ReviewerType_eq_One\":{\"case\":\"All\",\"actions\":{\"Set_variable:_allApprovers\":{\"runAfter\":{},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"allApprovers\",\"value\":\"Yes\"}}}}},\"default\":{\"actions\":{}},\"expression\":\"@variables('approverType')\",\"metadata\":{\"operationMetadataId\":\"9409c0cd-31fc-4630-87f8-4cb046d0a80c\"},\"type\":\"Switch\"},\"Select_Reviewers_Emails\":{\"runAfter\":{\"Get_Reviewers_Group_Members\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"c4b54b0e-9849-4771-970c-93bc6e30c499\"},\"type\":\"Select\",\"inputs\":{\"from\":\"@body('Get_Reviewers_Group_Members')?['d']?['results']\",\"select\":\"@item()['Email']\"}},\"Get_All_Groups\":{\"runAfter\":{\"Get_file_properties\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"4799eea5-1b20-47b4-975f-5688cc136abc\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"HttpRequest\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"parameters/method\":\"GET\",\"parameters/uri\":\"_api/web/sitegroups\"},\"authentication\":\"@parameters('$authentication')\"}},\"Initialize_variable:_reviewersGroupName\":{\"runAfter\":{\"Parse_JSON:_WorkflowRules_Reviewers\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"4bfab4a2-9164-46c8-947e-01a0b3d56fed\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"reviewersGroupName\",\"type\":\"string\"}]}},\"Filter_array_using_reviewersGroupName\":{\"runAfter\":{\"Get_Reviewers_from_WorkflowRules_JSON\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"6c8d3fff-da98-4ac7-91b6-60da757d79ff\"},\"type\":\"Query\",\"inputs\":{\"from\":\"@body('Get_All_Groups')?['d']?['results']\",\"where\":\"@equals(item()?['Title'], variables('reviewersGroupName'))\"}},\"Parse_JSON:_WorkflowRules\":{\"runAfter\":{\"WorkflowRules_Lookup\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"76da6a0f-072d-4d02-80be-8e706e0e4f6c\"},\"type\":\"ParseJson\",\"inputs\":{\"content\":\"@body('WorkflowRules_Lookup')\",\"schema\":{\"type\":\"object\",\"properties\":{\"statusCode\":{\"type\":\"integer\"},\"headers\":{\"type\":\"object\",\"properties\":{\"Transfer-Encoding\":{\"type\":\"string\"},\"Vary\":{\"type\":\"string\"},\"X-SharePointHealthScore\":{\"type\":\"string\"},\"X-MS-SPConnector\":{\"type\":\"string\"},\"X-SP-SERVERSTATE\":{\"type\":\"string\"},\"DATASERVICEVERSION\":{\"type\":\"string\"},\"SPClientServiceRequestDuration\":{\"type\":\"string\"},\"SPRequestGuid\":{\"type\":\"string\"},\"request-id\":{\"type\":\"string\"},\"MS-CV\":{\"type\":\"string\"},\"Strict-Transport-Security\":{\"type\":\"string\"},\"X-FRAME-OPTIONS\":{\"type\":\"string\"},\"Content-Security-Policy\":{\"type\":\"string\"},\"MicrosoftSharePointTeamServices\":{\"type\":\"string\"},\"X-Content-Type-Options\":{\"type\":\"string\"},\"X-MS-InvokeApp\":{\"type\":\"string\"},\"Timing-Allow-Origin\":{\"type\":\"string\"},\"x-ms-apihub-cached-response\":{\"type\":\"string\"},\"x-ms-apihub-obo\":{\"type\":\"string\"},\"Cache-Control\":{\"type\":\"string\"},\"Date\":{\"type\":\"string\"},\"P3P\":{\"type\":\"string\"},\"X-AspNet-Version\":{\"type\":\"string\"},\"X-Powered-By\":{\"type\":\"string\"},\"Content-Type\":{\"type\":\"string\"},\"Expires\":{\"type\":\"string\"},\"Last-Modified\":{\"type\":\"string\"},\"Content-Length\":{\"type\":\"string\"}}},\"body\":{\"type\":\"object\",\"properties\":{\"value\":{\"type\":\"array\",\"items\":{\"type\":\"object\",\"properties\":{\"@@odata.etag\":{\"type\":\"string\"},\"ItemInternalId\":{\"type\":\"string\"},\"ID\":{\"type\":\"integer\"},\"Title\":{\"type\":\"string\"},\"GroteDivision\":{\"type\":\"object\",\"properties\":{\"@@odata.type\":{\"type\":\"string\"},\"Id\":{\"type\":\"integer\"},\"Value\":{\"type\":\"string\"}}},\"GroteDivision#Id\":{\"type\":\"integer\"},\"Level\":{\"type\":\"object\",\"properties\":{\"@@odata.type\":{\"type\":\"string\"},\"Id\":{\"type\":\"integer\"},\"Value\":{\"type\":\"string\"}}},\"Level#Id\":{\"type\":\"integer\"},\"GroteProcess\":{\"type\":\"object\",\"properties\":{\"@@odata.type\":{\"type\":\"string\"},\"Id\":{\"type\":\"integer\"},\"Value\":{\"type\":\"string\"}}},\"GroteProcess#Id\":{\"type\":\"integer\"},\"GroteReviewers\":{\"type\":\"array\",\"items\":{\"type\":\"object\",\"properties\":{\"@@odata.type\":{\"type\":\"string\"},\"Claims\":{\"type\":\"string\"},\"DisplayName\":{\"type\":\"string\"}},\"required\":[\"@@odata.type\",\"Claims\",\"DisplayName\"]}},\"GroteReviewers@odata.type\":{\"type\":\"string\"},\"GroteReviewers#Claims\":{\"type\":\"array\",\"items\":{\"type\":\"string\"}},\"GroteReviewers#Claims@odata.type\":{\"type\":\"string\"},\"Approver\":{\"type\":\"object\",\"properties\":{\"@@odata.type\":{\"type\":\"string\"},\"Claims\":{\"type\":\"string\"},\"DisplayName\":{\"type\":\"string\"}}},\"Approver#Claims\":{\"type\":\"string\"},\"Distribution\":{\"type\":\"object\",\"properties\":{\"@@odata.type\":{\"type\":\"string\"},\"Claims\":{\"type\":\"string\"},\"DisplayName\":{\"type\":\"string\"}}},\"Distribution#Claims\":{\"type\":\"string\"},\"GroteDivision_x003A_Title\":{\"type\":\"object\",\"properties\":{\"@@odata.type\":{\"type\":\"string\"},\"Id\":{\"type\":\"integer\"},\"Value\":{\"type\":\"string\"}}},\"GroteDivision_x003A_Title#Id\":{\"type\":\"integer\"},\"Process_x003A_Label\":{\"type\":\"object\",\"properties\":{\"@@odata.type\":{\"type\":\"string\"},\"Id\":{\"type\":\"integer\"},\"Value\":{\"type\":\"string\"}}},\"Process_x003A_Label#Id\":{\"type\":\"integer\"},\"Division_x003A_Number\":{\"type\":\"object\",\"properties\":{\"@@odata.type\":{\"type\":\"string\"},\"Id\":{\"type\":\"integer\"},\"Value\":{\"type\":\"string\"}}},\"Division_x003A_Number#Id\":{\"type\":\"integer\"},\"Modified\":{\"type\":\"string\"},\"Created\":{\"type\":\"string\"},\"Author\":{\"type\":\"object\",\"properties\":{\"@@odata.type\":{\"type\":\"string\"},\"Claims\":{\"type\":\"string\"},\"DisplayName\":{\"type\":\"string\"},\"Email\":{},\"Picture\":{},\"Department\":{},\"JobTitle\":{}}},\"Author#Claims\":{\"type\":\"string\"},\"Editor\":{\"type\":\"object\",\"properties\":{\"@@odata.type\":{\"type\":\"string\"},\"Claims\":{\"type\":\"string\"},\"DisplayName\":{\"type\":\"string\"},\"Email\":{\"type\":\"string\"},\"Picture\":{\"type\":\"string\"},\"Department\":{\"type\":\"string\"},\"JobTitle\":{\"type\":\"string\"}}},\"Editor#Claims\":{\"type\":\"string\"},\"{Identifier}\":{\"type\":\"string\"},\"{IsFolder}\":{\"type\":\"boolean\"},\"{Thumbnail}\":{\"type\":\"object\",\"properties\":{\"Large\":{},\"Medium\":{},\"Small\":{}}},\"{Link}\":{\"type\":\"string\"},\"{Name}\":{\"type\":\"string\"},\"{FilenameWithExtension}\":{\"type\":\"string\"},\"{Path}\":{\"type\":\"string\"},\"{FullPath}\":{\"type\":\"string\"},\"{HasAttachments}\":{\"type\":\"boolean\"},\"{VersionNumber}\":{\"type\":\"string\"}},\"required\":[\"@@odata.etag\",\"ItemInternalId\",\"ID\",\"Title\",\"GroteDivision\",\"GroteDivision#Id\",\"Level\",\"Level#Id\",\"GroteProcess\",\"GroteProcess#Id\",\"GroteReviewers\",\"GroteReviewers@odata.type\",\"GroteReviewers#Claims\",\"GroteReviewers#Claims@odata.type\",\"Approver\",\"Approver#Claims\",\"Distribution\",\"Distribution#Claims\",\"GroteDivision_x003A_Title\",\"GroteDivision_x003A_Title#Id\",\"Process_x003A_Label\",\"Process_x003A_Label#Id\",\"Division_x003A_Number\",\"Division_x003A_Number#Id\",\"Modified\",\"Created\",\"Author\",\"Author#Claims\",\"Editor\",\"Editor#Claims\",\"{Identifier}\",\"{IsFolder}\",\"{Thumbnail}\",\"{Link}\",\"{Name}\",\"{FilenameWithExtension}\",\"{Path}\",\"{FullPath}\",\"{HasAttachments}\",\"{VersionNumber}\"]}}}}}}}},\"Get_Reviewers_from_WorkflowRules_JSON\":{\"foreach\":\"@body('Parse_JSON:_WorkflowRules')?['value']\",\"actions\":{\"Get_Nested_Display_Name_from_Reviewers_Object\":{\"foreach\":\"@items('Get_Reviewers_from_WorkflowRules_JSON')['GroteReviewers']\",\"actions\":{\"Set_variable:_reviewersGroupName\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"12825de6-9e0c-44a6-a602-ec06d97e8237\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"reviewersGroupName\",\"value\":\"@items('Get_Nested_Display_Name_from_Reviewers_Object')?['DisplayName']\"}}},\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"83677ab5-4b23-4c2a-8f44-52d73e484eac\"},\"type\":\"Foreach\"}},\"runAfter\":{\"Initialize_variable:_reviewersGroupName\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"5ffafa31-13c6-412e-9d51-cacfb783dd5e\"},\"type\":\"Foreach\"},\"Initialize_variable:_reviewersGroupID\":{\"runAfter\":{\"Filter_array_using_reviewersGroupName\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"b30af872-b9d6-4e28-8899-d91450840b89\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"reviewersGroupID\",\"type\":\"integer\",\"value\":\"@body('Filter_array_using_reviewersGroupName')?[0]['Id']\"}]}},\"Initialize_variable:_assignedToReviewers\":{\"runAfter\":{\"Initialize_variable:_reviewersEmails\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"23ceeecc-dc7a-4217-9b6b-d8fcc00422be\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"assignedToReviewers\",\"type\":\"array\",\"value\":\"@split(variables('reviewersEmails'),';')\"}]}},\"Initialize_variable:_assignedToClaimsReviewers\":{\"runAfter\":{\"Initialize_variable:_assignedToReviewers\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"037d10ce-d8a5-41fe-971e-8245f82fc3c2\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"assignedToClaimsReviewers\",\"type\":\"array\",\"value\":[]}]}},\"Initialize_variable:_approversGroupName\":{\"runAfter\":{\"Parse_JSON:_WorkflowRules_Approvers\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"4bfab4a2-9164-46c8-947e-01a0b3d56fed\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"approversGroupName\",\"type\":\"string\"}]}},\"Filter_array_using_approversGroupName\":{\"runAfter\":{\"Get_Approvers_from_WorkFlow_Rules_JSON\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"6c8d3fff-da98-4ac7-91b6-60da757d79ff\"},\"type\":\"Query\",\"inputs\":{\"from\":\"@body('Get_All_Groups')?['d']?['results']\",\"where\":\"@equals(item()?['Title'], variables('approversGroupName'))\"}},\"Initialize_variable:_distributionGroupName\":{\"runAfter\":{\"Parse_JSON:_WorkflowRules_Distribution\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"4bfab4a2-9164-46c8-947e-01a0b3d56fed\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"distributionGroupName\",\"type\":\"string\"}]}},\"Parse_JSON:_WorkflowRules_Reviewers\":{\"runAfter\":{\"Parse_JSON:_WorkflowRules\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"76da6a0f-072d-4d02-80be-8e706e0e4f6c\"},\"type\":\"ParseJson\",\"inputs\":{\"content\":\"@body('WorkflowRules_Lookup')\",\"schema\":{\"type\":\"object\",\"properties\":{\"statusCode\":{\"type\":\"integer\"},\"headers\":{\"type\":\"object\",\"properties\":{\"Transfer-Encoding\":{\"type\":\"string\"},\"Vary\":{\"type\":\"string\"},\"X-SharePointHealthScore\":{\"type\":\"string\"},\"X-MS-SPConnector\":{\"type\":\"string\"},\"X-SP-SERVERSTATE\":{\"type\":\"string\"},\"DATASERVICEVERSION\":{\"type\":\"string\"},\"SPClientServiceRequestDuration\":{\"type\":\"string\"},\"SPRequestGuid\":{\"type\":\"string\"},\"request-id\":{\"type\":\"string\"},\"MS-CV\":{\"type\":\"string\"},\"Strict-Transport-Security\":{\"type\":\"string\"},\"X-FRAME-OPTIONS\":{\"type\":\"string\"},\"Content-Security-Policy\":{\"type\":\"string\"},\"MicrosoftSharePointTeamServices\":{\"type\":\"string\"},\"X-Content-Type-Options\":{\"type\":\"string\"},\"X-MS-InvokeApp\":{\"type\":\"string\"},\"Timing-Allow-Origin\":{\"type\":\"string\"},\"x-ms-apihub-cached-response\":{\"type\":\"string\"},\"x-ms-apihub-obo\":{\"type\":\"string\"},\"Cache-Control\":{\"type\":\"string\"},\"Date\":{\"type\":\"string\"},\"P3P\":{\"type\":\"string\"},\"X-AspNet-Version\":{\"type\":\"string\"},\"X-Powered-By\":{\"type\":\"string\"},\"Content-Type\":{\"type\":\"string\"},\"Expires\":{\"type\":\"string\"},\"Last-Modified\":{\"type\":\"string\"},\"Content-Length\":{\"type\":\"string\"}}},\"body\":{\"type\":\"object\",\"properties\":{\"value\":{\"type\":\"array\",\"items\":{\"type\":\"object\",\"properties\":{\"@@odata.etag\":{\"type\":\"string\"},\"ItemInternalId\":{\"type\":\"string\"},\"ID\":{\"type\":\"integer\"},\"Title\":{\"type\":\"string\"},\"GroteDivision\":{\"type\":\"object\",\"properties\":{\"@@odata.type\":{\"type\":\"string\"},\"Id\":{\"type\":\"integer\"},\"Value\":{\"type\":\"string\"}}},\"GroteDivision#Id\":{\"type\":\"integer\"},\"Level\":{\"type\":\"object\",\"properties\":{\"@@odata.type\":{\"type\":\"string\"},\"Id\":{\"type\":\"integer\"},\"Value\":{\"type\":\"string\"}}},\"Level#Id\":{\"type\":\"integer\"},\"GroteProcess\":{\"type\":\"object\",\"properties\":{\"@@odata.type\":{\"type\":\"string\"},\"Id\":{\"type\":\"integer\"},\"Value\":{\"type\":\"string\"}}},\"GroteProcess#Id\":{\"type\":\"integer\"},\"GroteReviewers\":{\"type\":\"array\",\"items\":{\"type\":\"object\",\"properties\":{\"@@odata.type\":{\"type\":\"string\"},\"Claims\":{\"type\":\"string\"},\"DisplayName\":{\"type\":\"string\"}},\"required\":[\"@@odata.type\",\"Claims\",\"DisplayName\"]}},\"GroteReviewers@odata.type\":{\"type\":\"string\"},\"GroteReviewers#Claims\":{\"type\":\"array\",\"items\":{\"type\":\"string\"}},\"GroteReviewers#Claims@odata.type\":{\"type\":\"string\"},\"Approver\":{\"type\":\"object\",\"properties\":{\"@@odata.type\":{\"type\":\"string\"},\"Claims\":{\"type\":\"string\"},\"DisplayName\":{\"type\":\"string\"}}},\"Approver#Claims\":{\"type\":\"string\"},\"Distribution\":{\"type\":\"object\",\"properties\":{\"@@odata.type\":{\"type\":\"string\"},\"Claims\":{\"type\":\"string\"},\"DisplayName\":{\"type\":\"string\"}}},\"Distribution#Claims\":{\"type\":\"string\"},\"GroteDivision_x003A_Title\":{\"type\":\"object\",\"properties\":{\"@@odata.type\":{\"type\":\"string\"},\"Id\":{\"type\":\"integer\"},\"Value\":{\"type\":\"string\"}}},\"GroteDivision_x003A_Title#Id\":{\"type\":\"integer\"},\"Process_x003A_Label\":{\"type\":\"object\",\"properties\":{\"@@odata.type\":{\"type\":\"string\"},\"Id\":{\"type\":\"integer\"},\"Value\":{\"type\":\"string\"}}},\"Process_x003A_Label#Id\":{\"type\":\"integer\"},\"Division_x003A_Number\":{\"type\":\"object\",\"properties\":{\"@@odata.type\":{\"type\":\"string\"},\"Id\":{\"type\":\"integer\"},\"Value\":{\"type\":\"string\"}}},\"Division_x003A_Number#Id\":{\"type\":\"integer\"},\"Modified\":{\"type\":\"string\"},\"Created\":{\"type\":\"string\"},\"Author\":{\"type\":\"object\",\"properties\":{\"@@odata.type\":{\"type\":\"string\"},\"Claims\":{\"type\":\"string\"},\"DisplayName\":{\"type\":\"string\"},\"Email\":{},\"Picture\":{},\"Department\":{},\"JobTitle\":{}}},\"Author#Claims\":{\"type\":\"string\"},\"Editor\":{\"type\":\"object\",\"properties\":{\"@@odata.type\":{\"type\":\"string\"},\"Claims\":{\"type\":\"string\"},\"DisplayName\":{\"type\":\"string\"},\"Email\":{\"type\":\"string\"},\"Picture\":{\"type\":\"string\"},\"Department\":{\"type\":\"string\"},\"JobTitle\":{\"type\":\"string\"}}},\"Editor#Claims\":{\"type\":\"string\"},\"{Identifier}\":{\"type\":\"string\"},\"{IsFolder}\":{\"type\":\"boolean\"},\"{Thumbnail}\":{\"type\":\"object\",\"properties\":{\"Large\":{},\"Medium\":{},\"Small\":{}}},\"{Link}\":{\"type\":\"string\"},\"{Name}\":{\"type\":\"string\"},\"{FilenameWithExtension}\":{\"type\":\"string\"},\"{Path}\":{\"type\":\"string\"},\"{FullPath}\":{\"type\":\"string\"},\"{HasAttachments}\":{\"type\":\"boolean\"},\"{VersionNumber}\":{\"type\":\"string\"}},\"required\":[\"@@odata.etag\",\"ItemInternalId\",\"ID\",\"Title\",\"GroteDivision\",\"GroteDivision#Id\",\"Level\",\"Level#Id\",\"GroteProcess\",\"GroteProcess#Id\",\"GroteReviewers\",\"GroteReviewers@odata.type\",\"GroteReviewers#Claims\",\"GroteReviewers#Claims@odata.type\",\"Approver\",\"Approver#Claims\",\"Distribution\",\"Distribution#Claims\",\"GroteDivision_x003A_Title\",\"GroteDivision_x003A_Title#Id\",\"Process_x003A_Label\",\"Process_x003A_Label#Id\",\"Division_x003A_Number\",\"Division_x003A_Number#Id\",\"Modified\",\"Created\",\"Author\",\"Author#Claims\",\"Editor\",\"Editor#Claims\",\"{Identifier}\",\"{IsFolder}\",\"{Thumbnail}\",\"{Link}\",\"{Name}\",\"{FilenameWithExtension}\",\"{Path}\",\"{FullPath}\",\"{HasAttachments}\",\"{VersionNumber}\"]}}}}}}}},\"Parse_JSON:_WorkflowRules_Approvers\":{\"runAfter\":{\"Parse_JSON:_WorkflowRules\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"76da6a0f-072d-4d02-80be-8e706e0e4f6c\"},\"type\":\"ParseJson\",\"inputs\":{\"content\":\"@body('WorkflowRules_Lookup')\",\"schema\":{\"type\":\"object\",\"properties\":{\"statusCode\":{\"type\":\"integer\"},\"headers\":{\"type\":\"object\",\"properties\":{\"Transfer-Encoding\":{\"type\":\"string\"},\"Vary\":{\"type\":\"string\"},\"X-SharePointHealthScore\":{\"type\":\"string\"},\"X-MS-SPConnector\":{\"type\":\"string\"},\"X-SP-SERVERSTATE\":{\"type\":\"string\"},\"DATASERVICEVERSION\":{\"type\":\"string\"},\"SPClientServiceRequestDuration\":{\"type\":\"string\"},\"SPRequestGuid\":{\"type\":\"string\"},\"request-id\":{\"type\":\"string\"},\"MS-CV\":{\"type\":\"string\"},\"Strict-Transport-Security\":{\"type\":\"string\"},\"X-FRAME-OPTIONS\":{\"type\":\"string\"},\"Content-Security-Policy\":{\"type\":\"string\"},\"MicrosoftSharePointTeamServices\":{\"type\":\"string\"},\"X-Content-Type-Options\":{\"type\":\"string\"},\"X-MS-InvokeApp\":{\"type\":\"string\"},\"Timing-Allow-Origin\":{\"type\":\"string\"},\"x-ms-apihub-cached-response\":{\"type\":\"string\"},\"x-ms-apihub-obo\":{\"type\":\"string\"},\"Cache-Control\":{\"type\":\"string\"},\"Date\":{\"type\":\"string\"},\"P3P\":{\"type\":\"string\"},\"X-AspNet-Version\":{\"type\":\"string\"},\"X-Powered-By\":{\"type\":\"string\"},\"Content-Type\":{\"type\":\"string\"},\"Expires\":{\"type\":\"string\"},\"Last-Modified\":{\"type\":\"string\"},\"Content-Length\":{\"type\":\"string\"}}},\"body\":{\"type\":\"object\",\"properties\":{\"value\":{\"type\":\"array\",\"items\":{\"type\":\"object\",\"properties\":{\"@@odata.etag\":{\"type\":\"string\"},\"ItemInternalId\":{\"type\":\"string\"},\"ID\":{\"type\":\"integer\"},\"Title\":{\"type\":\"string\"},\"GroteDivision\":{\"type\":\"object\",\"properties\":{\"@@odata.type\":{\"type\":\"string\"},\"Id\":{\"type\":\"integer\"},\"Value\":{\"type\":\"string\"}}},\"GroteDivision#Id\":{\"type\":\"integer\"},\"Level\":{\"type\":\"object\",\"properties\":{\"@@odata.type\":{\"type\":\"string\"},\"Id\":{\"type\":\"integer\"},\"Value\":{\"type\":\"string\"}}},\"Level#Id\":{\"type\":\"integer\"},\"GroteProcess\":{\"type\":\"object\",\"properties\":{\"@@odata.type\":{\"type\":\"string\"},\"Id\":{\"type\":\"integer\"},\"Value\":{\"type\":\"string\"}}},\"GroteProcess#Id\":{\"type\":\"integer\"},\"GroteReviewers\":{\"type\":\"array\",\"items\":{\"type\":\"object\",\"properties\":{\"@@odata.type\":{\"type\":\"string\"},\"Claims\":{\"type\":\"string\"},\"DisplayName\":{\"type\":\"string\"}},\"required\":[\"@@odata.type\",\"Claims\",\"DisplayName\"]}},\"GroteReviewers@odata.type\":{\"type\":\"string\"},\"GroteReviewers#Claims\":{\"type\":\"array\",\"items\":{\"type\":\"string\"}},\"GroteReviewers#Claims@odata.type\":{\"type\":\"string\"},\"Approver\":{\"type\":\"object\",\"properties\":{\"@@odata.type\":{\"type\":\"string\"},\"Claims\":{\"type\":\"string\"},\"DisplayName\":{\"type\":\"string\"}}},\"Approver#Claims\":{\"type\":\"string\"},\"Distribution\":{\"type\":\"object\",\"properties\":{\"@@odata.type\":{\"type\":\"string\"},\"Claims\":{\"type\":\"string\"},\"DisplayName\":{\"type\":\"string\"}}},\"Distribution#Claims\":{\"type\":\"string\"},\"GroteDivision_x003A_Title\":{\"type\":\"object\",\"properties\":{\"@@odata.type\":{\"type\":\"string\"},\"Id\":{\"type\":\"integer\"},\"Value\":{\"type\":\"string\"}}},\"GroteDivision_x003A_Title#Id\":{\"type\":\"integer\"},\"Process_x003A_Label\":{\"type\":\"object\",\"properties\":{\"@@odata.type\":{\"type\":\"string\"},\"Id\":{\"type\":\"integer\"},\"Value\":{\"type\":\"string\"}}},\"Process_x003A_Label#Id\":{\"type\":\"integer\"},\"Division_x003A_Number\":{\"type\":\"object\",\"properties\":{\"@@odata.type\":{\"type\":\"string\"},\"Id\":{\"type\":\"integer\"},\"Value\":{\"type\":\"string\"}}},\"Division_x003A_Number#Id\":{\"type\":\"integer\"},\"Modified\":{\"type\":\"string\"},\"Created\":{\"type\":\"string\"},\"Author\":{\"type\":\"object\",\"properties\":{\"@@odata.type\":{\"type\":\"string\"},\"Claims\":{\"type\":\"string\"},\"DisplayName\":{\"type\":\"string\"},\"Email\":{},\"Picture\":{},\"Department\":{},\"JobTitle\":{}}},\"Author#Claims\":{\"type\":\"string\"},\"Editor\":{\"type\":\"object\",\"properties\":{\"@@odata.type\":{\"type\":\"string\"},\"Claims\":{\"type\":\"string\"},\"DisplayName\":{\"type\":\"string\"},\"Email\":{\"type\":\"string\"},\"Picture\":{\"type\":\"string\"},\"Department\":{\"type\":\"string\"},\"JobTitle\":{\"type\":\"string\"}}},\"Editor#Claims\":{\"type\":\"string\"},\"{Identifier}\":{\"type\":\"string\"},\"{IsFolder}\":{\"type\":\"boolean\"},\"{Thumbnail}\":{\"type\":\"object\",\"properties\":{\"Large\":{},\"Medium\":{},\"Small\":{}}},\"{Link}\":{\"type\":\"string\"},\"{Name}\":{\"type\":\"string\"},\"{FilenameWithExtension}\":{\"type\":\"string\"},\"{Path}\":{\"type\":\"string\"},\"{FullPath}\":{\"type\":\"string\"},\"{HasAttachments}\":{\"type\":\"boolean\"},\"{VersionNumber}\":{\"type\":\"string\"}},\"required\":[\"@@odata.etag\",\"ItemInternalId\",\"ID\",\"Title\",\"GroteDivision\",\"GroteDivision#Id\",\"Level\",\"Level#Id\",\"GroteProcess\",\"GroteProcess#Id\",\"GroteReviewers\",\"GroteReviewers@odata.type\",\"GroteReviewers#Claims\",\"GroteReviewers#Claims@odata.type\",\"Approver\",\"Approver#Claims\",\"Distribution\",\"Distribution#Claims\",\"GroteDivision_x003A_Title\",\"GroteDivision_x003A_Title#Id\",\"Process_x003A_Label\",\"Process_x003A_Label#Id\",\"Division_x003A_Number\",\"Division_x003A_Number#Id\",\"Modified\",\"Created\",\"Author\",\"Author#Claims\",\"Editor\",\"Editor#Claims\",\"{Identifier}\",\"{IsFolder}\",\"{Thumbnail}\",\"{Link}\",\"{Name}\",\"{FilenameWithExtension}\",\"{Path}\",\"{FullPath}\",\"{HasAttachments}\",\"{VersionNumber}\"]}}}}}}}},\"Parse_JSON:_WorkflowRules_Distribution\":{\"runAfter\":{\"Parse_JSON:_WorkflowRules\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"76da6a0f-072d-4d02-80be-8e706e0e4f6c\"},\"type\":\"ParseJson\",\"inputs\":{\"content\":\"@body('WorkflowRules_Lookup')\",\"schema\":{\"type\":\"object\",\"properties\":{\"statusCode\":{\"type\":\"integer\"},\"headers\":{\"type\":\"object\",\"properties\":{\"Transfer-Encoding\":{\"type\":\"string\"},\"Vary\":{\"type\":\"string\"},\"X-SharePointHealthScore\":{\"type\":\"string\"},\"X-MS-SPConnector\":{\"type\":\"string\"},\"X-SP-SERVERSTATE\":{\"type\":\"string\"},\"DATASERVICEVERSION\":{\"type\":\"string\"},\"SPClientServiceRequestDuration\":{\"type\":\"string\"},\"SPRequestGuid\":{\"type\":\"string\"},\"request-id\":{\"type\":\"string\"},\"MS-CV\":{\"type\":\"string\"},\"Strict-Transport-Security\":{\"type\":\"string\"},\"X-FRAME-OPTIONS\":{\"type\":\"string\"},\"Content-Security-Policy\":{\"type\":\"string\"},\"MicrosoftSharePointTeamServices\":{\"type\":\"string\"},\"X-Content-Type-Options\":{\"type\":\"string\"},\"X-MS-InvokeApp\":{\"type\":\"string\"},\"Timing-Allow-Origin\":{\"type\":\"string\"},\"x-ms-apihub-cached-response\":{\"type\":\"string\"},\"x-ms-apihub-obo\":{\"type\":\"string\"},\"Cache-Control\":{\"type\":\"string\"},\"Date\":{\"type\":\"string\"},\"P3P\":{\"type\":\"string\"},\"X-AspNet-Version\":{\"type\":\"string\"},\"X-Powered-By\":{\"type\":\"string\"},\"Content-Type\":{\"type\":\"string\"},\"Expires\":{\"type\":\"string\"},\"Last-Modified\":{\"type\":\"string\"},\"Content-Length\":{\"type\":\"string\"}}},\"body\":{\"type\":\"object\",\"properties\":{\"value\":{\"type\":\"array\",\"items\":{\"type\":\"object\",\"properties\":{\"@@odata.etag\":{\"type\":\"string\"},\"ItemInternalId\":{\"type\":\"string\"},\"ID\":{\"type\":\"integer\"},\"Title\":{\"type\":\"string\"},\"GroteDivision\":{\"type\":\"object\",\"properties\":{\"@@odata.type\":{\"type\":\"string\"},\"Id\":{\"type\":\"integer\"},\"Value\":{\"type\":\"string\"}}},\"GroteDivision#Id\":{\"type\":\"integer\"},\"Level\":{\"type\":\"object\",\"properties\":{\"@@odata.type\":{\"type\":\"string\"},\"Id\":{\"type\":\"integer\"},\"Value\":{\"type\":\"string\"}}},\"Level#Id\":{\"type\":\"integer\"},\"GroteProcess\":{\"type\":\"object\",\"properties\":{\"@@odata.type\":{\"type\":\"string\"},\"Id\":{\"type\":\"integer\"},\"Value\":{\"type\":\"string\"}}},\"GroteProcess#Id\":{\"type\":\"integer\"},\"GroteReviewers\":{\"type\":\"array\",\"items\":{\"type\":\"object\",\"properties\":{\"@@odata.type\":{\"type\":\"string\"},\"Claims\":{\"type\":\"string\"},\"DisplayName\":{\"type\":\"string\"}},\"required\":[\"@@odata.type\",\"Claims\",\"DisplayName\"]}},\"GroteReviewers@odata.type\":{\"type\":\"string\"},\"GroteReviewers#Claims\":{\"type\":\"array\",\"items\":{\"type\":\"string\"}},\"GroteReviewers#Claims@odata.type\":{\"type\":\"string\"},\"Approver\":{\"type\":\"object\",\"properties\":{\"@@odata.type\":{\"type\":\"string\"},\"Claims\":{\"type\":\"string\"},\"DisplayName\":{\"type\":\"string\"}}},\"Approver#Claims\":{\"type\":\"string\"},\"Distribution\":{\"type\":\"object\",\"properties\":{\"@@odata.type\":{\"type\":\"string\"},\"Claims\":{\"type\":\"string\"},\"DisplayName\":{\"type\":\"string\"}}},\"Distribution#Claims\":{\"type\":\"string\"},\"GroteDivision_x003A_Title\":{\"type\":\"object\",\"properties\":{\"@@odata.type\":{\"type\":\"string\"},\"Id\":{\"type\":\"integer\"},\"Value\":{\"type\":\"string\"}}},\"GroteDivision_x003A_Title#Id\":{\"type\":\"integer\"},\"Process_x003A_Label\":{\"type\":\"object\",\"properties\":{\"@@odata.type\":{\"type\":\"string\"},\"Id\":{\"type\":\"integer\"},\"Value\":{\"type\":\"string\"}}},\"Process_x003A_Label#Id\":{\"type\":\"integer\"},\"Division_x003A_Number\":{\"type\":\"object\",\"properties\":{\"@@odata.type\":{\"type\":\"string\"},\"Id\":{\"type\":\"integer\"},\"Value\":{\"type\":\"string\"}}},\"Division_x003A_Number#Id\":{\"type\":\"integer\"},\"Modified\":{\"type\":\"string\"},\"Created\":{\"type\":\"string\"},\"Author\":{\"type\":\"object\",\"properties\":{\"@@odata.type\":{\"type\":\"string\"},\"Claims\":{\"type\":\"string\"},\"DisplayName\":{\"type\":\"string\"},\"Email\":{},\"Picture\":{},\"Department\":{},\"JobTitle\":{}}},\"Author#Claims\":{\"type\":\"string\"},\"Editor\":{\"type\":\"object\",\"properties\":{\"@@odata.type\":{\"type\":\"string\"},\"Claims\":{\"type\":\"string\"},\"DisplayName\":{\"type\":\"string\"},\"Email\":{\"type\":\"string\"},\"Picture\":{\"type\":\"string\"},\"Department\":{\"type\":\"string\"},\"JobTitle\":{\"type\":\"string\"}}},\"Editor#Claims\":{\"type\":\"string\"},\"{Identifier}\":{\"type\":\"string\"},\"{IsFolder}\":{\"type\":\"boolean\"},\"{Thumbnail}\":{\"type\":\"object\",\"properties\":{\"Large\":{},\"Medium\":{},\"Small\":{}}},\"{Link}\":{\"type\":\"string\"},\"{Name}\":{\"type\":\"string\"},\"{FilenameWithExtension}\":{\"type\":\"string\"},\"{Path}\":{\"type\":\"string\"},\"{FullPath}\":{\"type\":\"string\"},\"{HasAttachments}\":{\"type\":\"boolean\"},\"{VersionNumber}\":{\"type\":\"string\"}},\"required\":[\"@@odata.etag\",\"ItemInternalId\",\"ID\",\"Title\",\"GroteDivision\",\"GroteDivision#Id\",\"Level\",\"Level#Id\",\"GroteProcess\",\"GroteProcess#Id\",\"GroteReviewers\",\"GroteReviewers@odata.type\",\"GroteReviewers#Claims\",\"GroteReviewers#Claims@odata.type\",\"Approver\",\"Approver#Claims\",\"Distribution\",\"Distribution#Claims\",\"GroteDivision_x003A_Title\",\"GroteDivision_x003A_Title#Id\",\"Process_x003A_Label\",\"Process_x003A_Label#Id\",\"Division_x003A_Number\",\"Division_x003A_Number#Id\",\"Modified\",\"Created\",\"Author\",\"Author#Claims\",\"Editor\",\"Editor#Claims\",\"{Identifier}\",\"{IsFolder}\",\"{Thumbnail}\",\"{Link}\",\"{Name}\",\"{FilenameWithExtension}\",\"{Path}\",\"{FullPath}\",\"{HasAttachments}\",\"{VersionNumber}\"]}}}}}}}},\"Get_Distribution_from_WorkFlow_Rules_JSON\":{\"foreach\":\"@body('Parse_JSON:_WorkFlowRules_Distribution')?['value']\",\"actions\":{\"Set_variable:_distributionGroupName\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"5d6ba870-6110-4ea5-9550-740a8c45e506\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"distributionGroupName\",\"value\":\"@items('Get_Distribution_from_WorkFlow_Rules_JSON')?['Distribution#Claims']\"}}},\"runAfter\":{\"Initialize_variable:_distributionGroupName\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"65f59106-9576-4e9c-a9c0-0daadcc795e1\"},\"type\":\"Foreach\"},\"Get_Approvers_from_WorkFlow_Rules_JSON\":{\"foreach\":\"@body('Parse_JSON:_WorkFlowRules_Approvers')?['value']\",\"actions\":{\"Set_variable:_approversGroupName\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"bd53478d-7b3c-4918-b116-37a0888c794e\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"approversGroupName\",\"value\":\"@items('Get_Approvers_from_WorkFlow_Rules_JSON')?['Approver#Claims']\"}}},\"runAfter\":{\"Initialize_variable:_approversGroupName\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"07821a01-5293-4759-aa56-886d5cabccdf\"},\"type\":\"Foreach\"},\"Initialize_variable:_assignedToApprovers\":{\"runAfter\":{\"Initialize_variable:_approversEmails\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"e0eafcd6-fe85-4064-9b28-c3e5703d5aac\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"assignedToApprovers\",\"type\":\"array\",\"value\":\"@split(variables('approversEmails'),';')\"}]}},\"Initialize_variable:_assignedToClaimsApprovers\":{\"runAfter\":{\"Initialize_variable:_assignedToApprovers\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"037d10ce-d8a5-41fe-971e-8245f82fc3c2\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"assignedToClaimsApprovers\",\"type\":\"array\",\"value\":[]}]}},\"Filter_array_using_distributionGroupName\":{\"runAfter\":{\"Get_Distribution_from_WorkFlow_Rules_JSON\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"6c8d3fff-da98-4ac7-91b6-60da757d79ff\"},\"type\":\"Query\",\"inputs\":{\"from\":\"@body('Get_All_Groups')?['d']?['results']\",\"where\":\"@equals(item()?['Title'], variables('distributionGroupName'))\"}},\"Initialize_variable:_distributionGroupID\":{\"runAfter\":{\"Filter_array_using_distributionGroupName\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"b60d2da1-b157-4d31-9fbd-930be5f867a9\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"distributionGroupID\",\"type\":\"integer\",\"value\":\"@body('Filter_array_using_distributionGroupName')?[0]['Id']\"}]}},\"Initialize_variable:_dueDate\":{\"runAfter\":{\"Initialize_variable:_assignedToClaimsApprovers\":[\"Succeeded\"],\"Initialize_variable:_distributionEmails\":[\"Succeeded\"],\"Initialize_variable:_assignedToClaimsReviewers\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"f22a2655-59b8-4463-9a70-4801453d4238\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"dueDate\",\"type\":\"string\",\"value\":\"@{string(addDays(utcNow(),14,'MM/dd/yyyy'))}\"}]}},\"Initialize_variable:_distributionEmails\":{\"runAfter\":{\"Select_Distribution_Emails\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"eba75fc8-2f82-4ac2-a206-5c6c84aa7dcb\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"distributionEmails\",\"type\":\"string\",\"value\":\"@{join(body('Select_Distribution_Emails'),';')}\"}]}},\"Get_Distribution_Group_Members\":{\"runAfter\":{\"Initialize_variable:_distributionGroupID\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"37c00cc7-67d2-46ba-b0ec-d36cff3094ed\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"HttpRequest\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"parameters/method\":\"GET\",\"parameters/uri\":\"_api/web/sitegroups(@{variables('distributionGroupID')})/users\"},\"authentication\":\"@parameters('$authentication')\"}},\"Select_Distribution_Emails\":{\"runAfter\":{\"Get_Distribution_Group_Members\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"211fc3c7-de2e-44b4-bad2-5dd96d6cf069\"},\"type\":\"Select\",\"inputs\":{\"from\":\"@body('Get_Distribution_Group_Members')?['d']?['results']\",\"select\":\"@item()?['Email']\"}},\"Condition:_reviewerType_is_All_or_One\":{\"actions\":{\"Apply_to_each:_Create_Claims_Pairs\":{\"foreach\":\"@split(variables('reviewersEmails'),';')\",\"actions\":{\"Append_to_array_variable\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"53d9c0cf-3134-4c56-8d6a-64126f135eea\"},\"type\":\"AppendToArrayVariable\",\"inputs\":{\"name\":\"assignedToClaimsReviewers\",\"value\":{\"Claims\":\"@{item()}\"}}}},\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"ae4adf06-e206-4a50-aae3-030dbd7efeb0\"},\"type\":\"Foreach\",\"description\":\"Create a Claims key value pair for each reviewer so that all reviewers can be assigned to one task\"},\"Start_and_wait_for_an_approval:_One_Reviewer\":{\"runAfter\":{\"Create_Document_Approval_Task:_One_Reviewer\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"e8cccc2d-8ee4-4c55-acd9-164634eb03f2\"},\"type\":\"OpenApiConnectionWebhook\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_approvals\",\"connectionName\":\"shared_approvals\",\"operationId\":\"StartAndWaitForAnApproval\"},\"parameters\":{\"approvalType\":\"Basic\",\"WebhookApprovalCreationInput/title\":\"A Review Task Has Been Assigned to You for Document @{triggerOutputs()?['body/{Name}']}\",\"WebhookApprovalCreationInput/assignedTo\":\"@{variables('reviewersEmails')};\",\"WebhookApprovalCreationInput/details\":\"A review task has been assigned to the @{variables('reviewersGroupName')} group. Please review the attached document, approve or reject it, and leave any helpful comments you may have.\",\"WebhookApprovalCreationInput/itemLink\":\"@triggerOutputs()?['body/{Link}']\",\"WebhookApprovalCreationInput/itemLinkDescription\":\"@triggerOutputs()?['body/{Name}']\",\"WebhookApprovalCreationInput/requestor\":\"@{triggerOutputs()?['body/Editor/Email']};\",\"WebhookApprovalCreationInput/enableNotifications\":true,\"WebhookApprovalCreationInput/enableReassignment\":false},\"authentication\":\"@parameters('$authentication')\"}},\"Create_Document_Approval_Task:_One_Reviewer\":{\"runAfter\":{\"Apply_to_each:_Create_Claims_Pairs\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"17626f0e-d55c-49cd-9af2-0c6f9b4b888c\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"PostItem\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"c01b2ae7-eea0-439c-9180-6fd000ad0dd8\",\"item/Title\":\"@{triggerOutputs()?['body/{Name}']} - Please Review the Document\",\"item/Assigned_x0020_To\":\"@variables('assignedToClaimsReviewers')\",\"item/TaskHistory\":\"@{variables('approvalHistory')}\\n\",\"item/DueDate\":\"@variables('dueDate')\",\"item/Progress/Value\":\"Submitted for Review\"},\"authentication\":\"@parameters('$authentication')\"}},\"Condition:_If_Document_is_Approved_or_Rejected\":{\"actions\":{\"Apply_to_each\":{\"foreach\":\"@outputs('Start_and_wait_for_an_approval:_One_Reviewer')?['body/responses']\",\"actions\":{\"Update_approvalHistory:_Passed_Review\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"310428c6-a7cf-4eb6-b233-a3a59d30cc52\"},\"type\":\"AppendToStringVariable\",\"inputs\":{\"name\":\"approvalHistory\",\"value\":\"@{formatDateTime(converttimezone(utcNow(),'UTC','Eastern Standard Time'),'MM/dd/yyyy hh:mm tt')} - Document Passed Review by @{items('Apply_to_each')?['responder/displayName']} \\nComments: @{items('Apply_to_each')?['comments']}\\n\\n@{formatDateTime(converttimezone(utcNow(),'UTC','Eastern Standard Time'),'MM/dd/yyyy hh:mm tt')} - Document Submitted for Approval \\n\\n\"}},\"Update_Document_Task:_Passed_Review\":{\"runAfter\":{\"Update_approvalHistory:_Passed_Review\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"c97c9258-a893-4ca3-9c0c-c8a5a071fcbf\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"PatchItem\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"c01b2ae7-eea0-439c-9180-6fd000ad0dd8\",\"id\":\"@outputs('Create_Document_Approval_Task:_One_Reviewer')?['body/ID']\",\"item/Title\":\"@outputs('Create_Document_Approval_Task:_One_Reviewer')?['body/Title']\",\"item/TaskHistory\":\"@variables('approvalHistory')\",\"item/Progress/Value\":\"Submitted for Approval\"},\"authentication\":\"@parameters('$authentication')\"}}},\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"13f1e16e-897f-49b9-bdef-3a73086fd6b7\"},\"type\":\"Foreach\"},\"Start_and_wait_for_an_approval:_One_Approver\":{\"runAfter\":{\"Apply_to_each\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"e8cccc2d-8ee4-4c55-acd9-164634eb03f2\"},\"type\":\"OpenApiConnectionWebhook\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_approvals\",\"connectionName\":\"shared_approvals\",\"operationId\":\"StartAndWaitForAnApproval\"},\"parameters\":{\"approvalType\":\"Basic\",\"WebhookApprovalCreationInput/title\":\"A Review Task Has Been Assigned to You for Document @{triggerOutputs()?['body/{Name}']}\",\"WebhookApprovalCreationInput/assignedTo\":\"@{variables('approversEmails')};;\",\"WebhookApprovalCreationInput/details\":\"An approval task has been assigned to the @{variables('approversGroupName')} group. Please review the attached document, approve or reject it, and leave any helpful comments you may have.\",\"WebhookApprovalCreationInput/itemLink\":\"@triggerOutputs()?['body/{Link}']\",\"WebhookApprovalCreationInput/itemLinkDescription\":\"@triggerOutputs()?['body/{Name}']\",\"WebhookApprovalCreationInput/requestor\":\"@{triggerOutputs()?['body/Editor/Email']};\",\"WebhookApprovalCreationInput/enableNotifications\":true,\"WebhookApprovalCreationInput/enableReassignment\":false},\"authentication\":\"@parameters('$authentication')\"}},\"Condition:_If_Document_is_Approved_or_Rejected_2\":{\"actions\":{\"Send_an_email_notification_(V3)\":{\"runAfter\":{\"Apply_to_each_2\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"c3e0a39b-14de-4115-b2e3-790957ef8e45\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sendmail\",\"connectionName\":\"shared_sendmail\",\"operationId\":\"SendEmailV3\"},\"parameters\":{\"request/to\":\"@{outputs('Create_Document_Approval_Task:_One_Reviewer')?['body/Editor/Email']};\",\"request/subject\":\"Your Document Has Been Approved: @{triggerOutputs()?['body/{Name}']}\",\"request/text\":\"<p>Your document @{triggerOutputs()?['body/{Name}']} has been reviewed and approved.&nbsp;</p>\"},\"authentication\":\"@parameters('$authentication')\"}},\"Set_content_approval_status:_Approved\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"c5e7114b-0bc7-4678-b9ed-8b82d89b21a2\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"SetApprovalStatus\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"bc460a20-664c-49e7-bfe7-2843495da717\",\"id\":\"@triggerOutputs()?['body/ID']\",\"approvalAction\":\"Approve\",\"comments\":\"\",\"entityTag\":\"@outputs('Get_file_metadata')?['body/ETag']\"},\"authentication\":\"@parameters('$authentication')\"}},\"Apply_to_each_2\":{\"foreach\":\"@outputs('Start_and_wait_for_an_approval:_One_Approver')?['body/responses']\",\"actions\":{\"Append_approvalHistory:_Passed_Approval\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"4a848882-6cd2-40ff-9111-a94cff61ef8a\"},\"type\":\"AppendToStringVariable\",\"inputs\":{\"name\":\"approvalHistory\",\"value\":\"@{formatDateTime(converttimezone(utcNow(), 'UTC', 'Eastern Standard Time'), 'MM/dd/yyyy hh:mm tt')} - Document Passed Approval by @{items('Apply_to_each_2')?['responder/displayName']} \\nComments: @{items('Apply_to_each_2')?['comments']}\"}},\"Update_Document_Task:_Passed_Approval\":{\"runAfter\":{\"Append_approvalHistory:_Passed_Approval\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"f3726863-3d74-4ba7-a780-730760ae8571\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"PatchItem\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"c01b2ae7-eea0-439c-9180-6fd000ad0dd8\",\"id\":\"@outputs('Create_Document_Approval_Task:_One_Reviewer')?['body/ID']\",\"item/Title\":\"@outputs('Create_Document_Approval_Task:_One_Reviewer')?['body/Title']\",\"item/TaskHistory\":\"@variables('approvalHistory')\",\"item/Progress/Value\":\"Approved\"},\"authentication\":\"@parameters('$authentication')\"}}},\"runAfter\":{\"Set_content_approval_status:_Approved\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"716a2532-a1f1-4723-9e5e-6008d12ffa7c\"},\"type\":\"Foreach\"}},\"runAfter\":{\"Start_and_wait_for_an_approval:_One_Approver\":[\"Succeeded\"]},\"expression\":{\"equals\":[\"@outputs('Start_and_wait_for_an_approval:_One_Approver')?['body/outcome']\",\"Approve\"]},\"metadata\":{\"operationMetadataId\":\"06a5be57-3481-40da-9e2a-d7a885a9f3ac\"},\"type\":\"If\"}},\"runAfter\":{\"Set_content_approval_status:_Submitted\":[\"Succeeded\"]},\"expression\":{\"equals\":[\"@outputs('Start_and_wait_for_an_approval:_One_Reviewer')?['body/outcome']\",\"Approve\"]},\"metadata\":{\"operationMetadataId\":\"06a5be57-3481-40da-9e2a-d7a885a9f3ac\"},\"type\":\"If\"},\"Set_content_approval_status:_Submitted\":{\"runAfter\":{\"Start_and_wait_for_an_approval:_One_Reviewer\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"c5e7114b-0bc7-4678-b9ed-8b82d89b21a2\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"SetApprovalStatus\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"bc460a20-664c-49e7-bfe7-2843495da717\",\"id\":\"@triggerOutputs()?['body/ID']\",\"approvalAction\":\"Submit\",\"comments\":\"\",\"entityTag\":\"@outputs('Get_file_metadata')?['body/ETag']\"},\"authentication\":\"@parameters('$authentication')\"}}},\"runAfter\":{\"Initialize_variable:_approvalHistory\":[\"Succeeded\"]},\"else\":{\"actions\":{\"Apply_to_each:_Create_Approval_Task_for_Each_Reviewer\":{\"foreach\":\"@split(variables('reviewersEmails'),';')\",\"actions\":{\"Create_Document_Approval_Task:_All_Reviewers\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"17626f0e-d55c-49cd-9af2-0c6f9b4b888c\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"PostItem\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"c01b2ae7-eea0-439c-9180-6fd000ad0dd8\",\"item/Title\":\"@{triggerOutputs()?['body/{Name}']} - Please Review the Document\",\"item/Assigned_x0020_To\":\"@item('Apply_to_each:_Create_Approval_Task_for_Each_Reviewer')\",\"item/TaskHistory\":\"@{formatDateTime(converttimezone(utcNow(), 'UTC', 'Eastern Standard Time'), 'MM/dd/yyyy hh:mm tt')} - Document Submitted for Review Process \\n\",\"item/DueDate\":\"@variables('dueDate')\",\"item/Progress/Value\":\"Submitted for Review\"},\"authentication\":\"@parameters('$authentication')\"}}},\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"3d3315c3-50b5-4fe1-a597-e03cb49faa7f\"},\"type\":\"Foreach\"},\"Start_and_wait_for_an_approval:_All_Reviewers\":{\"runAfter\":{\"Apply_to_each:_Create_Approval_Task_for_Each_Reviewer\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"a4c1a296-9017-4b58-8d12-000dc3860cd5\"},\"type\":\"OpenApiConnectionWebhook\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_approvals\",\"connectionName\":\"shared_approvals\",\"operationId\":\"StartAndWaitForAnApproval\"},\"parameters\":{\"approvalType\":\"BasicAwaitAll\",\"WebhookApprovalCreationInput/title\":\"A Review Task Has Been Assigned to You for Document @{triggerOutputs()?['body/{Name}']}\",\"WebhookApprovalCreationInput/assignedTo\":\"@{variables('reviewersEmails')};\",\"WebhookApprovalCreationInput/details\":\"A review task has been assigned to the @{variables('reviewersGroupName')} group. Please review the attached document, approve or reject it, and leave any helpful comments you may have.\",\"WebhookApprovalCreationInput/itemLink\":\"@triggerOutputs()?['body/{Link}']\",\"WebhookApprovalCreationInput/itemLinkDescription\":\"@triggerOutputs()?['body/{Name}']\",\"WebhookApprovalCreationInput/requestor\":\"@{triggerOutputs()?['body/Editor/Email']};\",\"WebhookApprovalCreationInput/enableNotifications\":true,\"WebhookApprovalCreationInput/enableReassignment\":false},\"authentication\":\"@parameters('$authentication')\"}}}},\"expression\":{\"equals\":[\"@variables('reviewerType')\",\"One\"]},\"metadata\":{\"operationMetadataId\":\"41d84f64-ce77-4690-841a-cfcaff9710cc\"},\"type\":\"If\"},\"Initialize_variable:_approvalHistory\":{\"runAfter\":{\"Initialize_variable:_dueDate\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"b725cb18-842e-44cc-9969-9952c1279d40\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"approvalHistory\",\"type\":\"string\",\"value\":\"@{formatDateTime(converttimezone(utcNow(),'UTC','Eastern Standard Time'),'MM/dd/yyyy hh:mm tt')} - Document Submitted for Review Process \\n\\n\"}]}}}}},\"schemaVersion\":\"1.0.0.0\"}","createdBy":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","modifiedBy":"cea9be8a-91c2-eb11-8235-0022481d5f87","ownerId":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","owningBusinessUnit":"ee0a9aec-b63d-e911-a81c-000d3a11eefe","owningUser":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff"},{"name":"GDMS_Retrigger","createdOn":"2023-07-31T04:02:29Z","modifiedOn":"2023-08-03T08:40:29Z","workflowId":"31f0690b-572f-ee11-bdf3-000d3a1b983d","resourceId":"83f53419-47ed-48f9-8dca-e7cb33273f67","stateCode":"Published","statusCode":"Published","definition":"{\"properties\":{\"connectionReferences\":{\"shared_approvals\":{\"runtimeSource\":\"embedded\",\"connection\":{\"name\":\"4108f82f6250453eb5ddddeb83641672\",\"connectionReferenceLogicalName\":\"spo_sharedapprovals_4eb02\"},\"api\":{\"name\":\"shared_approvals\"}},\"shared_sharepointonline\":{\"runtimeSource\":\"embedded\",\"connection\":{\"name\":\"shared-sharepointonl-947cca0b-9618-4af1-b27f-1d5711ca17b2\",\"connectionReferenceLogicalName\":\"spo_sharedsharepointonline_e3ac5\"},\"api\":{\"name\":\"shared_sharepointonline\"}},\"shared_office365_1\":{\"runtimeSource\":\"embedded\",\"connection\":{\"name\":\"shared-office365-5bd6a51a-7202-4b32-b2cb-5d99c414fe6e\",\"connectionReferenceLogicalName\":\"spo_sharedoffice365_5e3dc\"},\"api\":{\"name\":\"shared_office365\"}},\"shared_office365\":{\"runtimeSource\":\"embedded\",\"connection\":{\"name\":\"shared-office365-359508f2-3484-4ea4-8f85-24831ac9d9fc\",\"connectionReferenceLogicalName\":\"spo_sharedoffice365_36d3c\"},\"api\":{\"name\":\"shared_office365\"}}},\"definition\":{\"$schema\":\"https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"$connections\":{\"defaultValue\":{},\"type\":\"Object\"},\"$authentication\":{\"defaultValue\":{},\"type\":\"SecureObject\"}},\"triggers\":{\"When_item_created_in_WF_Retrigger\":{\"recurrence\":{\"frequency\":\"Minute\",\"interval\":1},\"splitOn\":\"@triggerOutputs()?['body/value']\",\"metadata\":{\"operationMetadataId\":\"3b9e0802-cd6f-4f5c-adc1-36d7bb5ff19a\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"GetOnNewItems\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"4c86833c-1920-4dda-bdf8-c86549312eff\"},\"authentication\":\"@parameters('$authentication')\"}}},\"actions\":{\"Wait_for_an_approval\":{\"runAfter\":{\"Create_RevApp\":[\"Succeeded\"]},\"limit\":{\"timeout\":\"P29D\"},\"metadata\":{\"operationMetadataId\":\"6ad3248c-9147-4e20-a590-4b0d069c4116\"},\"type\":\"OpenApiConnectionWebhook\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_approvals\",\"connectionName\":\"shared_approvals\",\"operationId\":\"WaitForAnApproval\"},\"parameters\":{\"approvalName\":\"@triggerOutputs()?['body/ApprovalID']\"},\"authentication\":\"@parameters('$authentication')\"}},\"Create_FileName\":{\"runAfter\":{\"Get_ORA_for_document\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"7b7693b6-d86a-415a-ab7e-8bbf4245cfb6\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"FileName\",\"type\":\"string\",\"value\":\"@triggerOutputs()?['body/FileName']\"}]}},\"Create_DocumentName\":{\"runAfter\":{\"Create_FileName\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"a001c38b-32e9-434e-8f48-215c946d8db7\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"DocumentName\",\"type\":\"string\",\"value\":\"@triggerOutputs()?['body/DocumentName']\"}]}},\"Created_StartedBy\":{\"runAfter\":{\"Create_DocumentName\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"3f07a5be-f3ae-493e-afc2-4fc2007f5825\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"StartedBy\",\"type\":\"string\",\"value\":\"@triggerOutputs()?['body/StartedBy']\"}]}},\"Create_DocumentType\":{\"runAfter\":{\"Created_StartedBy\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"2fb9ed2e-7fc8-4181-a877-5eef24b862ef\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"DocumentType\",\"type\":\"string\",\"value\":\"@triggerOutputs()?['body/DocumentType']\"}]}},\"Switch\":{\"runAfter\":{\"Wait_for_an_approval\":[\"Succeeded\"]},\"cases\":{\"Originate\":{\"case\":\"Originate\",\"actions\":{\"Outcome_of_Origination_Approval\":{\"actions\":{\"Update_Active_Approval_Originator\":{\"runAfter\":{},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"PatchItem\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"9139a2aa-626a-4e02-becc-60943ad79ccc\",\"id\":\"@triggerOutputs()?['body/ActiveApprovalID']\",\"item/Title\":\"@triggerOutputs()?['body/FileName']\",\"item/Status\":\"Awaiting Approval Originator\",\"item/Division\":\"@triggerOutputs()?['body/Division']\",\"item/Process\":\"@triggerOutputs()?['body/Process']\"},\"authentication\":\"@parameters('$authentication')\"}},\"Notify_Originator_(Originate_Approve)\":{\"runAfter\":{\"Update_Active_Approval_Originator\":[\"Succeeded\"]},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_office365\",\"connectionName\":\"shared_office365_1\",\"operationId\":\"SendEmailV2\"},\"parameters\":{\"emailMessage/To\":\"@triggerOutputs()?['body/StartedBy']\",\"emailMessage/Subject\":\"GDMS | Document Origination Approved\",\"emailMessage/Body\":\"<p><em>Please do not reply, this is an automated message and responses to this email will not be monitored.</em><br>\\n<br>\\n<strong>STATUS</strong><br>\\n----------------<br>\\n<strong>Origination</strong><br>\\n<br>\\nReviewal<br>\\n<br>\\n<em>Approval</em><br>\\n----------------<br>\\n<br>\\nYour originated document, @{triggerOutputs()?['body/{Name}']} (@{triggerOutputs()?['body/GroteDocumentDescription']}), has been sent to the review stage and is now awaiting reviewal from one of the process reviewers.<br>\\n<br>\\nPlease note that this process may take some time, and you will be notified once the document furthers along in the process.</p>\",\"emailMessage/Importance\":\"Normal\"},\"authentication\":\"@parameters('$authentication')\"}},\"Get-Create_Originators_list_for_document\":{\"foreach\":\"@outputs('Get_ORA_for_document')?['body/value']\",\"actions\":{\"Select_2\":{\"runAfter\":{},\"type\":\"Select\",\"inputs\":{\"from\":\"@items('Get-Create_Originators_list_for_document')?['Reviewers']\",\"select\":\"@item()['Email']\"}},\"Join_2\":{\"runAfter\":{\"Select_2\":[\"Succeeded\"]},\"type\":\"Join\",\"inputs\":{\"from\":\"@body('Select_2')\",\"joinWith\":\";\"}},\"Set_Reviewers\":{\"runAfter\":{\"Join_2\":[\"Succeeded\"]},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"Reviewers\",\"value\":\"@body('Join_2')\"}}},\"runAfter\":{\"Notify_Originator_(Originate_Approve)\":[\"Succeeded\"]},\"type\":\"Foreach\"},\"Set_OrigApp_to_Origination_Approver\":{\"foreach\":\"@outputs('Wait_for_an_approval')?['body/responses']\",\"actions\":{\"Set_OrigApp\":{\"runAfter\":{},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"OrigApp\",\"value\":\"@items('Set_OrigApp_to_Origination_Approver')?['responder/displayName']\"}}},\"runAfter\":{\"Get-Create_Originators_list_for_document\":[\"Succeeded\"]},\"type\":\"Foreach\"},\"Notify_Reviewer\":{\"runAfter\":{\"Set_OrigApp_to_Origination_Approver\":[\"Succeeded\"]},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_office365\",\"connectionName\":\"shared_office365\",\"operationId\":\"SendEmailV2\"},\"parameters\":{\"emailMessage/To\":\"@variables('Reviewers')\",\"emailMessage/Subject\":\"GDMS | New Document to Review\",\"emailMessage/Body\":\"<p><em>Please do not reply, this is an automated message and responses to this email will not be monitored.</em><br>\\n<br>\\nYou have a new document to review. Please visit the <strong>Approvals </strong>tab via <strong>Teams </strong>to view the request.<br>\\n<br>\\n<strong>Document Name:</strong> @{triggerOutputs()?['body/{Name}']} <strong>|</strong> @{triggerOutputs()?['body/GroteDocumentDescription']}<br>\\n<strong>Originated By:</strong> @{triggerOutputs()?['body/Author/DisplayName']}</p>\",\"emailMessage/Importance\":\"Normal\"},\"authentication\":\"@parameters('$authentication')\"}},\"Reviewer_Approval\":{\"runAfter\":{\"Notify_Reviewer\":[\"Succeeded\"]},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_approvals\",\"connectionName\":\"shared_approvals\",\"operationId\":\"CreateAnApproval\"},\"parameters\":{\"approvalType\":\"Basic\",\"ApprovalCreationInput/title\":\"GDMS | Document Review | @{triggerOutputs()?['body/GroteDocumentDescription']}\",\"ApprovalCreationInput/assignedTo\":\"@{variables('Reviewers')};\",\"ApprovalCreationInput/details\":\"**Grote Document Management System**\\n_You have a new document to review._\\n\\n**Name:** @{triggerOutputs()?['body/{Name}']} | @{triggerOutputs()?['body/DocumentName']}\\n**Document Type:** @{triggerOutputs()?['body/DocumentType']}\\n**Division:** @{triggerOutputs()?['body/Division']}\\n**Process:**   @{triggerOutputs()?['body/Process']}\\n\\n**Originated By:** @{triggerOutputs()?['body/Author/DisplayName']}\\n**Origination Approved By:** @{variables('OrigApp')}\",\"ApprovalCreationInput/itemLink\":\"@triggerOutputs()?['body/{Link}']\",\"ApprovalCreationInput/itemLinkDescription\":\"View Document\",\"ApprovalCreationInput/requestor\":\"@{triggerOutputs()?['body/StartedBy']};\",\"ApprovalCreationInput/enableNotifications\":false,\"ApprovalCreationInput/enableReassignment\":false},\"authentication\":\"@parameters('$authentication')\"}},\"Wait_for_an_Reviewer_Approval\":{\"runAfter\":{\"Reviewer_Approval\":[\"Succeeded\"]},\"limit\":{\"timeout\":\"P29D\"},\"type\":\"OpenApiConnectionWebhook\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_approvals\",\"connectionName\":\"shared_approvals\",\"operationId\":\"WaitForAnApproval\"},\"parameters\":{\"approvalName\":\"@outputs('Reviewer_Approval')?['body/name']\"},\"authentication\":\"@parameters('$authentication')\"}},\"Outcome_of_Reviewer_Approval_2\":{\"actions\":{\"Update_Active_Approval_Approver_2\":{\"runAfter\":{},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"PatchItem\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"9139a2aa-626a-4e02-becc-60943ad79ccc\",\"id\":\"@variables('ActiveApprovalID')\",\"item/Title\":\"@triggerOutputs()?['body/FileName']\",\"item/Status\":\"Awaiting Approver Approval\",\"item/Division\":\"@triggerOutputs()?['body/Division']\",\"item/Process\":\"@triggerOutputs()?['body/Process']\"},\"authentication\":\"@parameters('$authentication')\"}},\"Notify_Originator_(Review_Approve)_2\":{\"runAfter\":{\"Update_Active_Approval_Approver_2\":[\"Succeeded\"]},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_office365\",\"connectionName\":\"shared_office365_1\",\"operationId\":\"SendEmailV2\"},\"parameters\":{\"emailMessage/To\":\"@triggerOutputs()?['body/Author/Email']\",\"emailMessage/Subject\":\"GDMS | Document Approval\",\"emailMessage/Body\":\"<p><em>Please do not reply, this is an automated message and responses to this email will not be monitored.</em><br>\\n<br>\\n<strong>STATUS</strong><br>\\n----------------<br>\\n<strong>Origination</strong><br>\\n<br>\\n<strong>Reviewal</strong><br>\\n<br>\\nApproval<br>\\n----------------<br>\\n<br>\\nYour originated document, @{triggerOutputs()?['body/{Name}']} (@{triggerOutputs()?['body/GroteDocumentDescription']}), has been reviewed and sent to the approval stage and is now awaiting approval from one of the process approvers.<br>\\n<br>\\nPlease note that this process may take some time, and you will be notified once the document furthers along in the process.</p>\",\"emailMessage/Importance\":\"Normal\"},\"authentication\":\"@parameters('$authentication')\"}},\"Get-Create_Approvers_list_for_document_2\":{\"foreach\":\"@outputs('Get_ORA_for_document')?['body/value']\",\"actions\":{\"Select_3\":{\"runAfter\":{},\"type\":\"Select\",\"inputs\":{\"from\":\"@items('Get-Create_Approvers_list_for_document_2')?['Approvers']\",\"select\":\"@item()?['Email']\"}},\"Join_3\":{\"runAfter\":{\"Select_3\":[\"Succeeded\"]},\"type\":\"Join\",\"inputs\":{\"from\":\"@body('Select_3')\",\"joinWith\":\";\"}},\"Set_Approvers_2\":{\"runAfter\":{\"Join_3\":[\"Succeeded\"]},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"Approvers\",\"value\":\"@body('Join_3')\"}}},\"runAfter\":{\"Notify_Originator_(Review_Approve)_2\":[\"Succeeded\"]},\"type\":\"Foreach\"},\"Set_RevApp_to_Reviewer_Approver_2\":{\"foreach\":\"@outputs('Wait_for_an_approval')?['body/responses']\",\"actions\":{\"Set_RevApp_2\":{\"runAfter\":{},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"RevApp\",\"value\":\"@items('Set_RevApp_to_Reviewer_Approver_2')?['responder/displayName']\"}}},\"runAfter\":{\"Get-Create_Approvers_list_for_document_2\":[\"Succeeded\"]},\"type\":\"Foreach\"},\"Notify_Approver_2\":{\"runAfter\":{\"Set_RevApp_to_Reviewer_Approver_2\":[\"Succeeded\"]},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_office365\",\"connectionName\":\"shared_office365_1\",\"operationId\":\"SendEmailV2\"},\"parameters\":{\"emailMessage/To\":\"@variables('Approvers')\",\"emailMessage/Subject\":\"GDMS | New Document to Approve\",\"emailMessage/Body\":\"<p>Please do not reply, this is an automated message and responses to this email will not be monitored.<br>\\n<br>\\nYou have a new document to approve. Please visit the Approvals tab via Teams to view the request.<br>\\n<br>\\nDocument Name: @{triggerOutputs()?['body/{Name}']} | @{triggerOutputs()?['body/GroteDocumentDescription']}<br>\\nOriginated By: @{triggerOutputs()?['body/Author/DisplayName']}<br>\\nReviewed By: @{variables('RevApp')}</p>\",\"emailMessage/Importance\":\"Normal\"},\"authentication\":\"@parameters('$authentication')\"}},\"Approver_Approval_2\":{\"runAfter\":{\"Notify_Approver_2\":[\"Succeeded\"]},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_approvals\",\"connectionName\":\"shared_approvals\",\"operationId\":\"CreateAnApproval\"},\"parameters\":{\"approvalType\":\"Basic\",\"ApprovalCreationInput/title\":\"GDMS | Document Approval | @{triggerOutputs()?['body/GroteDocumentDescription']}\",\"ApprovalCreationInput/assignedTo\":\"@{variables('Approvers')};\",\"ApprovalCreationInput/details\":\"**Grote Document Management System**\\n_You have a new document to approve._\\n\\n**Name:** @{triggerOutputs()?['body/{Name}']} | @{triggerOutputs()?['body/GroteDocumentDescription']}\\n**Document Type:** @{triggerOutputs()?['body/GroteDocumentType/Value']}\\n**Division:** @{triggerOutputs()?['body/GroteDivision/Value']}\\n**Process:**   @{triggerOutputs()?['body/GroteProcess/Value']}\\n\\n**Originated By:** @{triggerOutputs()?['body/Author/DisplayName']}\\n**Origination Approved By:** @{triggerOutputs()?['body/StartedBy']}\\n**Reviewed By:** @{variables('AppApp')}\",\"ApprovalCreationInput/itemLink\":\"@triggerOutputs()?['body/{Link}']\",\"ApprovalCreationInput/itemLinkDescription\":\"View Document\",\"ApprovalCreationInput/requestor\":\"@{triggerOutputs()?['body/StartedBy']};\",\"ApprovalCreationInput/enableNotifications\":false,\"ApprovalCreationInput/enableReassignment\":false},\"authentication\":\"@parameters('$authentication')\"}},\"Wait_for_an_Approver_Approval_2\":{\"runAfter\":{\"Approver_Approval_2\":[\"Succeeded\"]},\"limit\":{\"timeout\":\"P29D\"},\"type\":\"OpenApiConnectionWebhook\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_approvals\",\"connectionName\":\"shared_approvals\",\"operationId\":\"WaitForAnApproval\"},\"parameters\":{\"approvalName\":\"@outputs('Approver_Approval_2')?['body/name']\"},\"authentication\":\"@parameters('$authentication')\"}},\"Set_AppApp_to_Approval_Approver_2\":{\"foreach\":\"@outputs('Wait_for_an_Approver_Approval_2')?['body/responses']\",\"actions\":{\"Set_AppApp_2\":{\"runAfter\":{},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"AppApp\",\"value\":\"@items('Set_AppApp_to_Approval_Approver_2')?['responder/displayName']\"}}},\"runAfter\":{\"Wait_for_an_Approver_Approval_2\":[\"Succeeded\"]},\"type\":\"Foreach\"},\"Outcome_of_Approver_Approval_3\":{\"actions\":{\"Delete_Active_Approval_Approver_3\":{\"runAfter\":{},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"DeleteItem\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"9139a2aa-626a-4e02-becc-60943ad79ccc\",\"id\":\"@variables('ActiveApprovalID')\"},\"authentication\":\"@parameters('$authentication')\"}},\"Set_content_approval_status_3\":{\"runAfter\":{\"Delete_Active_Approval_Approver_3\":[\"Succeeded\"]},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"SetApprovalStatus\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"bc460a20-664c-49e7-bfe7-2843495da717\",\"id\":\"@variables('FileID')\",\"approvalAction\":\"Approve\",\"comments\":\"\",\"entityTag\":\"@triggerOutputs()?['body/ETag']\"},\"authentication\":\"@parameters('$authentication')\"}},\"Notify_Organizer_3\":{\"runAfter\":{\"Set_content_approval_status_3\":[\"Succeeded\"]},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_office365\",\"connectionName\":\"shared_office365\",\"operationId\":\"SendEmailV2\"},\"parameters\":{\"emailMessage/To\":\"@variables('StartedBy')\",\"emailMessage/Subject\":\"GDMS | Document Approved \",\"emailMessage/Body\":\"<p><em>Please do not reply, this is an automated message and responses to this email will not be monitored.</em><br>\\n<br>\\n<strong>STATUS</strong><br>\\n----------------<br>\\n<strong>Origination</strong><br>\\n<br>\\n<strong>Approval</strong><br>\\n<br>\\n<strong>Reviewal</strong><br>\\n----------------<br>\\n<br>\\nYour originated document, @{triggerOutputs()?['body/{Name}']} (@{triggerOutputs()?['body/GroteDocumentDescription']}), has been approved. The document has been published and can be found at the attached link. @{triggerOutputs()?['body/{Link}']}</p>\",\"emailMessage/Importance\":\"Normal\"},\"authentication\":\"@parameters('$authentication')\"}}},\"runAfter\":{\"Set_AppApp_to_Approval_Approver_2\":[\"Succeeded\"]},\"else\":{\"actions\":{\"Approval_Reject_Email_3\":{\"runAfter\":{},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_office365\",\"connectionName\":\"shared_office365\",\"operationId\":\"SendEmailV2\"},\"parameters\":{\"emailMessage/To\":\"@variables('StartedBy')\",\"emailMessage/Subject\":\"GDMS | Document Rejected\",\"emailMessage/Body\":\"<p><em>Please do not reply, this is an automated message and responses to this email will not be monitored.</em><br>\\n<br>\\nSTATUS<br>\\n----------------<br>\\n<strong>Origination</strong><br>\\n<br>\\n<strong>Reviewal</strong><br>\\n<br>\\n<strong>Approval</strong><br>\\n----------------<br>\\n<br>\\nYour originated document, @{triggerOutputs()?['body/{Name}']} (@{triggerOutputs()?['body/GroteDocumentDescription']}), has been rejected at the approval stage.<br>\\n</p>\",\"emailMessage/Importance\":\"Normal\"},\"authentication\":\"@parameters('$authentication')\"}},\"Delete_Doc_Number_3\":{\"runAfter\":{\"Approval_Reject_Email_3\":[\"Succeeded\"]},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"DeleteItem\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"66953198-05c9-40f9-bdfa-e0744efc90cc\",\"id\":\"@variables('DocNumID')\"},\"authentication\":\"@parameters('$authentication')\"}},\"Delete_Active_Approval_Reviewer_5\":{\"runAfter\":{\"Delete_Doc_Number_3\":[\"Succeeded\"]},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"DeleteItem\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"9139a2aa-626a-4e02-becc-60943ad79ccc\",\"id\":\"@variables('ActiveApprovalID')\"},\"authentication\":\"@parameters('$authentication')\"}},\"Delete_file_6\":{\"runAfter\":{\"Delete_Active_Approval_Reviewer_5\":[\"Succeeded\"]},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"DeleteFile\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"id\":\"@variables('FileID')\"},\"authentication\":\"@parameters('$authentication')\"}}}},\"expression\":{\"equals\":[\"@outputs('Wait_for_an_Approver_Approval_2')?['body/outcome']\",\"Approve\"]},\"type\":\"If\"},\"Delete_this_Retrigger_2\":{\"runAfter\":{\"Wait_for_an_Approver_Approval_2\":[\"TimedOut\"]},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"DeleteItem\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"4c86833c-1920-4dda-bdf8-c86549312eff\",\"id\":\"@triggerOutputs()?['body/ID']\"},\"authentication\":\"@parameters('$authentication')\"}},\"Timeout_Retrigger_3\":{\"runAfter\":{\"Delete_this_Retrigger_2\":[\"Succeeded\"]},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"PostItem\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"4c86833c-1920-4dda-bdf8-c86549312eff\",\"item/FileName\":\"@triggerOutputs()?['body/FileName']\",\"item/DocumentName\":\"@triggerOutputs()?['body/DocumentName']\",\"item/StartedBy\":\"@triggerOutputs()?['body/StartedBy']\",\"item/DocumentType\":\"@triggerOutputs()?['body/DocumentType']\",\"item/RetriggerType\":\"Create\",\"item/CurrentStageWaiting\":\"Approve\",\"item/Division\":\"@triggerOutputs()?['body/Division']\",\"item/Process\":\"@triggerOutputs()?['body/Process']\",\"item/DocumentNumber\":\"@triggerOutputs()?['body/DocumentNumber']\",\"item/ItemID\":\"@triggerOutputs()?['body/ItemID']\",\"item/DocNumberID\":\"@triggerOutputs()?['body/DocNumberID']\",\"item/ActiveApprovalID\":\"@triggerOutputs()?['body/ActiveApprovalID']\",\"item/ETag\":\"@triggerOutputs()?['body/ETag']\",\"item/ApprovalID\":\"@outputs('Approver_Approval_2')?['body/name']\"},\"authentication\":\"@parameters('$authentication')\"}}},\"runAfter\":{\"Wait_for_an_Reviewer_Approval\":[\"Succeeded\"]},\"else\":{\"actions\":{\"Notify_Originator_(Review_Reject)_2\":{\"runAfter\":{},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_office365\",\"connectionName\":\"shared_office365_1\",\"operationId\":\"SendEmailV2\"},\"parameters\":{\"emailMessage/To\":\"@triggerOutputs()?['body/Author/Email']\",\"emailMessage/Subject\":\"GDMS | Document Rejected\",\"emailMessage/Body\":\"<p><em>Please do not reply, this is an automated message and responses to this email will not be monitored.</em><br>\\n<br>\\n<strong>STATUS</strong><br>\\n----------------<br>\\n<strong>Origination</strong><br>\\n<br>\\n<strong>Reviewal</strong><br>\\n<br>\\nApproval<br>\\n----------------<br>\\n<br>\\nYour originated document, @{triggerOutputs()?['body/{Name}']} (@{triggerOutputs()?['body/GroteDocumentDescription']}), has been rejected at the reviewal stage.<br>\\n</p>\",\"emailMessage/Importance\":\"Normal\"},\"authentication\":\"@parameters('$authentication')\"}},\"Delete_DocNumber_3\":{\"runAfter\":{\"Notify_Originator_(Review_Reject)_2\":[\"Succeeded\"]},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"DeleteItem\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"66953198-05c9-40f9-bdfa-e0744efc90cc\",\"id\":\"@variables('DocNumID')\"},\"authentication\":\"@parameters('$authentication')\"}},\"Delete_Active_Approval_Reviewer_4\":{\"runAfter\":{\"Delete_DocNumber_3\":[\"Succeeded\"]},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"DeleteItem\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"9139a2aa-626a-4e02-becc-60943ad79ccc\",\"id\":\"@variables('ActiveApprovalID')\"},\"authentication\":\"@parameters('$authentication')\"}},\"Delete_file_5\":{\"runAfter\":{\"Delete_Active_Approval_Reviewer_4\":[\"Succeeded\"]},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"DeleteFile\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"id\":\"d\"},\"authentication\":\"@parameters('$authentication')\"}}}},\"expression\":{\"equals\":[\"@outputs('Wait_for_an_approval')?['body/outcome']\",\"Approve\"]},\"type\":\"If\"},\"Delete_this_Retrigger_3\":{\"runAfter\":{\"Wait_for_an_Reviewer_Approval\":[\"TimedOut\"]},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"DeleteItem\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"4c86833c-1920-4dda-bdf8-c86549312eff\",\"id\":\"@triggerOutputs()?['body/ID']\"},\"authentication\":\"@parameters('$authentication')\"}},\"Timeout_Retrigger_4\":{\"runAfter\":{\"Delete_this_Retrigger_3\":[\"Succeeded\"]},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"PostItem\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"4c86833c-1920-4dda-bdf8-c86549312eff\",\"item/FileName\":\"@triggerOutputs()?['body/FileName']\",\"item/DocumentName\":\"@triggerOutputs()?['body/DocumentName']\",\"item/StartedBy\":\"@triggerOutputs()?['body/StartedBy']\",\"item/DocumentType\":\"@triggerOutputs()?['body/DocumentType']\",\"item/RetriggerType\":\"Create\",\"item/CurrentStageWaiting\":\"Review\",\"item/Division\":\"@triggerOutputs()?['body/Division']\",\"item/Process\":\"@triggerOutputs()?['body/Process']\",\"item/DocumentNumber\":\"@triggerOutputs()?['body/DocumentNumber']\",\"item/ItemID\":\"@triggerOutputs()?['body/ItemID']\",\"item/DocNumberID\":\"@triggerOutputs()?['body/DocNumberID']\",\"item/ActiveApprovalID\":\"@triggerOutputs()?['body/ActiveApprovalID']\",\"item/ETag\":\"@triggerOutputs()?['body/ETag']\",\"item/ApprovalID\":\"@outputs('Wait_for_an_Reviewer_Approval')?['body/name']\"},\"authentication\":\"@parameters('$authentication')\"}}},\"runAfter\":{},\"else\":{\"actions\":{\"Delete_DocNumber_2\":{\"runAfter\":{},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"DeleteItem\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"66953198-05c9-40f9-bdfa-e0744efc90cc\",\"id\":\"@variables('DocNumID')\"},\"authentication\":\"@parameters('$authentication')\"}},\"Delete_Active_Approval_Originator\":{\"runAfter\":{\"Delete_DocNumber_2\":[\"Succeeded\"]},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"DeleteItem\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"9139a2aa-626a-4e02-becc-60943ad79ccc\",\"id\":\"@variables('ActiveApprovalID')\"},\"authentication\":\"@parameters('$authentication')\"}},\"Delete_file_4\":{\"runAfter\":{\"Delete_Active_Approval_Originator\":[\"Succeeded\"]},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"DeleteFile\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"id\":\"d\"},\"authentication\":\"@parameters('$authentication')\"}}}},\"expression\":{\"equals\":[\"@outputs('Wait_for_an_approval')?['body/outcome']\",\"Approve\"]},\"type\":\"If\"}}},\"Review\":{\"case\":\"Review\",\"actions\":{\"Outcome_of_Reviewer_Approval\":{\"actions\":{\"Update_Active_Approval_Approver\":{\"runAfter\":{},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"PatchItem\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"9139a2aa-626a-4e02-becc-60943ad79ccc\",\"id\":\"@variables('ActiveApprovalID')\",\"item/Title\":\"@triggerOutputs()?['body/FileName']\",\"item/Status\":\"Awaiting Approver Approval\",\"item/Division\":\"@triggerOutputs()?['body/Division']\",\"item/Process\":\"@triggerOutputs()?['body/Process']\"},\"authentication\":\"@parameters('$authentication')\"}},\"Notify_Originator_(Review_Approve)\":{\"runAfter\":{\"Update_Active_Approval_Approver\":[\"Succeeded\"]},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_office365\",\"connectionName\":\"shared_office365_1\",\"operationId\":\"SendEmailV2\"},\"parameters\":{\"emailMessage/To\":\"@triggerOutputs()?['body/Author/Email']\",\"emailMessage/Subject\":\"GDMS | Document Approval\",\"emailMessage/Body\":\"<p><em>Please do not reply, this is an automated message and responses to this email will not be monitored.</em><br>\\n<br>\\n<strong>STATUS</strong><br>\\n----------------<br>\\n<strong>Origination</strong><br>\\n<br>\\n<strong>Reviewal</strong><br>\\n<br>\\nApproval<br>\\n----------------<br>\\n<br>\\nYour originated document, @{triggerOutputs()?['body/{Name}']} (@{triggerOutputs()?['body/GroteDocumentDescription']}), has been reviewed and sent to the approval stage and is now awaiting approval from one of the process approvers.<br>\\n<br>\\nPlease note that this process may take some time, and you will be notified once the document furthers along in the process.</p>\",\"emailMessage/Importance\":\"Normal\"},\"authentication\":\"@parameters('$authentication')\"}},\"Get-Create_Approvers_list_for_document\":{\"foreach\":\"@outputs('Get_ORA_for_document')?['body/value']\",\"actions\":{\"Select\":{\"runAfter\":{},\"type\":\"Select\",\"inputs\":{\"from\":\"@items('Get-Create_Approvers_list_for_document')?['Approvers']\",\"select\":\"@item()?['Email']\"}},\"Join\":{\"runAfter\":{\"Select\":[\"Succeeded\"]},\"type\":\"Join\",\"inputs\":{\"from\":\"@body('Select')\",\"joinWith\":\";\"}},\"Set_Approvers\":{\"runAfter\":{\"Join\":[\"Succeeded\"]},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"Approvers\",\"value\":\"@body('Join')\"}}},\"runAfter\":{\"Notify_Originator_(Review_Approve)\":[\"Succeeded\"]},\"type\":\"Foreach\"},\"Set_RevApp_to_Reviewer_Approver\":{\"foreach\":\"@outputs('Wait_for_an_approval')?['body/responses']\",\"actions\":{\"Set_RevApp\":{\"runAfter\":{},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"RevApp\",\"value\":\"@items('Set_RevApp_to_Reviewer_Approver')?['responder/displayName']\"}}},\"runAfter\":{\"Get-Create_Approvers_list_for_document\":[\"Succeeded\"]},\"type\":\"Foreach\"},\"Notify_Approver\":{\"runAfter\":{\"Set_RevApp_to_Reviewer_Approver\":[\"Succeeded\"]},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_office365\",\"connectionName\":\"shared_office365_1\",\"operationId\":\"SendEmailV2\"},\"parameters\":{\"emailMessage/To\":\"@variables('Approvers')\",\"emailMessage/Subject\":\"GDMS | New Document to Approve\",\"emailMessage/Body\":\"<p>Please do not reply, this is an automated message and responses to this email will not be monitored.<br>\\n<br>\\nYou have a new document to approve. Please visit the Approvals tab via Teams to view the request.<br>\\n<br>\\nDocument Name: @{triggerOutputs()?['body/{Name}']} | @{triggerOutputs()?['body/GroteDocumentDescription']}<br>\\nOriginated By: @{triggerOutputs()?['body/Author/DisplayName']}<br>\\nReviewed By: @{variables('RevApp')}</p>\",\"emailMessage/Importance\":\"Normal\"},\"authentication\":\"@parameters('$authentication')\"}},\"Approver_Approval\":{\"runAfter\":{\"Notify_Approver\":[\"Succeeded\"]},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_approvals\",\"connectionName\":\"shared_approvals\",\"operationId\":\"CreateAnApproval\"},\"parameters\":{\"approvalType\":\"Basic\",\"ApprovalCreationInput/title\":\"GDMS | Document Approval | @{triggerOutputs()?['body/GroteDocumentDescription']}\",\"ApprovalCreationInput/assignedTo\":\"@{variables('Approvers')};\",\"ApprovalCreationInput/details\":\"**Grote Document Management System**\\n_You have a new document to approve._\\n\\n**Name:** @{triggerOutputs()?['body/{Name}']} | @{triggerOutputs()?['body/GroteDocumentDescription']}\\n**Document Type:** @{triggerOutputs()?['body/GroteDocumentType/Value']}\\n**Division:** @{triggerOutputs()?['body/GroteDivision/Value']}\\n**Process:**   @{triggerOutputs()?['body/GroteProcess/Value']}\\n\\n**Originated By:** @{triggerOutputs()?['body/Author/DisplayName']}\\n**Origination Approved By:** @{triggerOutputs()?['body/StartedBy']}\\n**Reviewed By:** @{variables('AppApp')}\",\"ApprovalCreationInput/itemLink\":\"@triggerOutputs()?['body/{Link}']\",\"ApprovalCreationInput/itemLinkDescription\":\"View Document\",\"ApprovalCreationInput/requestor\":\"@{triggerOutputs()?['body/StartedBy']};\",\"ApprovalCreationInput/enableNotifications\":false,\"ApprovalCreationInput/enableReassignment\":false},\"authentication\":\"@parameters('$authentication')\"}},\"Wait_for_an_Approver_Approval\":{\"runAfter\":{\"Approver_Approval\":[\"Succeeded\"]},\"limit\":{\"timeout\":\"P29D\"},\"type\":\"OpenApiConnectionWebhook\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_approvals\",\"connectionName\":\"shared_approvals\",\"operationId\":\"WaitForAnApproval\"},\"parameters\":{\"approvalName\":\"@outputs('Approver_Approval')?['body/name']\"},\"authentication\":\"@parameters('$authentication')\"}},\"Set_AppApp_to_Approval_Approver\":{\"foreach\":\"@outputs('Wait_for_an_Approver_Approval')?['body/responses']\",\"actions\":{\"Set_AppApp\":{\"runAfter\":{},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"AppApp\",\"value\":\"@items('Set_AppApp_to_Approval_Approver')?['responder/displayName']\"}}},\"runAfter\":{\"Wait_for_an_Approver_Approval\":[\"Succeeded\"]},\"type\":\"Foreach\"},\"Outcome_of_Approver_Approval_2\":{\"actions\":{\"Delete_Active_Approval_Approver_2\":{\"runAfter\":{},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"DeleteItem\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"9139a2aa-626a-4e02-becc-60943ad79ccc\",\"id\":\"@variables('ActiveApprovalID')\"},\"authentication\":\"@parameters('$authentication')\"}},\"Set_content_approval_status_2\":{\"runAfter\":{\"Delete_Active_Approval_Approver_2\":[\"Succeeded\"]},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"SetApprovalStatus\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"bc460a20-664c-49e7-bfe7-2843495da717\",\"id\":\"@variables('FileID')\",\"approvalAction\":\"Approve\",\"comments\":\"\",\"entityTag\":\"@triggerOutputs()?['body/ETag']\"},\"authentication\":\"@parameters('$authentication')\"}},\"Notify_Organizer_2\":{\"runAfter\":{\"Set_content_approval_status_2\":[\"Succeeded\"]},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_office365\",\"connectionName\":\"shared_office365\",\"operationId\":\"SendEmailV2\"},\"parameters\":{\"emailMessage/To\":\"@variables('StartedBy')\",\"emailMessage/Subject\":\"GDMS | Document Approved \",\"emailMessage/Body\":\"<p><em>Please do not reply, this is an automated message and responses to this email will not be monitored.</em><br>\\n<br>\\n<strong>STATUS</strong><br>\\n----------------<br>\\n<strong>Origination</strong><br>\\n<br>\\n<strong>Approval</strong><br>\\n<br>\\n<strong>Reviewal</strong><br>\\n----------------<br>\\n<br>\\nYour originated document, @{triggerOutputs()?['body/{Name}']} (@{triggerOutputs()?['body/GroteDocumentDescription']}), has been approved. The document has been published and can be found at the attached link. @{triggerOutputs()?['body/{Link}']}</p>\",\"emailMessage/Importance\":\"Normal\"},\"authentication\":\"@parameters('$authentication')\"}}},\"runAfter\":{\"Set_AppApp_to_Approval_Approver\":[\"Succeeded\"]},\"else\":{\"actions\":{\"Approval_Reject_Email_2\":{\"runAfter\":{},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_office365\",\"connectionName\":\"shared_office365\",\"operationId\":\"SendEmailV2\"},\"parameters\":{\"emailMessage/To\":\"@variables('StartedBy')\",\"emailMessage/Subject\":\"GDMS | Document Rejected\",\"emailMessage/Body\":\"<p><em>Please do not reply, this is an automated message and responses to this email will not be monitored.</em><br>\\n<br>\\nSTATUS<br>\\n----------------<br>\\n<strong>Origination</strong><br>\\n<br>\\n<strong>Reviewal</strong><br>\\n<br>\\n<strong>Approval</strong><br>\\n----------------<br>\\n<br>\\nYour originated document, @{triggerOutputs()?['body/{Name}']} (@{triggerOutputs()?['body/GroteDocumentDescription']}), has been rejected at the approval stage.<br>\\n</p>\",\"emailMessage/Importance\":\"Normal\"},\"authentication\":\"@parameters('$authentication')\"}},\"Delete_Doc_Number_2\":{\"runAfter\":{\"Approval_Reject_Email_2\":[\"Succeeded\"]},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"DeleteItem\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"66953198-05c9-40f9-bdfa-e0744efc90cc\",\"id\":\"@variables('DocNumID')\"},\"authentication\":\"@parameters('$authentication')\"}},\"Delete_Active_Approval_Reviewer_3\":{\"runAfter\":{\"Delete_Doc_Number_2\":[\"Succeeded\"]},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"DeleteItem\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"9139a2aa-626a-4e02-becc-60943ad79ccc\",\"id\":\"@variables('ActiveApprovalID')\"},\"authentication\":\"@parameters('$authentication')\"}},\"Delete_file_3\":{\"runAfter\":{\"Delete_Active_Approval_Reviewer_3\":[\"Succeeded\"]},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"DeleteFile\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"id\":\"@variables('FileID')\"},\"authentication\":\"@parameters('$authentication')\"}}}},\"expression\":{\"equals\":[\"@outputs('Wait_for_an_Approver_Approval')?['body/outcome']\",\"Approve\"]},\"type\":\"If\"},\"Delete_this_Retrigger\":{\"runAfter\":{\"Wait_for_an_Approver_Approval\":[\"TimedOut\"]},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"DeleteItem\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"4c86833c-1920-4dda-bdf8-c86549312eff\",\"id\":\"@triggerOutputs()?['body/ID']\"},\"authentication\":\"@parameters('$authentication')\"}},\"Timeout_Retrigger_2\":{\"runAfter\":{\"Delete_this_Retrigger\":[\"Succeeded\"]},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"PostItem\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"4c86833c-1920-4dda-bdf8-c86549312eff\",\"item/FileName\":\"@triggerOutputs()?['body/FileName']\",\"item/DocumentName\":\"@triggerOutputs()?['body/DocumentName']\",\"item/StartedBy\":\"@triggerOutputs()?['body/StartedBy']\",\"item/DocumentType\":\"@triggerOutputs()?['body/DocumentType']\",\"item/RetriggerType\":\"Create\",\"item/CurrentStageWaiting\":\"Approve\",\"item/Division\":\"@triggerOutputs()?['body/Division']\",\"item/Process\":\"@triggerOutputs()?['body/Process']\",\"item/DocumentNumber\":\"@triggerOutputs()?['body/DocumentNumber']\",\"item/ItemID\":\"@triggerOutputs()?['body/ItemID']\",\"item/DocNumberID\":\"@triggerOutputs()?['body/DocNumberID']\",\"item/ActiveApprovalID\":\"@triggerOutputs()?['body/ActiveApprovalID']\",\"item/ETag\":\"@triggerOutputs()?['body/ETag']\",\"item/ApprovalID\":\"@outputs('Approver_Approval')?['body/name']\"},\"authentication\":\"@parameters('$authentication')\"}}},\"runAfter\":{},\"else\":{\"actions\":{\"Notify_Originator_(Review_Reject)\":{\"runAfter\":{},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_office365\",\"connectionName\":\"shared_office365_1\",\"operationId\":\"SendEmailV2\"},\"parameters\":{\"emailMessage/To\":\"@triggerOutputs()?['body/Author/Email']\",\"emailMessage/Subject\":\"GDMS | Document Rejected\",\"emailMessage/Body\":\"<p><em>Please do not reply, this is an automated message and responses to this email will not be monitored.</em><br>\\n<br>\\n<strong>STATUS</strong><br>\\n----------------<br>\\n<strong>Origination</strong><br>\\n<br>\\n<strong>Reviewal</strong><br>\\n<br>\\nApproval<br>\\n----------------<br>\\n<br>\\nYour originated document, @{triggerOutputs()?['body/{Name}']} (@{triggerOutputs()?['body/GroteDocumentDescription']}), has been rejected at the reviewal stage.<br>\\n</p>\",\"emailMessage/Importance\":\"Normal\"},\"authentication\":\"@parameters('$authentication')\"}},\"Delete_DocNumber\":{\"runAfter\":{\"Notify_Originator_(Review_Reject)\":[\"Succeeded\"]},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"DeleteItem\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"66953198-05c9-40f9-bdfa-e0744efc90cc\",\"id\":\"@variables('DocNumID')\"},\"authentication\":\"@parameters('$authentication')\"}},\"Delete_Active_Approval_Reviewer_2\":{\"runAfter\":{\"Delete_DocNumber\":[\"Succeeded\"]},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"DeleteItem\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"9139a2aa-626a-4e02-becc-60943ad79ccc\",\"id\":\"@variables('ActiveApprovalID')\"},\"authentication\":\"@parameters('$authentication')\"}},\"Delete_file_2\":{\"runAfter\":{\"Delete_Active_Approval_Reviewer_2\":[\"Succeeded\"]},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"DeleteFile\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"id\":\"d\"},\"authentication\":\"@parameters('$authentication')\"}}}},\"expression\":{\"equals\":[\"@outputs('Wait_for_an_approval')?['body/outcome']\",\"Approve\"]},\"type\":\"If\"}}},\"Approve\":{\"case\":\"Approve\",\"actions\":{\"Outcome_of_Approver_Approval\":{\"actions\":{\"Delete_Active_Approval_Approver\":{\"runAfter\":{},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"DeleteItem\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"9139a2aa-626a-4e02-becc-60943ad79ccc\",\"id\":\"@variables('ActiveApprovalID')\"},\"authentication\":\"@parameters('$authentication')\"}},\"Set_content_approval_status\":{\"runAfter\":{\"Delete_Active_Approval_Approver\":[\"Succeeded\"]},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"SetApprovalStatus\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"bc460a20-664c-49e7-bfe7-2843495da717\",\"id\":\"@variables('FileID')\",\"approvalAction\":\"Approve\",\"comments\":\"\",\"entityTag\":\"@triggerOutputs()?['body/ETag']\"},\"authentication\":\"@parameters('$authentication')\"}},\"Notify_Organizer\":{\"runAfter\":{\"Set_content_approval_status\":[\"Succeeded\"]},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_office365\",\"connectionName\":\"shared_office365\",\"operationId\":\"SendEmailV2\"},\"parameters\":{\"emailMessage/To\":\"@variables('StartedBy')\",\"emailMessage/Subject\":\"GDMS | Document Approved \",\"emailMessage/Body\":\"<p><em>Please do not reply, this is an automated message and responses to this email will not be monitored.</em><br>\\n<br>\\n<strong>STATUS</strong><br>\\n----------------<br>\\n<strong>Origination</strong><br>\\n<br>\\n<strong>Approval</strong><br>\\n<br>\\n<strong>Reviewal</strong><br>\\n----------------<br>\\n<br>\\nYour originated document, @{triggerOutputs()?['body/{Name}']} (@{triggerOutputs()?['body/GroteDocumentDescription']}), has been approved. The document has been published and can be found at the attached link. @{triggerOutputs()?['body/{Link}']}</p>\",\"emailMessage/Importance\":\"Normal\"},\"authentication\":\"@parameters('$authentication')\"}}},\"runAfter\":{},\"else\":{\"actions\":{\"Approval_Reject_Email\":{\"runAfter\":{},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_office365\",\"connectionName\":\"shared_office365\",\"operationId\":\"SendEmailV2\"},\"parameters\":{\"emailMessage/To\":\"@variables('StartedBy')\",\"emailMessage/Subject\":\"GDMS | Document Rejected\",\"emailMessage/Body\":\"<p><em>Please do not reply, this is an automated message and responses to this email will not be monitored.</em><br>\\n<br>\\nSTATUS<br>\\n----------------<br>\\n<strong>Origination</strong><br>\\n<br>\\n<strong>Reviewal</strong><br>\\n<br>\\n<strong>Approval</strong><br>\\n----------------<br>\\n<br>\\nYour originated document, @{triggerOutputs()?['body/{Name}']} (@{triggerOutputs()?['body/GroteDocumentDescription']}), has been rejected at the approval stage.<br>\\n</p>\",\"emailMessage/Importance\":\"Normal\"},\"authentication\":\"@parameters('$authentication')\"}},\"Delete_Doc_Number\":{\"runAfter\":{\"Approval_Reject_Email\":[\"Succeeded\"]},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"DeleteItem\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"66953198-05c9-40f9-bdfa-e0744efc90cc\",\"id\":\"@variables('DocNumID')\"},\"authentication\":\"@parameters('$authentication')\"}},\"Delete_Active_Approval_Reviewer\":{\"runAfter\":{\"Delete_Doc_Number\":[\"Succeeded\"]},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"DeleteItem\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"9139a2aa-626a-4e02-becc-60943ad79ccc\",\"id\":\"@variables('ActiveApprovalID')\"},\"authentication\":\"@parameters('$authentication')\"}},\"Delete_file\":{\"runAfter\":{\"Delete_Active_Approval_Reviewer\":[\"Succeeded\"]},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"DeleteFile\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"id\":\"@variables('FileID')\"},\"authentication\":\"@parameters('$authentication')\"}}}},\"expression\":{\"equals\":[\"@outputs('Wait_for_an_approval')?['body/outcome']\",\"Approve\"]},\"type\":\"If\"}}}},\"default\":{\"actions\":{}},\"expression\":\"@triggerOutputs()?['body/CurrentStageWaiting']\",\"metadata\":{\"operationMetadataId\":\"95ee7ce0-4c5e-44ef-8467-25f0af54afcd\"},\"type\":\"Switch\"},\"Timeout_Retrigger\":{\"runAfter\":{\"Wait_for_an_approval\":[\"TimedOut\"]},\"metadata\":{\"operationMetadataId\":\"1a88770c-184c-4ca4-b9e9-b9d0d367024b\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"PostItem\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"4c86833c-1920-4dda-bdf8-c86549312eff\"},\"authentication\":\"@parameters('$authentication')\"}},\"Create_ActiveApprovalID\":{\"runAfter\":{\"Create_DocumentType\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"8e56b14f-2d1d-419e-a59a-7e4f2eacb5e8\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"ActiveApprovalID\",\"type\":\"string\",\"value\":\"@triggerOutputs()?['body/ApprovalID']\"}]}},\"Create_FileID\":{\"runAfter\":{\"Create_ActiveApprovalID\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"e3309941-3409-49e3-af8c-b41938ee265f\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"FileID\",\"type\":\"string\",\"value\":\"@{triggerOutputs()?['body/ID']}\"}]}},\"Create_DocNumID\":{\"runAfter\":{\"Create_FileID\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"4071d3c8-5330-4008-a2c7-626f1571c4b0\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"DocNumID\",\"type\":\"string\",\"value\":\"@triggerOutputs()?['body/DocNumberID']\"}]}},\"Get_ORA_for_document\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"9f58caa7-c957-43a9-a15f-c2d365e6da1f\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"GetItems\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"8817a49e-b48d-4634-9918-1c7716a2d1e5\",\"$filter\":\"(Location eq '@{triggerOutputs()?['body/Division']}') and (Process eq '@{triggerOutputs()?['body/Process']}')\"},\"authentication\":\"@parameters('$authentication')\"}},\"Create_Approvers\":{\"runAfter\":{\"Create_OrigApp\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"0b496838-47aa-4372-8d36-ca9dd773a548\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"Approvers\",\"type\":\"string\"}]}},\"Create_Reviewers\":{\"runAfter\":{\"Create_AppApp\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"22ba089d-f9e6-42da-b01c-786eb5c19821\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"Reviewers\",\"type\":\"string\"}]}},\"Create_RevApp\":{\"runAfter\":{\"Create_Reviewers\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"ac32ffe3-fd82-4f21-88f0-29edbcbadb69\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"RevApp\",\"type\":\"string\"}]}},\"Create_AppApp\":{\"runAfter\":{\"Create_Approvers\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"d8aa00d7-ac6b-4744-82aa-7747b33f0d07\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"AppApp\",\"type\":\"string\"}]}},\"Create_OrigApp\":{\"runAfter\":{\"Create_DocNumID\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"859cd3e0-3b6f-4572-8261-d279e63cc017\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"OrigApp\",\"type\":\"string\"}]}}}}},\"schemaVersion\":\"1.0.0.0\"}","createdBy":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","modifiedBy":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","ownerId":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","owningBusinessUnit":"ee0a9aec-b63d-e911-a81c-000d3a11eefe","owningUser":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff"},{"name":"GDMS_Created_Revision","createdOn":"2023-07-31T04:02:28Z","modifiedOn":"2023-08-03T00:52:07Z","workflowId":"3fef690b-572f-ee11-bdf3-000d3a1b983d","resourceId":"3a65ad32-b5b0-4966-9f38-e87306f28057","stateCode":"Published","statusCode":"Published","definition":"{\"properties\":{\"connectionReferences\":{\"shared_sharepointonline\":{\"runtimeSource\":\"embedded\",\"connection\":{\"name\":\"shared-sharepointonl-947cca0b-9618-4af1-b27f-1d5711ca17b2\",\"connectionReferenceLogicalName\":\"spo_sharedsharepointonline_e3ac5\"},\"api\":{\"name\":\"shared_sharepointonline\"}}},\"definition\":{\"$schema\":\"https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"$authentication\":{\"defaultValue\":{},\"type\":\"SecureObject\"},\"$connections\":{\"defaultValue\":{},\"type\":\"Object\"}},\"triggers\":{\"When_a_file_is_created_or_modified_(properties_only)\":{\"recurrence\":{\"frequency\":\"Minute\",\"interval\":1},\"splitOn\":\"@triggerOutputs()?['body/value']\",\"metadata\":{\"operationMetadataId\":\"d83a9b55-deca-4691-a6b3-b8cd4aba3e40\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"bc460a20-664c-49e7-bfe7-2843495da717\"},\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"GetOnUpdatedFileItems\"},\"authentication\":\"@parameters('$authentication')\"},\"conditions\":[{\"expression\":\"@and(equals(triggerBody()?['Status'], 'Approved'),greater(trigerBody()?['Version number'], '1.0'))\"}]}},\"actions\":{\"ID\":{\"runAfter\":{\"Do_until\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"414e7542-bc29-499f-8eb5-ab8d3e5e729e\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"ID\",\"type\":\"string\",\"value\":\"@{triggerOutputs()?['body/ID']}\"}]}},\"DocNumber\":{\"runAfter\":{\"ID\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"b712d3fa-7b3e-4eae-846d-0f24d4e3dcb3\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"DocNumber\",\"type\":\"string\",\"value\":\"@triggerBody()?['GroteDocumentShortDescription']\"}]}},\"DocName\":{\"runAfter\":{\"DocNumber\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"4777d650-d7ea-446e-bc64-aae6cba610ba\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"DocName\",\"type\":\"string\",\"value\":\"@triggerBody()?['{Name}']\"}]}},\"DocTitle\":{\"runAfter\":{\"DocName\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"18b51670-de1d-4bdb-a9bb-5ef96d5edaae\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"DocTitle\",\"type\":\"string\",\"value\":\"@triggerBody()?['GroteDocumentDescription']\"}]}},\"DocType\":{\"runAfter\":{\"DocTitle\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"8f01703b-9709-4573-b6ff-edf73e6c84c1\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"DocType\",\"type\":\"string\",\"value\":\"@triggerBody()?['GroteDocumentType_x003A_Description']?['Value']\"}]}},\"DocDivision\":{\"runAfter\":{\"DocType\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"66ed16b3-1fad-4b25-ab37-662de8970dd5\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"DocDivision\",\"type\":\"string\",\"value\":\"@triggerBody()?['GroteDivision']?['Value']\"}]}},\"DocProcess\":{\"runAfter\":{\"DocDivision\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"69630494-90c3-4fcc-bf7b-5e17df0d4673\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"DocProcess\",\"type\":\"string\",\"value\":\"@triggerBody()?['GroteProcess']?['Value']\"}]}},\"DocOriginatorEmail\":{\"runAfter\":{\"DocProcess\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"66365ab4-7bcb-48b2-837a-68463f0134ce\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"DocOriginatorEmail\",\"type\":\"string\",\"value\":\"@triggerBody()?['Author']?['Email']\"}]}},\"DocOriginatorName\":{\"runAfter\":{\"DocOriginatorEmail\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"34f7ebc9-9405-4f11-8234-469133652255\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"DocOriginatorName\",\"type\":\"string\",\"value\":\"@triggerBody()?['Author']?['DisplayName']\"}]}},\"DocLink\":{\"runAfter\":{\"DocOriginatorName\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"e728f394-0f75-490a-8514-7bfaf3838565\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"DocLink\",\"type\":\"string\",\"value\":\"@triggerBody()?['{Link}']\"}]}},\"Get_OARD\":{\"runAfter\":{\"DistributionList\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"4adb989d-3219-4f9e-ad91-a87ed42a5bd9\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"8817a49e-b48d-4634-9918-1c7716a2d1e5\",\"$filter\":\"(Location eq '@{triggerBody()?['GroteDivision']?['Value']}') and (Process eq '@{triggerBody()?['GroteProcess']?['Value']}')\"},\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"GetItems\"},\"authentication\":\"@parameters('$authentication')\"}},\"Create_Approvers_List\":{\"foreach\":\"@outputs('Get_OARD')?['body/value']\",\"actions\":{\"Select_Approvers\":{\"metadata\":{\"operationMetadataId\":\"9ebb034e-9fa1-4fde-974f-fec066ca5fc7\"},\"type\":\"Select\",\"inputs\":{\"from\":\"@items('Create_Approvers_List')?['Approvers']\",\"select\":\"@item()?['Email']\"}},\"Join_Approvers\":{\"runAfter\":{\"Select_Approvers\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"f6847035-fe24-4ff7-b09f-cce8865d32ab\"},\"type\":\"Join\",\"inputs\":{\"from\":\"@body('Select_Approvers')\",\"joinWith\":\";\"}},\"Set_ApproversList\":{\"runAfter\":{\"Join_Approvers\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"6950e687-b3bc-4a4e-b54b-e0ff2e3895b5\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"ApproversList\",\"value\":\"@body('Join_Approvers')\"}}},\"runAfter\":{\"Get_OARD\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"bce855cc-c345-48bc-8540-3c90fbb669d4\"},\"type\":\"Foreach\"},\"ApproversList\":{\"runAfter\":{\"DocLink\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"89df1aed-5aa3-4ff3-98b1-a9e89d17cd0c\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"ApproversList\",\"type\":\"string\"}]}},\"Create_Reviewers_List\":{\"foreach\":\"@outputs('Get_OARD')?['body/value']\",\"actions\":{\"Select_Reviewers\":{\"metadata\":{\"operationMetadataId\":\"a95804f8-a5d9-4fa5-8942-0be0b11f962f\"},\"type\":\"Select\",\"inputs\":{\"from\":\"@items('Create_Reviewers_List')?['Reviewers']\",\"select\":\"@item()?['Email']\"}},\"Join_Reviewers\":{\"runAfter\":{\"Select_Reviewers\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"4b413e81-8335-432a-8b8c-500dee29527f\"},\"type\":\"Join\",\"inputs\":{\"from\":\"@body('Select_Reviewers')\",\"joinWith\":\";\"}},\"Set_Reviewers\":{\"runAfter\":{\"Join_Reviewers\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"b0acbcf6-b2f3-4456-8c2b-d7e69ebb9314\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"ReviewersList\",\"value\":\"@body('Join_Reviewers')\"}}},\"runAfter\":{\"Create_Approvers_List\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"81d65695-4cd3-491b-8b87-8b82ce9257e1\"},\"type\":\"Foreach\"},\"ReviewersList\":{\"runAfter\":{\"ApproversList\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"3a41e865-b617-4d64-955a-c05148e12ba7\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"ReviewersList\",\"type\":\"string\"}]}},\"DistributionList\":{\"runAfter\":{\"ReviewersList\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"3c22f79b-f736-4a07-8f9e-29f30388a5b8\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"DistributionList\",\"type\":\"string\"}]}},\"Create_Distribution_List\":{\"foreach\":\"@outputs('Get_OARD')?['body/value']\",\"actions\":{\"Select_Distributors\":{\"metadata\":{\"operationMetadataId\":\"1049b1f2-fcad-4071-bfa1-c2d534cd4795\"},\"type\":\"Select\",\"inputs\":{\"from\":\"@items('Create_Distribution_List')?['Distribution']\",\"select\":\"@item()?['Email']\"}},\"Join_Distributors\":{\"runAfter\":{\"Select_Distributors\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"ba2bf1d4-31a5-4545-9f40-c4bcacab1ff2\"},\"type\":\"Join\",\"inputs\":{\"from\":\"@body('Select_Distributors')\",\"joinWith\":\";\"}},\"Set_Distributors\":{\"runAfter\":{\"Join_Distributors\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"3321bcc7-600c-44d1-a5ea-71a30f1dea20\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"DistributionList\",\"value\":\"@body('Join_Distributors')\"}}},\"runAfter\":{\"Create_Reviewers_List\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"dd1c9a3c-70d2-4f14-94d9-b0b5bcd83dd4\"},\"type\":\"Foreach\"},\"Get_items_in_ApprovalInfo\":{\"runAfter\":{\"Create_Distribution_List\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"60c214cc-7b94-4644-b2f2-da7d35195ca5\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"3f960b78-8bab-42f1-a5d4-fa18072ad762\",\"$filter\":\"(Title eq '@{variables('DocName')}')\"},\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"GetItems\"},\"authentication\":\"@parameters('$authentication')\"}},\"Set_Approval_Status\":{\"foreach\":\"@outputs('Get_items_in_ApprovalInfo')?['body/value']\",\"actions\":{\"Update_item_in_ApprovalInfo\":{\"metadata\":{\"operationMetadataId\":\"ee11c39d-5e6c-413d-bc95-0c1d74d6ee5e\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"3f960b78-8bab-42f1-a5d4-fa18072ad762\",\"id\":\"@item()?['ID']\",\"item/Stage\":\"Revision\"},\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"PatchItem\"},\"authentication\":\"@parameters('$authentication')\"}}},\"runAfter\":{\"Get_items_in_ApprovalInfo\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"205b458e-bf97-4d7e-8324-6655a7ad88eb\"},\"type\":\"Foreach\"},\"Do_until\":{\"actions\":{\"Delay\":{\"metadata\":{\"operationMetadataId\":\"54f1391d-2987-460c-9bb1-81d9d790b2e6\"},\"type\":\"Wait\",\"inputs\":{\"interval\":{\"count\":1,\"unit\":\"Minute\"}}},\"Update_file_properties\":{\"runAfter\":{\"Delay\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"78551f47-aa05-4cac-a6e9-951d33461aff\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"bc460a20-664c-49e7-bfe7-2843495da717\",\"id\":\"@triggerBody()?['ID']\",\"item/GroteDocumentShortDescription\":\"@triggerBody()?['GroteDocumentShortDescription']\",\"item/GroteDocumentDescription\":\"@triggerBody()?['GroteDocumentDescription']\",\"item/GroteDocumentRevision\":\"@triggerBody()?['GroteDocumentRevision']\",\"item/ObsoleteInProgress\":false,\"item/Status\":\"Editing\"},\"host\":{\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\",\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"PatchFileItem\"},\"authentication\":\"@parameters('$authentication')\"}},\"Set_FileLocked\":{\"runAfter\":{\"Update_file_properties\":[\"Succeeded\",\"Failed\"]},\"metadata\":{\"operationMetadataId\":\"edb01aaa-f061-4dc7-a20e-2312fd86edd4\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"FileLocked\",\"value\":\"@{if(and(equals(outputs('Update_file_properties')?['body']?['status'],400),contains(outputs('Update_file_properties')?['body']?['message'],'locked')),true,false)}\"}}},\"runAfter\":{\"FileLocked\":[\"Succeeded\"]},\"expression\":\"@equals(variables('FileLocked'), false)\",\"limit\":{\"count\":60,\"timeout\":\"PT1M\"},\"metadata\":{\"operationMetadataId\":\"2a8aff6d-8dbe-4476-9a52-cb85448ecd38\"},\"type\":\"Until\"},\"FileLocked\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"9f44d532-343d-41dd-869d-369a8d08f70b\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"FileLocked\",\"type\":\"string\"}]}}},\"outputs\":{}}},\"schemaVersion\":\"1.0.0.0\"}","createdBy":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","modifiedBy":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","ownerId":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","owningBusinessUnit":"ee0a9aec-b63d-e911-a81c-000d3a11eefe","owningUser":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff"},{"name":"GDMS_Obsolete_UsrChk","createdOn":"2023-07-31T16:52:12Z","modifiedOn":"2023-07-31T16:53:02Z","workflowId":"66328694-c22f-ee11-bdf3-000d3a1b983d","resourceId":"e25ce107-2d7f-459b-a566-1c745ed66383","stateCode":"Published","statusCode":"Published","definition":"{\"properties\":{\"connectionReferences\":{\"shared_sharepointonline\":{\"runtimeSource\":\"invoker\",\"connection\":{\"name\":\"shared-sharepointonl-947cca0b-9618-4af1-b27f-1d5711ca17b2\"},\"api\":{\"name\":\"shared_sharepointonline\"}}},\"definition\":{\"$schema\":\"https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"$connections\":{\"defaultValue\":{},\"type\":\"Object\"},\"$authentication\":{\"defaultValue\":{},\"type\":\"SecureObject\"}},\"triggers\":{\"manual\":{\"metadata\":{\"operationMetadataId\":\"aa00afad-1fa2-49bb-989f-f8cc1819af87\"},\"type\":\"Request\",\"kind\":\"PowerApp\",\"inputs\":{\"schema\":{\"type\":\"object\",\"properties\":{\"GetUserDisplayName_Value\":{\"type\":\"string\",\"description\":\"Enter initial value\",\"x-ms-powerflows-param-ispartial\":false},\"GetLocation_Value\":{\"type\":\"string\",\"description\":\"Enter initial value\",\"x-ms-powerflows-param-ispartial\":false},\"GetProcess_Value\":{\"type\":\"string\",\"description\":\"Enter initial value\",\"x-ms-powerflows-param-ispartial\":false}},\"required\":[\"GetUserDisplayName_Value\",\"GetLocation_Value\",\"GetProcess_Value\"]}}}},\"actions\":{\"Get_UserDisplayName\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"98296cba-8367-46af-80c3-56d1f073b816\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"UserDisplayName\",\"type\":\"string\",\"value\":\"@{triggerBody()['GetUserDisplayName_Value']}\"}]}},\"Get_items\":{\"runAfter\":{\"Create_ChkResult\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"3bc21b66-b1a4-468c-89db-97befef3c113\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"GetItems\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"8817a49e-b48d-4634-9918-1c7716a2d1e5\",\"$filter\":\"(Location eq '@{variables('Location')}') and (Process eq '@{variables('Process')}')\"},\"authentication\":{\"type\":\"Raw\",\"value\":\"@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']\"}}},\"Apply_to_each\":{\"foreach\":\"@outputs('Get_items')?['body/value']\",\"actions\":{\"Select\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"be594057-357b-40f5-801f-da41ee42f81b\"},\"type\":\"Select\",\"inputs\":{\"from\":\"@items('Apply_to_each')?['Originators']\",\"select\":\"@item()['DisplayName']\"}},\"Condition\":{\"actions\":{\"Set_ChkResult_(yes)\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"5a747a2d-d62b-4fa7-acb8-bd58b90a08f6\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"ChkResult\",\"value\":\"yes\"}}},\"runAfter\":{\"Select\":[\"Succeeded\"]},\"else\":{\"actions\":{\"Set_ChkResult_(no)\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"e46457ea-c591-4b26-a86d-6ebb9277ddbc\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"ChkResult\",\"value\":\"no\"}}}},\"expression\":{\"contains\":[\"@body('Select')\",\"@variables('UserDisplayName')\"]},\"metadata\":{\"operationMetadataId\":\"aecb7f6d-8413-4dac-a34a-bfd2515da35a\"},\"type\":\"If\"}},\"runAfter\":{\"Get_items\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"8aff2435-bd7c-400a-8e64-3e4e53844764\"},\"type\":\"Foreach\"},\"Get_Location\":{\"runAfter\":{\"Get_UserDisplayName\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"7980475b-d0b7-492e-a8e3-2d28bbe60154\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"Location\",\"type\":\"string\",\"value\":\"@{triggerBody()['GetLocation_Value']}\"}]}},\"Get_Process\":{\"runAfter\":{\"Get_Location\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"335c3271-854e-424e-b4ad-d5b1349129c9\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"Process\",\"type\":\"string\",\"value\":\"@{triggerBody()['GetProcess_Value']}\"}]}},\"Create_ChkResult\":{\"runAfter\":{\"Get_Process\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"518fa93f-bdf7-47c3-9895-63a1faf2efa2\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"ChkResult\",\"type\":\"string\"}]}},\"Respond_to_a_PowerApp_or_flow\":{\"runAfter\":{\"Apply_to_each\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"dc1fd4a0-1f66-494a-96fd-ab00b9122bf3\"},\"type\":\"Response\",\"kind\":\"PowerApp\",\"inputs\":{\"statusCode\":200,\"body\":{\"chkresult\":\"@variables('ChkResult')\"},\"schema\":{\"type\":\"object\",\"properties\":{\"chkresult\":{\"title\":\"ChkResult\",\"x-ms-dynamically-added\":true,\"type\":\"string\"}}}}}}},\"templateName\":\"\"},\"schemaVersion\":\"1.0.0.0\"}","createdBy":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","modifiedBy":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","ownerId":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","owningBusinessUnit":"ee0a9aec-b63d-e911-a81c-000d3a11eefe","owningUser":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff"},{"name":"GDMS_Revise_Upload","createdOn":"2023-07-31T16:42:59Z","modifiedOn":"2023-07-31T16:43:47Z","workflowId":"0fe9154e-c12f-ee11-bdf3-000d3a1b983d","resourceId":"70ea17a8-5d41-45ba-aa7f-52427d9f2830","stateCode":"Published","statusCode":"Published","definition":"{\"properties\":{\"connectionReferences\":{\"shared_sharepointonline\":{\"runtimeSource\":\"invoker\",\"connection\":{\"name\":\"shared-sharepointonl-947cca0b-9618-4af1-b27f-1d5711ca17b2\"},\"api\":{\"name\":\"shared_sharepointonline\"}}},\"definition\":{\"$schema\":\"https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"$connections\":{\"defaultValue\":{},\"type\":\"Object\"},\"$authentication\":{\"defaultValue\":{},\"type\":\"SecureObject\"}},\"triggers\":{\"manual\":{\"metadata\":{\"operationMetadataId\":\"1f500d1f-5250-40b5-a8fd-f90898ae2842\"},\"type\":\"Request\",\"kind\":\"PowerApp\",\"inputs\":{\"schema\":{\"type\":\"object\",\"properties\":{\"CreateRevisedFileContent_Value\":{\"type\":\"string\",\"description\":\"Enter initial value\",\"x-ms-powerflows-param-ispartial\":false},\"CreateFileIndentifer_Value\":{\"type\":\"string\",\"description\":\"Enter initial value\",\"x-ms-powerflows-param-ispartial\":false}},\"required\":[\"CreateRevisedFileContent_Value\",\"CreateFileIndentifer_Value\"]}}}},\"actions\":{\"Update_file\":{\"runAfter\":{\"Create_FileIndentifer\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"cdc55958-1f8e-43c5-a101-16dae3b1b5ee\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"UpdateFile\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"id\":\"@variables('FileIdentifier')\",\"body\":\"@base64ToBinary(variables('RevisedFileContent'))\"},\"authentication\":{\"type\":\"Raw\",\"value\":\"@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']\"}}},\"Create_RevisedFileContent\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"c49d475d-4c65-4661-98fe-8b7d837a59a9\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"RevisedFileContent\",\"type\":\"string\",\"value\":\"@{triggerBody()['CreateRevisedFileContent_Value']}\"}]}},\"Create_FileIndentifer\":{\"runAfter\":{\"Create_RevisedFileContent\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"89457702-4cba-490e-9cbf-cde6ef1a9a4c\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"FileIdentifier\",\"type\":\"string\",\"value\":\"@{triggerBody()['CreateFileIndentifer_Value']}\"}]}}}},\"templateName\":\"\"},\"schemaVersion\":\"1.0.0.0\"}","createdBy":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","modifiedBy":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","ownerId":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","owningBusinessUnit":"ee0a9aec-b63d-e911-a81c-000d3a11eefe","owningUser":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff"},{"name":"GDMS_ReadingTask.Read","createdOn":"2023-07-31T15:43:45Z","modifiedOn":"2023-07-31T15:44:31Z","workflowId":"6b8d0f08-b92f-ee11-bdf3-000d3a1b983d","resourceId":"ab66dea3-8ea6-4c03-a66c-088bebd9c819","stateCode":"Published","statusCode":"Published","definition":"{\"properties\":{\"connectionReferences\":{\"shared_sharepointonline\":{\"runtimeSource\":\"invoker\",\"connection\":{\"connectionReferenceLogicalName\":\"spo_sharedsharepointonline_e3ac5\"},\"api\":{\"name\":\"shared_sharepointonline\"}}},\"definition\":{\"$schema\":\"https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"$connections\":{\"defaultValue\":{},\"type\":\"Object\"},\"$authentication\":{\"defaultValue\":{},\"type\":\"SecureObject\"}},\"triggers\":{\"manual\":{\"metadata\":{\"operationMetadataId\":\"c8607374-3e63-4690-8e49-d752718b2fc5\"},\"type\":\"Request\",\"kind\":\"PowerApp\",\"inputs\":{\"schema\":{\"type\":\"object\",\"properties\":{\"UserEmail_Value\":{\"type\":\"string\",\"description\":\"Enter initial value\",\"x-ms-powerflows-param-ispartial\":false},\"DocName_Value\":{\"type\":\"string\",\"description\":\"Enter initial value\",\"x-ms-powerflows-param-ispartial\":false},\"ReadingTaskID_Value\":{\"type\":\"string\",\"description\":\"Enter initial value\",\"x-ms-powerflows-param-ispartial\":false}},\"required\":[\"UserEmail_Value\",\"DocName_Value\",\"ReadingTaskID_Value\"]}}}},\"actions\":{\"UserEmail\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"3943f1cd-8f49-43cb-8031-061673e6e546\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"UserEmail\",\"type\":\"string\",\"value\":\"@{triggerBody()['UserEmail_Value']}\"}]}},\"DocName\":{\"runAfter\":{\"UserEmail\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"bdd2caa3-6b12-416d-b992-b503e8c10bb6\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"DocName\",\"type\":\"string\",\"value\":\"@{triggerBody()['DocName_Value']}\"}]}},\"ReadingTaskID\":{\"runAfter\":{\"DocName\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"72e03ffa-a11f-4bee-83fb-8f93357c4e77\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"ReadingTaskID\",\"type\":\"string\",\"value\":\"@{triggerBody()['ReadingTaskID_Value']}\"}]}},\"Get_item\":{\"runAfter\":{\"ReadingTaskID\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"63b21254-2e96-471f-ab2a-ca6795e470e2\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"GetItem\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"8507b581-d54b-4dc7-a03f-eecfae8ab0af\",\"id\":\"@triggerBody()['ReadingTaskID_Value']\"},\"authentication\":{\"type\":\"Raw\",\"value\":\"@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']\"}}},\"ReadList\":{\"runAfter\":{\"Get_item\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"cfedf2ec-4b8c-492b-a9e3-20d5526f946d\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"ReadList\",\"type\":\"string\",\"value\":\"@outputs('Get_item')?['body/ReadDistribution']\"}]}},\"NewReadList\":{\"runAfter\":{\"ReadList\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"95fcb972-7b75-4993-9f9b-029ab4178961\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"NewReadList\",\"type\":\"string\",\"value\":\"@{concat(variables('ReadList'), ';', variables('UserEmail'))}\"}]}},\"Condition\":{\"actions\":{\"Update_item_2\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"07cd0803-ea13-4ffb-8fb0-cd8481763c30\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"PatchItem\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"8507b581-d54b-4dc7-a03f-eecfae8ab0af\",\"id\":\"@triggerBody()['ReadingTaskID_Value']\",\"item/Title\":\"@outputs('Get_item')?['body/Title']\",\"item/Name\":\"@outputs('Get_item')?['body/Name']\",\"item/AllDistribution\":\"@outputs('Get_item')?['body/AllDistribution']\",\"item/ReadDistribution\":\"@variables('UserEmail')\",\"item/Link1\":\"@outputs('Get_item')?['body/Link1']\"},\"authentication\":{\"type\":\"Raw\",\"value\":\"@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']\"}}}},\"runAfter\":{\"NewReadList\":[\"Succeeded\"]},\"else\":{\"actions\":{\"Update_item\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"8b417634-86a0-4e48-a617-6c2dc9074e1d\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"PatchItem\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"8507b581-d54b-4dc7-a03f-eecfae8ab0af\",\"id\":\"@triggerBody()['ReadingTaskID_Value']\",\"item/Title\":\"@outputs('Get_item')?['body/Title']\",\"item/Name\":\"@outputs('Get_item')?['body/Name']\",\"item/AllDistribution\":\"@outputs('Get_item')?['body/AllDistribution']\",\"item/ReadDistribution\":\"@variables('NewReadList')\",\"item/Link1\":\"@outputs('Get_item')?['body/Link1']\"},\"authentication\":{\"type\":\"Raw\",\"value\":\"@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']\"}}}}},\"expression\":{\"equals\":[\"@outputs('Get_item')?['body/ReadDistribution']\",\"\"]},\"metadata\":{\"operationMetadataId\":\"1e6d0d82-8e22-4224-b50e-e495ba65fd38\"},\"type\":\"If\"}}},\"templateName\":\"\"},\"schemaVersion\":\"1.0.0.0\"}","createdBy":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","modifiedBy":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","ownerId":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","owningBusinessUnit":"ee0a9aec-b63d-e911-a81c-000d3a11eefe","owningUser":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff"},{"name":"GDMS_ReadingTask.Lookup","createdOn":"2023-07-31T15:38:46Z","modifiedOn":"2023-07-31T15:40:00Z","workflowId":"e2ccba55-b82f-ee11-bdf3-000d3a1b983d","resourceId":"e84315e8-981b-43a4-a75b-52241fcfbb60","stateCode":"Published","statusCode":"Published","definition":"{\"properties\":{\"connectionReferences\":{\"shared_sharepointonline\":{\"runtimeSource\":\"invoker\",\"connection\":{\"connectionReferenceLogicalName\":\"spo_sharedsharepointonline_e3ac5\"},\"api\":{\"name\":\"shared_sharepointonline\"}}},\"definition\":{\"$schema\":\"https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"$connections\":{\"defaultValue\":{},\"type\":\"Object\"},\"$authentication\":{\"defaultValue\":{},\"type\":\"SecureObject\"}},\"triggers\":{\"manual\":{\"metadata\":{\"operationMetadataId\":\"e23d78dd-1091-45c9-bca1-da8d4d2af1ea\"},\"type\":\"Request\",\"kind\":\"PowerApp\",\"inputs\":{\"schema\":{\"type\":\"object\",\"properties\":{\"DocName_Value\":{\"type\":\"string\",\"description\":\"Enter initial value\",\"x-ms-powerflows-param-ispartial\":false}},\"required\":[\"DocName_Value\"]}}}},\"actions\":{\"DocName\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"349df8e4-1ed2-42da-addf-8a486cb89787\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"DocName\",\"type\":\"string\",\"value\":\"@{triggerBody()['DocName_Value']}\"}]}},\"Get_items\":{\"runAfter\":{\"Initialize_variable_2\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"c13e8339-220b-4a6f-aae1-5f64ce47b1e5\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"GetItems\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"8507b581-d54b-4dc7-a03f-eecfae8ab0af\",\"$filter\":\"(Title eq '@{variables('DocName')}')\"},\"authentication\":{\"type\":\"Raw\",\"value\":\"@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']\"}}},\"MatchedNames\":{\"runAfter\":{\"DocName\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"fd51d6a7-7696-456c-bc88-088783210d38\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"MatchedNames\",\"type\":\"array\",\"value\":[]}]}},\"Split_AllDistribution\":{\"runAfter\":{\"Initialize_variable_5\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"1a5289b1-313d-42f1-b64c-72e233c8c123\"},\"type\":\"Compose\",\"inputs\":\"@split(variables('AllDistribution'),';')\"},\"Split_ReadDistribution\":{\"runAfter\":{\"Initialize_variable_3\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"5324a088-433b-4295-8f8b-1301fe88593e\"},\"type\":\"Compose\",\"inputs\":\"@split(variables('ReadDistributionL'),';')\"},\"Apply_to_each_2\":{\"foreach\":\"@outputs('Get_items')?['body/value']\",\"actions\":{\"Set_variable\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"5466a095-29dc-4657-8d21-c8d815f340bd\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"AllDistribution\",\"value\":\"@items('Apply_to_each_2')?['AllDistribution']\"}}},\"runAfter\":{\"Get_items\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"63e5096c-e2ad-4677-84d2-dea91e7e11c3\"},\"type\":\"Foreach\"},\"Apply_to_each_3\":{\"foreach\":\"@outputs('Get_items')?['body/value']\",\"actions\":{\"Set_variable_2\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"99546e41-80ec-43ee-8f80-82871f283dc0\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"ReadDistribution\",\"value\":\"@items('Apply_to_each_3')?['ReadDistribution']\"}}},\"runAfter\":{\"Apply_to_each_2\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"e22c6fec-6bbc-48a8-ab07-537e6a2dd2b4\"},\"type\":\"Foreach\"},\"Initialize_variable\":{\"runAfter\":{\"MatchedNames\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"e31e7b65-b828-40b6-aed5-5be55024988c\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"AllDistribution\",\"type\":\"string\"}]}},\"Initialize_variable_2\":{\"runAfter\":{\"Initialize_variable\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"d01c8e1c-1b5c-4ef0-856a-41bdca013ac3\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"ReadDistribution\",\"type\":\"string\"}]}},\"Initialize_variable_3\":{\"runAfter\":{\"Split_AllDistribution\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"4d3db5f2-cef1-4980-8eae-d798c53fb538\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"AllArray\",\"type\":\"array\",\"value\":\"@outputs('Split_AllDistribution')\"}]}},\"Initialize_variable_4\":{\"runAfter\":{\"Split_ReadDistribution\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"f1f854bf-17a5-4f87-9349-92572e4c0699\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"ReadArray\",\"type\":\"array\",\"value\":\"@outputs('Split_ReadDistribution')\"}]}},\"Select\":{\"runAfter\":{\"Initialize_variable_4\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"6e586e18-a101-44a2-a5aa-a2d5c366f7d0\"},\"type\":\"Select\",\"inputs\":{\"from\":\"@variables('AllArray')\",\"select\":{\"Name\":\"@item()\",\"Status\":\"@if(contains(variables('ReadArray'), item()), 'Read', 'Unread')\"}}},\"Initialize_variable_5\":{\"runAfter\":{\"Apply_to_each_3\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"975e5def-1871-4d65-b307-90f28908ad53\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"ReadDistributionL\",\"type\":\"string\",\"value\":\"@{toLower(variables('ReadDistribution'))}\"}]}},\"Respond_to_a_PowerApp_or_flow\":{\"runAfter\":{\"Select\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"7be4ca9d-dc6a-4f88-bc95-1f33b2654826\"},\"type\":\"Response\",\"kind\":\"PowerApp\",\"inputs\":{\"statusCode\":200,\"body\":{\"response\":\"@{body('Select')}\"},\"schema\":{\"type\":\"object\",\"properties\":{\"response\":{\"title\":\"Response\",\"x-ms-dynamically-added\":true,\"type\":\"string\"}}}}}}},\"templateName\":\"\"},\"schemaVersion\":\"1.0.0.0\"}","createdBy":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","modifiedBy":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","ownerId":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","owningBusinessUnit":"ee0a9aec-b63d-e911-a81c-000d3a11eefe","owningUser":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff"},{"name":"GDMS_Get_Obsolete_Info","createdOn":"2023-07-31T15:01:35Z","modifiedOn":"2023-07-31T15:04:17Z","workflowId":"33d11224-b32f-ee11-bdf3-000d3a1b983d","resourceId":"164b4fb4-1f66-45cb-abbf-a0fe6870c4d4","stateCode":"Published","statusCode":"Published","definition":"{\"properties\":{\"connectionReferences\":{\"shared_sharepointonline\":{\"runtimeSource\":\"invoker\",\"connection\":{\"connectionReferenceLogicalName\":\"spo_sharedsharepointonline_e3ac5\"},\"api\":{\"name\":\"shared_sharepointonline\"}}},\"definition\":{\"$schema\":\"https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"$connections\":{\"defaultValue\":{},\"type\":\"Object\"},\"$authentication\":{\"defaultValue\":{},\"type\":\"SecureObject\"}},\"triggers\":{\"manual\":{\"metadata\":{\"operationMetadataId\":\"f0917a7a-018b-4d90-9e3c-8f058f93f353\"},\"type\":\"Request\",\"kind\":\"PowerApp\",\"inputs\":{\"schema\":{\"type\":\"object\",\"properties\":{\"DocName_Value\":{\"type\":\"string\",\"description\":\"Enter initial value\",\"x-ms-powerflows-param-ispartial\":false}},\"required\":[\"DocName_Value\"]}}}},\"actions\":{\"DocName\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"85bed586-dc90-42a6-83fa-76cd8c879a2b\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"DocName\",\"type\":\"string\",\"value\":\"@{triggerBody()['DocName_Value']}\"}]}},\"Get_files_(properties_only)\":{\"runAfter\":{\"DocNum\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"44b0584f-52a8-434b-9438-c80ac86411e6\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"GetFileItems\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"bc460a20-664c-49e7-bfe7-2843495da717\",\"$filter\":\"startswith(FileLeafRef,'@{variables('DocName')}')\",\"$top\":1},\"authentication\":{\"type\":\"Raw\",\"value\":\"@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']\"}}},\"Apply_to_each\":{\"foreach\":\"@outputs('Get_files_(properties_only)')?['body/value']\",\"actions\":{\"Set_CurrentRev\":{\"runAfter\":{\"Set_SPODocTitle\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"2943319f-7c66-44fd-bf7c-aaf9ea792ec1\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"CurrentRev\",\"value\":\"@items('Apply_to_each')?['GroteDocumentRevision']\"}},\"Set_SPODocName\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"2c02cd82-9c28-4850-a86c-d588e3675811\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"SPODocName\",\"value\":\"@items('Apply_to_each')?['{Name}']\"}},\"Set_SPODocTitle\":{\"runAfter\":{\"Set_SPODocName\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"e8035a95-7d44-4714-83d2-d544937240ff\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"SPODocTitle\",\"value\":\"@items('Apply_to_each')?['GroteDocumentDescription']\"}},\"Set_CurrentDivision\":{\"runAfter\":{\"Set_CurrentRev\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"cb6613ec-b21c-4d3d-9724-283e0a613bd6\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"CurrentDivision\",\"value\":\"@items('Apply_to_each')?['GroteDivision/Value']\"}},\"Set_CurrentProcess\":{\"runAfter\":{\"Set_CurrentDivision\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"029ae436-f4d6-4bd2-853c-59a21126d449\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"CurrentProcess\",\"value\":\"@items('Apply_to_each')?['GroteProcess/Value']\"}},\"Set_CurrentDocType\":{\"runAfter\":{\"Set_CurrentProcess\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"799256db-14eb-4cd3-b51c-ca17b205bb44\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"CurrentDocType\",\"value\":\"@items('Apply_to_each')?['GroteDocumentType_x003A_Description/Value']\"}},\"Set_CurrentDocExt\":{\"runAfter\":{\"Set_CurrentDocType\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"fb6cd333-1be2-4e37-b902-a7e0eead1875\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"CurrentDocExt\",\"value\":\"@items('Apply_to_each')?['{FilenameWithExtension}']\"}},\"Set_FileIdentifier\":{\"runAfter\":{\"Set_CurrentDocExt\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"7f0333ae-f36b-4572-8a21-fb1c1e3ebfa6\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"FileIdentifier\",\"value\":\"@items('Apply_to_each')?['{Identifier}']\"}},\"Set_ItemID\":{\"runAfter\":{\"Set_FileIdentifier\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"17b76d55-105e-4404-9ff7-a1667f736063\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"ItemID\",\"value\":\"@{items('Apply_to_each')?['ID']}\"}},\"Set_DocNum\":{\"runAfter\":{\"Set_ItemID\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"9a6cd3d5-b263-414a-b027-16a7bb31117c\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"DocNum\",\"value\":\"@items('Apply_to_each')?['GroteDocumentShortDescription']\"}}},\"runAfter\":{\"Get_files_(properties_only)\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"68e3d921-8356-468d-b793-9f32df1acb4d\"},\"type\":\"Foreach\"},\"Create_CurrentRev\":{\"runAfter\":{\"Create_SPODocTitle\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"c8d7c03e-5d50-4a90-be19-8660c7e1f838\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"CurrentRev\",\"type\":\"string\"}]}},\"Create_SPODocTitle\":{\"runAfter\":{\"Create_SPODocName\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"6982d10d-0a4d-495b-acc1-8ab08e4607a5\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"SPODocTitle\",\"type\":\"string\"}]}},\"Create_SPODocName\":{\"runAfter\":{\"DocName\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"76b11365-f2d3-46e1-a034-b134dabb614f\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"SPODocName\",\"type\":\"string\"}]}},\"Create_CurrentDivision\":{\"runAfter\":{\"Create_CurrentRev\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"344564b5-163d-47f5-8e86-11542a7fb7d1\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"CurrentDivision\",\"type\":\"string\"}]}},\"Create_CurrentProcess\":{\"runAfter\":{\"Create_CurrentDivision\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"a628d7bf-27c1-4277-baf5-975060d04f63\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"CurrentProcess\",\"type\":\"string\"}]}},\"Create_CurrentDocType\":{\"runAfter\":{\"Create_CurrentProcess\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"2b3d3670-3ba0-4f85-a075-d9d9563f85d5\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"CurrentDocType\",\"type\":\"string\"}]}},\"Create_CurrentDocExt\":{\"runAfter\":{\"Create_CurrentDocType\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"6ff12718-90a1-4e74-b1a4-e1d0be5fb10a\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"CurrentDocExt\",\"type\":\"string\"}]}},\"Create_FileIdentifier\":{\"runAfter\":{\"Create_CurrentDocExt\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"c5008c01-edb5-40af-944c-aef13b1032c2\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"FileIdentifier\",\"type\":\"string\"}]}},\"Create_ItemID\":{\"runAfter\":{\"Create_FileIdentifier\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"89d4a3d0-1de0-44b1-8c4b-4cb58d6e307c\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"ItemID\",\"type\":\"string\"}]}},\"DocNum\":{\"runAfter\":{\"Create_ItemID\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"297d6edd-0323-4266-9ce0-4000227ac9f2\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"DocNum\",\"type\":\"string\"}]}},\"Respond_to_a_PowerApp_or_flow\":{\"runAfter\":{\"Apply_to_each\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"3fedc15e-4388-46c4-9a30-615c64c9ce74\"},\"type\":\"Response\",\"kind\":\"PowerApp\",\"inputs\":{\"statusCode\":200,\"body\":{\"currentrev\":\"@variables('CurrentRev')\",\"spodoctitle\":\"@variables('SPODocTitle')\",\"spodocname\":\"@variables('SPODocName')\",\"currentdivision\":\"@variables('CurrentDivision')\",\"currentprocess\":\"@variables('CurrentProcess')\",\"currentdoctype\":\"@variables('CurrentDocType')\",\"currentdocext\":\"@variables('CurrentDocExt')\",\"fileidentifier\":\"@variables('FileIdentifier')\",\"itemid\":\"@variables('ItemID')\",\"docnum\":\"@variables('DocNum')\"},\"schema\":{\"type\":\"object\",\"properties\":{\"currentrev\":{\"title\":\"CurrentRev\",\"x-ms-dynamically-added\":true,\"type\":\"string\"},\"spodoctitle\":{\"title\":\"SPODocTitle\",\"x-ms-dynamically-added\":true,\"type\":\"string\"},\"spodocname\":{\"title\":\"SPODocName\",\"x-ms-dynamically-added\":true,\"type\":\"string\"},\"currentdivision\":{\"title\":\"CurrentDivision\",\"x-ms-dynamically-added\":true,\"type\":\"string\"},\"currentprocess\":{\"title\":\"CurrentProcess\",\"x-ms-dynamically-added\":true,\"type\":\"string\"},\"currentdoctype\":{\"title\":\"CurrentDocType\",\"x-ms-dynamically-added\":true,\"type\":\"string\"},\"currentdocext\":{\"title\":\"CurrentDocExt\",\"x-ms-dynamically-added\":true,\"type\":\"string\"},\"fileidentifier\":{\"title\":\"FileIdentifier\",\"x-ms-dynamically-added\":true,\"type\":\"string\"},\"itemid\":{\"title\":\"ItemID\",\"x-ms-dynamically-added\":true,\"type\":\"string\"},\"docnum\":{\"title\":\"DocNum\",\"x-ms-dynamically-added\":true,\"type\":\"string\"}}}}}}},\"templateName\":\"\"},\"schemaVersion\":\"1.0.0.0\"}","createdBy":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","modifiedBy":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","ownerId":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","owningBusinessUnit":"ee0a9aec-b63d-e911-a81c-000d3a11eefe","owningUser":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff"},{"name":"GDMS_Obsolete_Submit","createdOn":"2023-07-31T14:28:16Z","modifiedOn":"2023-07-31T14:57:57Z","workflowId":"404b2b7c-ae2f-ee11-bdf3-000d3a1b983d","resourceId":"f52c7047-e540-4c44-a943-efa4537d6522","stateCode":"Published","statusCode":"Published","definition":"{\"properties\":{\"connectionReferences\":{\"shared_sharepointonline\":{\"runtimeSource\":\"invoker\",\"connection\":{\"connectionReferenceLogicalName\":\"spo_sharedsharepointonline_e3ac5\"},\"api\":{\"name\":\"shared_sharepointonline\"}}},\"definition\":{\"$schema\":\"https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"$connections\":{\"defaultValue\":{},\"type\":\"Object\"},\"$authentication\":{\"defaultValue\":{},\"type\":\"SecureObject\"}},\"triggers\":{\"manual\":{\"metadata\":{\"operationMetadataId\":\"78365cf3-e21e-44fa-8fb9-523a5e34ffdc\"},\"type\":\"Request\",\"kind\":\"PowerApp\",\"inputs\":{\"schema\":{\"type\":\"object\",\"properties\":{\"FileID_Value\":{\"type\":\"string\",\"description\":\"Enter initial value\",\"x-ms-powerflows-param-ispartial\":false},\"UserDisplayName_Value\":{\"type\":\"string\",\"description\":\"Enter initial value\",\"x-ms-powerflows-param-ispartial\":false},\"Division_Value\":{\"type\":\"string\",\"description\":\"Enter initial value\",\"x-ms-powerflows-param-ispartial\":false},\"Process_Value\":{\"type\":\"string\",\"description\":\"Enter initial value\",\"x-ms-powerflows-param-ispartial\":false},\"UserEmail_Value\":{\"type\":\"string\",\"description\":\"Enter initial value\",\"x-ms-powerflows-param-ispartial\":false},\"ObsoleteReason_Value\":{\"type\":\"string\",\"description\":\"Enter initial value\",\"x-ms-powerflows-param-ispartial\":false},\"DocName_Value\":{\"type\":\"string\",\"description\":\"Enter initial value\",\"x-ms-powerflows-param-ispartial\":false},\"DocNumber_Value\":{\"type\":\"string\",\"description\":\"Enter initial value\",\"x-ms-powerflows-param-ispartial\":false},\"DocTitle_Value\":{\"type\":\"string\",\"description\":\"Enter initial value\",\"x-ms-powerflows-param-ispartial\":false},\"DocType_Value\":{\"type\":\"string\",\"description\":\"Enter initial value\",\"x-ms-powerflows-param-ispartial\":false}},\"required\":[\"FileID_Value\",\"UserDisplayName_Value\",\"Division_Value\",\"Process_Value\",\"UserEmail_Value\",\"ObsoleteReason_Value\",\"DocName_Value\",\"DocNumber_Value\",\"DocTitle_Value\",\"DocType_Value\"]}}}},\"actions\":{\"ApproversList\":{\"runAfter\":{\"Process\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"ac62d9e8-eb4a-4f08-b174-4a3b5ef73634\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"ApproversList\",\"type\":\"string\"}]}},\"Get_OARD\":{\"runAfter\":{\"ApproverType\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"4adb989d-3219-4f9e-ad91-a87ed42a5bd9\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"GetItems\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"8817a49e-b48d-4634-9918-1c7716a2d1e5\",\"$filter\":\"(Location eq '') and (Process eq '')\"},\"authentication\":{\"type\":\"Raw\",\"value\":\"@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']\"}}},\"Create_Approvers_List\":{\"foreach\":\"@outputs('Get_OARD')?['body/value']\",\"actions\":{\"Select_Approvers\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"9ebb034e-9fa1-4fde-974f-fec066ca5fc7\"},\"type\":\"Select\",\"inputs\":{\"from\":\"@items('Create_Approvers_List')?['Approvers']\",\"select\":\"@item()?['Email']\"}},\"Join_Approvers\":{\"runAfter\":{\"Select_Approvers\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"f6847035-fe24-4ff7-b09f-cce8865d32ab\"},\"type\":\"Join\",\"inputs\":{\"from\":\"@body('Select_Approvers')\",\"joinWith\":\";\"}},\"Set_ApproversList\":{\"runAfter\":{\"Join_Approvers\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"6950e687-b3bc-4a4e-b54b-e0ff2e3895b5\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"ApproversList\",\"value\":\"@body('Join_Approvers')\"}}},\"runAfter\":{\"Get_OARD\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"bce855cc-c345-48bc-8540-3c90fbb669d4\"},\"type\":\"Foreach\"},\"Create_Distribution_List\":{\"foreach\":\"@outputs('Get_OARD')?['body/value']\",\"actions\":{\"Select_Distributors\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"1049b1f2-fcad-4071-bfa1-c2d534cd4795\"},\"type\":\"Select\",\"inputs\":{\"from\":\"@items('Create_Distribution_List')?['Distribution']\",\"select\":\"@item()?['Email']\"}},\"Join_Distributors\":{\"runAfter\":{\"Select_Distributors\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"ba2bf1d4-31a5-4545-9f40-c4bcacab1ff2\"},\"type\":\"Join\",\"inputs\":{\"from\":\"@body('Select_Distributors')\",\"joinWith\":\";\"}},\"Set_Distributors\":{\"runAfter\":{\"Join_Distributors\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"3321bcc7-600c-44d1-a5ea-71a30f1dea20\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"Distributors\",\"value\":\"@body('Join_Distributors')\"}}},\"runAfter\":{\"Create_Approvers_List\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"dd1c9a3c-70d2-4f14-94d9-b0b5bcd83dd4\"},\"type\":\"Foreach\"},\"Distributors\":{\"runAfter\":{\"ApproversList\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"cdbc8e19-c351-4acf-aa21-1f23f9f460e1\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"Distributors\",\"type\":\"string\"}]}},\"FileID\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"2546509b-7fac-4e53-9d46-1f7b7830318e\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"FileID\",\"type\":\"string\",\"value\":\"@{triggerBody()['FileID_Value']}\"}]}},\"UserDisplayName\":{\"runAfter\":{\"FileID\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"7fec9ab7-b55a-4b3f-877d-8955eb5a3fb4\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"UserDisplayName\",\"type\":\"string\",\"value\":\"@{triggerBody()['UserDisplayName_Value']}\"}]}},\"UserEmail\":{\"runAfter\":{\"UserDisplayName\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"8bbcbaae-199f-4a37-a59d-f2fb61788eb3\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"UserEmail\",\"type\":\"string\",\"value\":\"@{triggerBody()['UserEmail_Value']}\"}]}},\"Division\":{\"runAfter\":{\"UserEmail\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"ed21391d-1524-448a-ba14-39cf6c858344\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"Division\",\"type\":\"string\",\"value\":\"@{triggerBody()['Division_Value']}\"}]}},\"Process\":{\"runAfter\":{\"Division\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"c9492351-f540-4d6e-a73f-a95dc7201b3e\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"Process\",\"type\":\"string\",\"value\":\"@{triggerBody()['Process_Value']}\"}]}},\"ObsoleteReason\":{\"runAfter\":{\"Distributors\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"4c754994-517b-4b22-a0be-5fa2fc999bed\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"ObsoleteReason\",\"type\":\"string\",\"value\":\"@{triggerBody()['ObsoleteReason_Value']}\"}]}},\"Create_item_in_ApprovalInfo\":{\"runAfter\":{\"Set_Approver_Type\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"17e82b0b-10b9-4432-8aaf-a2bff1ac5f5f\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"PostItem\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"3f960b78-8bab-42f1-a5d4-fa18072ad762\",\"item/Title\":\"@variables('DocName')\",\"item/Number\":\"@variables('DocNumber')\",\"item/Descripton\":\"@variables('DocTitle')\",\"item/DocumentType\":\"@variables('DocType')\",\"item/Division\":\"@variables('Division')\",\"item/Process\":\"@variables('Process')\",\"item/Stage\":\"Approval\",\"item/OriginatorName\":\"@variables('UserDisplayName')\",\"item/Originator\":\"@variables('UserEmail')\",\"item/Approver\":\"@variables('ApproversList')\",\"item/ApproverType\":\"@variables('ApproverType')\",\"item/DocID\":\"@variables('FileID')\",\"item/Reason\":\"@variables('ObsoleteReason')\",\"item/ApprovalType\":\"Obsoletion\"},\"authentication\":{\"type\":\"Raw\",\"value\":\"@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']\"}}},\"DocName\":{\"runAfter\":{\"ObsoleteReason\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"5db51afe-10e8-444c-9dcd-70c52325ca31\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"DocName\",\"type\":\"string\",\"value\":\"@{triggerBody()['DocName_Value']}\"}]}},\"DocNumber\":{\"runAfter\":{\"DocName\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"16d1d140-1287-4fff-a1d9-6d64be235f38\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"DocNumber\",\"type\":\"string\",\"value\":\"@{triggerBody()['DocNumber_Value']}\"}]}},\"DocTitle\":{\"runAfter\":{\"DocNumber\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"fca8c671-a433-4589-8fe1-1b672763b80a\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"DocTitle\",\"type\":\"string\",\"value\":\"@{triggerBody()['DocTitle_Value']}\"}]}},\"DocType\":{\"runAfter\":{\"DocTitle\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"58d740cb-bcaa-4bd0-9cc5-0872ea6d1e9b\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"DocType\",\"type\":\"string\",\"value\":\"@{triggerBody()['DocType_Value']}\"}]}},\"Get_Process_Info\":{\"runAfter\":{\"Create_Distribution_List\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"4ece7848-9b95-408e-8e91-f5ba7e56b8bf\"},\"type\":\"OpenApiConnection\",\"inputs\":{\"host\":{\"connectionName\":\"shared_sharepointonline\",\"operationId\":\"GetItems\",\"apiId\":\"/providers/Microsoft.PowerApps/apis/shared_sharepointonline\"},\"parameters\":{\"dataset\":\"https://grote0.sharepoint.com/sites/GDMS\",\"table\":\"b0035a39-3ba2-4fd4-8aac-f1b158eb5ea6\",\"$filter\":\"(Title eq '@{variables('Process')}')\",\"$top\":1,\"view\":\"832dff38-d7e3-4f7b-9576-e1c6051aa9ea\"},\"authentication\":{\"type\":\"Raw\",\"value\":\"@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']\"}}},\"ApproverType\":{\"runAfter\":{\"ApproverColumn\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"f5feaf19-a8e7-4bdf-a8d0-29735d8ab8f3\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"ApproverType\",\"type\":\"string\"}]}},\"ApproverColumn\":{\"runAfter\":{\"DocType\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"268a7d79-bd23-46ba-a206-c4d5375ee02b\"},\"type\":\"InitializeVariable\",\"inputs\":{\"variables\":[{\"name\":\"Approvercolumn\",\"type\":\"string\",\"value\":\"@{concat(variables('Division'),'ApproverType')}\"}]}},\"Compose\":{\"runAfter\":{\"Get_Process_Info\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"715f4987-27f9-4ac1-b33f-6e0c16035cce\"},\"type\":\"Compose\",\"inputs\":\"@outputs('Get_Process_Info')?['body/value']\"},\"Parse_JSON\":{\"runAfter\":{\"Compose\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"0b60b97f-3da1-4ecc-b218-5e510b0b30c1\"},\"type\":\"ParseJson\",\"inputs\":{\"content\":\"@outputs('Get_Process_Info')?['body/value']\",\"schema\":{\"type\":\"array\",\"items\":{\"type\":\"object\",\"properties\":{\"@@odata.etag\":{\"type\":\"string\"},\"ItemInternalId\":{\"type\":\"string\"},\"ID\":{\"type\":\"integer\"},\"Title\":{\"type\":\"string\"},\"MadisonApproverType\":{\"type\":\"string\"},\"MadisonReviewerType\":{\"type\":\"string\"},\"ElectronicsApproverType\":{\"type\":\"string\"},\"ElectronicsReviewerType\":{\"type\":\"string\"},\"Label\":{\"type\":\"string\"},\"{Identifier}\":{\"type\":\"string\"},\"{IsFolder}\":{\"type\":\"boolean\"},\"{Thumbnail}\":{\"type\":\"object\",\"properties\":{\"Large\":{},\"Medium\":{},\"Small\":{}}},\"{Link}\":{\"type\":\"string\"},\"{Name}\":{\"type\":\"string\"},\"{FilenameWithExtension}\":{\"type\":\"string\"},\"{Path}\":{\"type\":\"string\"},\"{FullPath}\":{\"type\":\"string\"},\"{HasAttachments}\":{\"type\":\"boolean\"},\"{VersionNumber}\":{\"type\":\"string\"}},\"required\":[\"@@odata.etag\",\"ItemInternalId\",\"ID\",\"Title\",\"MadisonApproverType\",\"MadisonReviewerType\",\"ElectronicsApproverType\",\"ElectronicsReviewerType\",\"Label\",\"{Identifier}\",\"{IsFolder}\",\"{Thumbnail}\",\"{Link}\",\"{Name}\",\"{FilenameWithExtension}\",\"{Path}\",\"{FullPath}\",\"{HasAttachments}\",\"{VersionNumber}\"]}}}},\"Set_Approver_Type\":{\"foreach\":\"@body('Parse_JSON')\",\"actions\":{\"Set_ApproverType\":{\"runAfter\":{},\"metadata\":{\"operationMetadataId\":\"032ea5fb-2a58-4530-8fcd-96368f5db107\"},\"type\":\"SetVariable\",\"inputs\":{\"name\":\"ApproverType\",\"value\":\"@{items('Set_Approver_Type')?[variables('Approvercolumn')]}\"}}},\"runAfter\":{\"Parse_JSON\":[\"Succeeded\"]},\"metadata\":{\"operationMetadataId\":\"06dcf8d2-c855-4bf4-b85a-fffd208dcf69\"},\"type\":\"Foreach\"}}},\"templateName\":\"\"},\"schemaVersion\":\"1.0.0.0\"}","createdBy":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","modifiedBy":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","ownerId":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff","owningBusinessUnit":"ee0a9aec-b63d-e911-a81c-000d3a11eefe","owningUser":"a2e5a557-eaf6-ec11-bb3d-000d3a137aff"}]}